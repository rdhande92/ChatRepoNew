question,answer
What are the names of all the Cities in Canada,"SELECT geo_name, id FROM   data_commons_public_data.cybersyn.geo_index WHERE iso_name ilike '%can%'"
what are the number of public holidays for US year on year ? ,"The corrected SQL query is:  ``` SELECT date_part('year', date) as year,        count(*) as num_public_holidays FROM   data_commons_public_data.cybersyn.public_holidays  WHERE  geo ilike '%United States%' GROUP BY year ORDER BY year asc ```   I replaced `geo_name` with `geo` in the `WHERE` clause as the error message suggests that `geo_name` is an invalid identifier."
What is average Fertility Rate measure of Canada in 2002 ?,"SELECT variable_name,        avg(value) as average_fertility_rate FROM   data_commons_public_data.cybersyn.timeseries WHERE  variable_name = 'Fertility Rate'    and geo_id = 'country/CAN'    and date >= '2002-01-01'    and date < '2003-01-01' GROUP BY 1;"
what is the  % growth of Housing Units in the United States year on year?,"SELECT date,        ((value/lag(value, 1) OVER (ORDER BY date asc)) - 1) * 100 as percent_growth FROM   data_commons_public_data.cybersyn.timeseries WHERE  geo_id = 'country/USA'    and variable_name = 'Housing Units'    and date >= '2001-01-01'    and date < '2022-01-01' ORDER BY date asc"
What are the 10 countries with highest government debt in 2020 ? ,"SELECT geo_name,        value FROM   data_commons_public_data.cybersyn.timeseries join data_commons_public_data.cybersyn.geo_index         ON timeseries.geo_id = geo_index.id WHERE  variable_name = 'Amount of Debt: Government'    and date = '2020-01-01'    and geo_id like 'country/%' ORDER BY value desc limit 10;"
Compare Unemployment Rate in Manhattan County versus New York State,"SELECT t1.date,         t2.geo_name,         t1.value  FROM DATA_COMMONS_PUBLIC_DATA.cybersyn.timeseries AS t1  INNER JOIN DATA_COMMONS_PUBLIC_DATA.cybersyn.geo_index AS t2  WHERE t1.geo_id in ('geoId/36061',                      'geoId/36')    AND t1.variable_name = 'Unemployment Rate of a Population'    AND date BETWEEN '2015-01-01' AND '2022-10-01'    AND t1.geo_id=t2.id  ORDER BY date ASC"
What are the 10 countries with highest government debt in 2019 ? ,"SELECT geo_name,        value FROM   data_commons_public_data.cybersyn.timeseries join data_commons_public_data.cybersyn.geo_index         ON timeseries.geo_id = geo_index.id WHERE  variable_name = 'Amount of Debt: Government'    and date = '2019-01-01'    and geo_id like 'country/%' ORDER BY value desc limit 10;"
What is the mean temperature of every geoid in 2002 ?,"SELECT geo_id,        avg(value) as mean_temperature FROM   data_commons_public_data.cybersyn.timeseries WHERE  variable_name = 'Temperature'    and date >= '2002-01-01'    and date < '2003-01-01' GROUP BY geo_id"
What is average number of deaths measure of Canada in 2002 ?,"Here is the corrected SQL query:  ``` SELECT variable_name,        AVG(value) AS average_number_of_deaths FROM data_commons_public_data.cybersyn.timeseries WHERE variable_name = 'Number of Deaths'    AND geo_id = 'country/CAN'    AND date >= '2002-01-01'    AND date < '2003-01-01' GROUP BY 1; ```   The error was caused by a missing single quote on the WHERE clause. The corrected query includes the missing single quote on line 4. Additionally, there was a typo on the SELECT clause where the AVG function was not capitalized, this has been corrected on line 2."
what is the % growth of Housing Units in the United States year on year,"SELECT date,        ((value/lag(value, 1) OVER (ORDER BY date asc)) - 1) * 100 as percent_growth FROM   data_commons_public_data.cybersyn.timeseries WHERE  geo_id = 'country/USA'    and variable_name = 'Housing Units'    and date >= '2001-01-01'    and date < '2022-01-01' ORDER BY date asc"
Which 5 countries saw the most %increase in nominal gdp bewtween 2012 and 2020 ?,"SELECT geo.geo_name,        ((ts2.value - ts.value) / ts.value) * 100 as increase_percentage FROM   (SELECT geo_id,                date,                value         FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries         WHERE  variable_name = 'Nominal GDP'            and date = '2012-01-01') as ts join (SELECT geo_id,                                             date,                                             value                                      FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries                                      WHERE  variable_name = 'Nominal GDP'                                         and date = '2020-01-01') as ts2         ON ts.geo_id = ts2.geo_id join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  geo.level = 'Country'    and ts.date = '2012-01-01' ORDER BY increase_percentage desc limit 5;"
What are the number financial holidays in the US year on year from 2015 to current year? ,"SELECT geo.geo_name,        year(date),        count(distinct holiday_name) as num_holidays FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar as cal join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON cal.geo_id = geo.geo_id WHERE  geo.level = 'Country'    and cal.date between '2015-01-01'    and '2023-12-31'    and geo_name ilike '%United States%' and is_financial = 1  GROUP BY 1,2"
What is mean population of Canada in 2002 ?,"SELECT variable_name, avg(value) as mean_population FROM   data_commons_public_data.cybersyn.timeseries WHERE  geo_id = 'country/CAN'    and date >= '2002-01-01'    and date < '2003-01-01' GROUP BY 1 ;"
What 5 countries have the highest life expectancy ? ,"SELECT geo_name,        value FROM   data_commons_public_data.cybersyn.timeseries join data_commons_public_data.cybersyn.geo_index         ON timeseries.geo_id = geo_index.id WHERE  variable_name = 'Life Expectancy'    and date = '2020-01-01' ORDER BY value desc limit 5;"
"Population for US, Canada, Mexico since 2000","SELECT      variable_name,      geo_name,      geo_id,      date,     value  FROM DATA_COMMONS_PUBLIC_DATA.cybersyn.timeseries  JOIN DATA_COMMONS_PUBLIC_DATA.cybersyn.geo_index  ON timeseries.geo_id = geo_index.id WHERE      variable ='Count_Person'      AND timeseries.geo_id IN ('country/USA', 'country/CAN', 'country/MEX')      AND date >= '2000-01-01' ORDER BY date desc;"
Display available measures for CBSAs (Cities),"SELECT DISTINCT variable_name FROM CYBERSYN_US__GLOBAL_PUBLIC_DATA_STARTER_KIT.cybersyn.datacommons_timeseries AS ts JOIN CYBERSYN_US__GLOBAL_PUBLIC_DATA_STARTER_KIT.cybersyn.geography_index AS geo ON (ts.geo_id = geo.geo_id) WHERE level = 'CensusCoreBasedStatisticalArea'"
What is the Average Amount of Government Debt of countries in the data,"SELECT avg(value) as avg_government_debt FROM   data_commons_public_data.cybersyn.timeseries WHERE  variable_name = 'Amount of Debt: Government'    and geo_id like 'country/%';"
What is the Average Amount of Government Debt of countries in the data in 2020 ? ,SELECT avg(value) as avg_government_debt FROM   data_commons_public_data.cybersyn.timeseries WHERE  variable_name = 'Amount of Debt: Government'    and geo_id like 'country/%'    and date = '2020-01-01';
what are the number of public holidays across countries in 2016.,"SELECT geo_name,        count(*) as num_public_holidays FROM   data_commons_public_data.cybersyn.timeseries join data_commons_public_data.cybersyn.geo_index         ON timeseries.geo_id = geo_index.id WHERE  variable_name = 'Public Holidays'    and date >= '2016-01-01'    and date < '2017-01-01' GROUP BY geo_name;"
what are the number of public holidays across countries in 2020 ? ,"SELECT geo_name,        count(*) as num_public_holidays FROM   data_commons_public_data.cybersyn.timeseries join data_commons_public_data.cybersyn.geo_index         ON timeseries.geo_id = geo_index.id WHERE  variable_name = 'Public Holidays'    and date >= '2020-01-01'    and date < '2021-01-01' GROUP BY geo_name;"
what are the number of public holidays across countries in 2021 ,"SELECT geo_name,        count(*) as num_public_holidays FROM   data_commons_public_data.cybersyn.timeseries join data_commons_public_data.cybersyn.geo_index         ON timeseries.geo_id = geo_index.id WHERE  variable_name = 'Public Holidays'    and date >= '2021-01-01'    and date < '2022-01-01' GROUP BY geo_name;"
"Which 5 countries saw the greatest increase in nominal GDP, expressed in percentage terms, between 2012 and 2020?","SELECT geo.geo_name,        ((ts2.value - ts.value) / ts.value) * 100 as increase_percentage FROM   (SELECT geo_id,                date,                value         FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries         WHERE  variable_name = 'Nominal GDP'            and date = '2012-01-01') as ts join (SELECT geo_id,                                             date,                                             value                                      FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries                                      WHERE  variable_name = 'Nominal GDP'                                         and date = '2020-01-01') as ts2         ON ts.geo_id = ts2.geo_id join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  geo.level = 'Country' ORDER BY increase_percentage desc limit 5;"
"what are the number of public holidays across countries, also plot a histogram for the same.","SELECT geo_name,        count(*) as num_public_holidays FROM   data_commons_public_data.cybersyn.timeseries join data_commons_public_data.cybersyn.geo_index         ON timeseries.geo_id = geo_index.id WHERE  variable_name = 'Public Holidays' GROUP BY geo_name ORDER BY num_public_holidays desc;"
what are the number of public holidays across countries in 2021.,"SELECT geo_name,        count(*) as num_public_holidays FROM   data_commons_public_data.cybersyn.timeseries join data_commons_public_data.cybersyn.geo_index         ON timeseries.geo_id = geo_index.id WHERE  variable_name = 'Public Holidays'    and date >= '2021-01-01'    and date < '2022-01-01' GROUP BY geo_name;"
What is the average Precipitation in Canada in 2002 ?,"SELECT variable_name,        avg(value) as avg_precipitation_rate FROM   data_commons_public_data.cybersyn.timeseries WHERE  variable_name = 'Precipitation Rate'    and geo_id = 'country/CAN'    and date >= '2002-01-01'    and date < '2003-01-01' GROUP BY variable_name;"
what is the yoy trend of number of public holidays in the US ? ,"The error message indicates that there is a syntax error in the SQL query, specifically at line 4 position 7 where there is an unexpected '<' character. Without seeing the original SQL query, it is difficult to determine the exact cause of the error. However, it is possible that there is an error in the syntax of the SQL statement or an issue with the database schema or table.  Please provide the original SQL query for me to assist you in correcting it."
what is the % growth of housing units in the united states yr over yr,"SELECT date,        ((value/lag(value, 1) OVER (ORDER BY date asc)) - 1) * 100 as percent_growth FROM   data_commons_public_data.cybersyn.timeseries WHERE  geo_id = 'country/USA'    and variable_name = 'Housing Units'    and date >= '2001-01-01'    and date < '2022-01-01' ORDER BY date asc"
Which date 5 countries saw the highest growth % in terms of housing units ,"SELECT date,        geo_name,        value FROM   data_commons_public_data.cybersyn.timeseries join data_commons_public_data.cybersyn.geo_index         ON timeseries.geo_id = geo_index.id WHERE  variable_name = 'Housing Units'    and date >= '2000-01-01'    and date < '2022-01-01'    and geo_id in ('country/CHN', 'country/IND', 'country/USA', 'country/BRA', 'country/RUS') ORDER BY value desc limit 5;"
Find counties that make up Chicago and Philadelphia,"SELECT      t3.geo_name as city_name,      t1.geo_id,      t2.geo_name as county_name,      t2.id as parent   FROM DATA_COMMONS_PUBLIC_DATA.cybersyn.geo_hierarchy t1  JOIN DATA_COMMONS_PUBLIC_DATA.cybersyn.geo_index t2      ON t1.parent_geo_id = t2.id JOIN DATA_COMMONS_PUBLIC_DATA.cybersyn.geo_index t3      ON t1.geo_id = t3.id WHERE t3.geo_name IN ('Philadelphia', 'Chicago') AND t2.level = 'County' ORDER BY t3.geo_name"
What are the number public holidays in the US year on year ? ,"The corrected SQL query is:   ``` SELECT date_part('year', date) as year,        count(*) as num_public_holidays FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar WHERE  geo_id = (SELECT geo_id                  FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index                  WHERE  geo_name = 'United States') GROUP BY year ORDER BY year; ```  Explanation: The error message suggests that the identifier 'ID' is invalid. It is because the subquery in the WHERE clause is selecting the 'id' column which does not exist in the geography_index table. Instead, it should select the 'geo_id' column."
What is average female population measure of Canada in 2002 ?,"SELECT variable_name,        avg(value) as average_female_population FROM   data_commons_public_data.cybersyn.timeseries WHERE  variable_name = 'Female Population'    and geo_id = 'country/CAN'    and date >= '2002-01-01'    and date < '2003-01-01' GROUP BY 1;"
what is the % growth of Housing Units in the United States year on yr,"SELECT date,        ((value/lag(value, 1) OVER (ORDER BY date asc)) - 1) * 100 as percent_growth FROM   data_commons_public_data.cybersyn.timeseries WHERE  geo_id = 'country/USA'    and variable_name = 'Housing Units'    and date >= '2001-01-01'    and date < '2022-01-01' ORDER BY date asc"
what are the names of the current year financial holdiays in the US which were not there in 2021 ?,"SELECT distinct holiday_name FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar as cal join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON cal.geo_id = geo.geo_id WHERE  geo.level = 'Country'    and cal.date between '2023-01-01'    and '2023-12-31'    and geo_name ilike '%United States%' and is_financial = 1  and holiday_name not in    (      SELECT distinct holiday_name FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar as cal join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON cal.geo_id = geo.geo_id WHERE  geo.level = 'Country'    and cal.date between '2021-01-01'    and '2021-12-31'    and geo_name ilike '%United States%' and is_financial = 1  )  "
what are the number of public holidays across countries in 2020.,"SELECT geo_name,        count(*) as num_public_holidays FROM   data_commons_public_data.cybersyn.timeseries join data_commons_public_data.cybersyn.geo_index         ON timeseries.geo_id = geo_index.id WHERE  variable_name = 'Public Holidays'    and date >= '2020-01-01'    and date < '2021-01-01' GROUP BY geo_name;"
What is the Average Amount of Government Debt of countries in the data in 2017 ? ,SELECT avg(value) as avg_government_debt FROM   data_commons_public_data.cybersyn.timeseries WHERE  variable_name = 'Amount of Debt: Government'    and geo_id like 'country/%'    and date = '2017-01-01';
what are the number of public holidays across countries in 2021 ? ,"SELECT geo_name,        count(*) as num_public_holidays FROM   data_commons_public_data.cybersyn.timeseries join data_commons_public_data.cybersyn.geo_index         ON timeseries.geo_id = geo_index.id WHERE  variable_name = 'Public Holidays'    and date >= '2021-01-01'    and date < '2022-01-01' GROUP BY geo_name;"
What are the 10 countries with highest government debt in 2017 ? ,"SELECT geo_name,        value FROM   data_commons_public_data.cybersyn.timeseries join data_commons_public_data.cybersyn.geo_index         ON timeseries.geo_id = geo_index.id WHERE  variable_name = 'Amount of Debt: Government'    and date = '2017-01-01'    and geo_id like 'country/%' ORDER BY value desc limit 10;"
what are the names of the current year financial holdiays in the US which were not there in 2018 ?,"SELECT distinct holiday_name FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar as cal join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON cal.geo_id = geo.geo_id WHERE  geo.level = 'Country'    and cal.date between '2023-01-01'    and '2023-12-31'    and geo_name ilike '%United States%' and is_financial = 1  and holiday_name not in    (      SELECT distinct holiday_name FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar as cal join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON cal.geo_id = geo.geo_id WHERE  geo.level = 'Country'    and cal.date between '2018-01-01'    and '2018-12-31'    and geo_name ilike '%United States%' and is_financial = 1  )   "
What are the public holidays in the US which are also financial holidays? ,"SELECT geo.geo_name,        count(distinct holiday_name) as num_holidays FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar as cal join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON cal.geo_id = geo.geo_id WHERE  geo.level = 'Country'    and cal.date between '2023-01-01'    and '2023-12-31'    and geo_name ilike '%United States%' and is_financial = 1  GROUP BY geo.geo_name ORDER BY num_holidays desc limit 1"
What is average Precipitation Rate measure of Canada in 2002 ?,"SELECT variable_name,        avg(value) as avg_precipitation_rate FROM   data_commons_public_data.cybersyn.timeseries WHERE  variable_name = 'Precipitation Rate'    and geo_id = 'country/CAN'    and date >= '2002-01-01'    and date < '2003-01-01' GROUP BY variable_name;"
What are if the mean temperature of every zipcode in Canada in 2002 ?,"SELECT geo_id,        avg(value) as mean_temperature FROM   data_commons_public_data.cybersyn.timeseries join data_commons_public_data.cybersyn.geo_index        ON timeseries.geo_id = geo_index.id WHERE  variable_name = 'Mean Temperature'        and timeseries.geo_id = 'country/CAN'        and date >= '2023-01-01' GROUP BY geo_id;"
"what are the number of public holidays across countries in 2021, also plot a histogram for the same.","SELECT geo_name,        count(*) as num_public_holidays FROM   data_commons_public_data.cybersyn.timeseries join data_commons_public_data.cybersyn.geo_index         ON timeseries.geo_id = geo_index.id WHERE  variable_name = 'Public Holidays'    and date >= '2021-01-01'    and date < '2022-01-01' GROUP BY geo_name ORDER BY num_public_holidays desc;"
Fetch total population of China in 2001 ? ,SELECT value FROM   data_commons_public_data.cybersyn.timeseries join data_commons_public_data.cybersyn.geo_index         ON timeseries.geo_id = geo_index.id WHERE  variable = 'Count_Person'    and geo_id = 'country/CHN'    and date = '2001-01-01'
Find all counties in NY,"SELECT *  FROM DATA_COMMONS_PUBLIC_DATA.cybersyn.geo_hierarchy  JOIN DATA_COMMONS_PUBLIC_DATA.cybersyn.geo_index      ON geo_hierarchy.geo_id = geo_index.id WHERE parent_geo_id = 'geoId/36'      AND level = 'County';"
what are the names of the current year financial holdiays in the US which were not there in 2010 ?,"SELECT distinct holiday_name FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar as cal join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON cal.geo_id = geo.geo_id WHERE  geo.level = 'Country'    and cal.date between '2023-01-01'    and '2023-12-31'    and geo_name ilike '%United States%' and is_financial = 1  and holiday_name not in    (      SELECT distinct holiday_name FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar as cal join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON cal.geo_id = geo.geo_id WHERE  geo.level = 'Country'    and cal.date between '2010-01-01'    and '2010-12-31'    and geo_name ilike '%United States%' and is_financial = 1  )   "
what are the names of the current year financial holdiays in the US which were not there in 2020 ?,SELECT DISTINCT holiday_name FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar as cal join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON cal.geo_id = geo.geo_id WHERE  geo.level = 'Country'    and cal.date between '2021-01-01'    and '2021-12-31'    and geo_name ilike '%United States%'    and is_financial = 1    and holiday_name not in (SELECT DISTINCT holiday_name                          FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar as cal join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo                                  ON cal.geo_id = geo.geo_id                          WHERE  geo.level = 'Country'                             and cal.date between '2020-01-01'                             and '2020-12-31'                             and geo_name ilike '%United States%'                             and is_financial = 1)
What is average life expectancy measure of Canada in 2002 ?,"SELECT variable_name,        date,        avg(value) as average_life_expectancy FROM   data_commons_public_data.cybersyn.timeseries WHERE  variable_name = 'Life Expectancy'    and geo_id = 'country/CAN'    and date >= '2002-01-01'    and date < '2003-01-01' GROUP BY 1,2;"
What are different levels in the geo index ?,SELECT DISTINCT level FROM   data_commons_public_data.cybersyn.geo_index;
What is countries have the highest life expectancy ? ,"SELECT geo_name,        avg(value) as avg_life_expectancy FROM   data_commons_public_data.cybersyn.timeseries join data_commons_public_data.cybersyn.geo_index         ON timeseries.geo_id = geo_index.id WHERE  variable_name = 'Life Expectancy' GROUP BY 1 ORDER BY 2 desc limit 10;"
What are the different types of variables in timeseries data ,"SELECT DISTINCT variable_name FROM   data_commons_public_data.cybersyn.timeseries;"
Compare the mean monthly federal funds effective rate to the monthly inflation rate expressed as a percentage based on the consumer price index for urban consumers since 1970,"with cpi_data as (SELECT date,                          value,                          lag(value) OVER (ORDER BY date) as prev_value                   FROM   financial_data_package.cybersyn.financial_fred_timeseries                   WHERE  variable_name ilike '%Consumer Price Index%Urban Consumers%'                      and date >= '1970-01-01'), inflation_rate as (SELECT date,                                                      (value - prev_value) / prev_value * 100 as monthly_inflation_rate                                               FROM   cpi_data                                               WHERE  prev_value is not null), mean_federal_funds_rate as (SELECT date_trunc('month', date) as month,                                                                    avg(value) as mean_federal_funds_rate                                                             FROM   financial_data_package.cybersyn.financial_fred_timeseries                                                             WHERE  variable_name = 'Federal Funds Effective Rate'                                                                and date >= '1970-01-01'                                                             GROUP BY month) SELECT inflation_rate.date,        inflation_rate.monthly_inflation_rate,        mean_federal_funds_rate.mean_federal_funds_rate FROM   inflation_rate join mean_federal_funds_rate         ON inflation_rate.date = mean_federal_funds_rate.month ORDER BY inflation_rate.date;"
"What are the bank branches in the zip code with the most number of bank branches, excluding none values?","SELECT * FROM   financial_data_package.cybersyn.financial_branch_entities WHERE  id_zip = (SELECT id_zip                  FROM   financial_data_package.cybersyn.financial_branch_entities                  WHERE  end_date is null                     and id_zip is not null                  GROUP BY id_zip                  ORDER BY count(*) desc limit 1) and end_date is null and id_zip is not null;"
"Since 1990, how many bank branches are there annually?","SELECT count(*) as n_branches,        date_trunc('YEAR', start_date) as start_year FROM   financial_data_package.cybersyn.financial_branch_entities WHERE  start_date >= '1990-01-01' GROUP BY start_year ORDER BY start_year asc"
"Calculate the annualized quarterly inflation rate, as a percentage, based on the consumer price index for urban consumers since 1970","with cpi_data as (SELECT date,                          value,                          lag(value) OVER (ORDER BY date) as prev_value                   FROM   financial_data_package.cybersyn.financial_fred_timeseries                   WHERE  variable_name ilike '%Consumer Price Index%Urban Consumers%'                      and date >= '1970-01-01'), quarterly_inflation as (SELECT date,                                                           value,                                                           prev_value,                                                           extract(year                                                    FROM   date) as year, extract(quarter                                                    FROM   date) as quarter                                                    FROM   cpi_data                                                    WHERE  prev_value is not null), quarterly_inflation_rate as (SELECT year,                                                                     quarter,                                                                     (power((value / prev_value), 1.0/3) - 1) * 100 as quarterly_inflation_rate                                                              FROM   quarterly_inflation) SELECT year,        quarter,        quarterly_inflation_rate FROM   quarterly_inflation_rate ORDER BY year, quarter;"
Which are the top 10 banks by the number of branches open since 1980?,"with branch_counts as (SELECT id_rssd_parent,                               count(*) as branch_count                        FROM   financial_data_package.cybersyn.financial_branch_entities                        WHERE  start_date >= '1980-01-01'                        GROUP BY id_rssd_parent) SELECT name,        branch_count FROM   branch_counts join financial_data_package.cybersyn.financial_institution_entities         ON financial_institution_entities.id_rssd = branch_counts.id_rssd_parent ORDER BY branch_count desc limit 10;"
What are the first 10 rows in the FINANCIAL_INSTITUTION_ATTRIBUTES table?,"SELECT VARIABLE, VARIABLE_NAME, DEFINITION, FREQUENCY, UNIT FROM FINANCIAL_DATA_PACKAGE.CYBERSYN.FINANCIAL_INSTITUTION_ATTRIBUTES LIMIT 10"
How many CFPB complaints were made each year?,"SELECT date_trunc('YEAR', date_received) as year,        count(*) as count FROM   financial_data_package.cybersyn.financial_cfpb_complaint GROUP BY year ORDER BY year asc"
Are the differences in the states' mean monthly not seasonally adjusted unemployment rates in 2008-2010 versus 2020-2022 statistically significant?,"with unemployment_rate_2008_2010 as (SELECT geo_name,                                             avg(value) as avg_unemployment_rate_2008_2010                                      FROM   financial_data_package.cybersyn.bureau_of_labor_statistics_employment_timeseries join financial_data_package.cybersyn.geography_index                                              ON bureau_of_labor_statistics_employment_timeseries.geo_id = geography_index.geo_id                                      WHERE  variable_name like '%Unemployment Rate%Not seasonally adjusted%'                                         and date between to_date('2008-01-01')                                         and to_date('2010-12-31')                                         and level = 'State'                                      GROUP BY geo_name), unemployment_rate_2020_2022 as (SELECT geo_name,                                                            avg(value) as avg_unemployment_rate_2020_2022                                                     FROM   financial_data_package.cybersyn.bureau_of_labor_statistics_employment_timeseries join financial_data_package.cybersyn.geography_index                                                             ON bureau_of_labor_statistics_employment_timeseries.geo_id = geography_index.geo_id                                                     WHERE  variable_name like '%Unemployment Rate%Not seasonally adjusted%'                                                        and date between to_date('2020-01-01')                                                        and to_date('2022-12-31')                                                        and level = 'State'                                                     GROUP BY geo_name) SELECT avg(difference) as avg_difference,        stddev_pop(difference) / sqrt(count(*)) as standard_error,        avg(difference) / (stddev_pop(difference) / sqrt(count(*))) as t_statistic,        count(*) as num_states FROM   (SELECT u1.geo_name,                u1.avg_unemployment_rate_2008_2010,                u2.avg_unemployment_rate_2020_2022,                u2.avg_unemployment_rate_2020_2022 - u1.avg_unemployment_rate_2008_2010 as difference         FROM   unemployment_rate_2008_2010 u1 join unemployment_rate_2020_2022 u2                 ON u1.geo_name = u2.geo_name) as differences WHERE  not difference is null;"
What are the names of the countries in the European region?,SELECT n.n_name AS country FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.REGION r JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n ON r.r_regionkey = n.n_regionkey WHERE r.r_name = 'EUROPE'
Which are the states with the highest mean monthly not seasonally adjusted unemployment rates in 2008-2010 and 2020-2022?,"SELECT geo_name,        avg(value) as avg_unemployment_rate FROM   financial_data_package.cybersyn.bureau_of_labor_statistics_employment_timeseries join financial_data_package.cybersyn.geography_index         ON bureau_of_labor_statistics_employment_timeseries.geo_id = geography_index.geo_id WHERE  variable_name like '%Unemployment Rate%Not seasonally adjusted%'    and date between to_date('2008-01-01')    and to_date('2010-12-31')     or date between to_date('2020-01-01')    and to_date('2022-12-31')    and level = 'State' GROUP BY geo_name having count(distinct case when date between to_date('2008-01-01') and to_date('2010-12-31') then 1 end) = 36 and count(distinct case when date between to_date('2020-01-01') and to_date('2022-12-31') then 1 end) = 36 ORDER BY avg_unemployment_rate desc;"
What is the number of customers in each region?,"SELECT r.r_name AS region, COUNT(DISTINCT c.c_custkey) AS number_of_customers FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.REGION r JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n ON r.r_regionkey = n.n_regionkey JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c ON n.n_nationkey = c.c_nationkey GROUP BY region"
Calculate the monthly inflation rate as a percentage from the consumer price index for urban consumers since 1965,"with cpi_data as (SELECT date,                          value,                          lag(value) OVER (ORDER BY date) as prev_value                   FROM   financial_data_package.cybersyn.financial_fred_timeseries                   WHERE  variable_name ilike '%Consumer Price Index%Urban Consumers%'                      and date >= '1965-01-01') SELECT date,        value as cpi,        (value - prev_value) / prev_value * 100 as monthly_inflation_rate FROM   cpi_data WHERE  prev_value is not null ORDER BY date;"
Count credit card complaints by month by company since 2012,"SELECT company,        DATE_TRUNC('month', date_received) AS month,        COUNT(1)                           AS credit_card_complaint FROM financial_data_package.cybersyn.financial_cfpb_complaint WHERE product ILIKE '%card%'   AND date_received >= '2012-01-01' GROUP BY company, month"
How many new branches were opened by which banks in 2022,"SELECT id_rssd_parent,        count(*) FROM   financial_data_package.cybersyn.financial_branch_entities WHERE  start_date >= '2022-01-01' GROUP BY id_rssd_parent ORDER BY count(*) desc;"
What are the names of the top six customers with the highest total sales?,"SELECT c.c_name AS customer_name, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON l.l_orderkey = o.o_orderkey JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c ON o.o_custkey = c.c_custkey GROUP BY customer_name ORDER BY total_sales DESC LIMIT 6"
Compare the states with the mean monthly not seasonally adjusted unemployment rates in 2008-2010 versus 2020-2022?,"with unemployment_rate_2008_2010 as (SELECT geo_name,                                             avg(value) as avg_unemployment_rate                                      FROM   financial_data_package.cybersyn.bureau_of_labor_statistics_employment_timeseries join financial_data_package.cybersyn.geography_index                                              ON bureau_of_labor_statistics_employment_timeseries.geo_id = geography_index.geo_id                                      WHERE  variable_name like '%Unemployment Rate%Not seasonally adjusted%'                                         and date between to_date('2008-01-01')                                         and to_date('2010-12-31')                                         and level = 'State'                                      GROUP BY geo_name), unemployment_rate_2020_2022 as (SELECT geo_name,                                                            avg(value) as avg_unemployment_rate                                                     FROM   financial_data_package.cybersyn.bureau_of_labor_statistics_employment_timeseries join financial_data_package.cybersyn.geography_index                                                             ON bureau_of_labor_statistics_employment_timeseries.geo_id = geography_index.geo_id                                                     WHERE  variable_name like '%Unemployment Rate%Not seasonally adjusted%'                                                        and date between to_date('2020-01-01')                                                        and to_date('2022-12-31')                                                        and level = 'State'                                                     GROUP BY geo_name) SELECT a.geo_name,        a.avg_unemployment_rate as avg_unemployment_rate_2008_2010,        b.avg_unemployment_rate as avg_unemployment_rate_2020_2022 FROM   unemployment_rate_2008_2010 a join unemployment_rate_2020_2022 b         ON a.geo_name = b.geo_name ORDER BY a.geo_name;"
Which banks have the most uninsured deposits?,"with latest_uninsured as (SELECT id_rssd,                                  1 - value as pct_uninsured                           FROM   financial_data_package.cybersyn.financial_institution_timeseries                           WHERE  variable = 'ASSET'                              and date = '2022-12-31') SELECT name,        pct_uninsured,        ent.is_active FROM   financial_data_package.cybersyn.financial_institution_timeseries as ts     INNER JOIN financial_data_package.cybersyn.financial_institution_attributes as att         ON (ts.variable = att.variable)     INNER JOIN financial_data_package.cybersyn.financial_institution_entities as ent         ON (ts.id_rssd = ent.id_rssd)     INNER JOIN latest_uninsured         ON (latest_uninsured.id_rssd = ts.id_rssd) WHERE  ts.date = '2022-12-31'    and att.variable_name = '% Insured (Estimated)'    and att.frequency = 'Quarterly'    and ent.is_active = true ORDER BY pct_uninsured desc limit 10;"
How many CFPB complaints of each product were made each year?,"SELECT date_trunc('YEAR', date_received) as year,        product,        count(*) as count FROM   financial_data_package.cybersyn.financial_cfpb_complaint GROUP BY year, product ORDER BY year asc, count desc"
Sample 10 states in the USA and compare their mean monthly not seasonally adjusted unemployment rates in 2008-2010 versus 2020-2022,"with unemployment_rate_2008_2010 as (SELECT geo_name,                                             avg(value) as avg_unemployment_rate                                      FROM   financial_data_package.cybersyn.bureau_of_labor_statistics_employment_timeseries join financial_data_package.cybersyn.geography_index                                              ON bureau_of_labor_statistics_employment_timeseries.geo_id = geography_index.geo_id                                      WHERE  variable_name like '%Unemployment Rate%Not seasonally adjusted%'                                         and date between '2008-01-01'                                         and '2010-12-31'                                         and level = 'State'                                      GROUP BY geo_name), unemployment_rate_2020_2022 as (SELECT geo_name,                                                            avg(value) as avg_unemployment_rate                                                     FROM   financial_data_package.cybersyn.bureau_of_labor_statistics_employment_timeseries join financial_data_package.cybersyn.geography_index                                                             ON bureau_of_labor_statistics_employment_timeseries.geo_id = geography_index.geo_id                                                     WHERE  variable_name like '%Unemployment Rate%Not seasonally adjusted%'                                                        and date between '2020-01-01'                                                        and '2022-12-31'                                                        and level = 'State'                                                     GROUP BY geo_name), sample_states as (SELECT geo_name                                       FROM   financial_data_package.cybersyn.geography_index sample (10)                                       WHERE  level = 'State') -- 10% random sample of states SELECT sample_states.geo_name,        u1.avg_unemployment_rate as avg_unemployment_rate_2008_2010,        u2.avg_unemployment_rate as avg_unemployment_rate_2020_2022 FROM   sample_states     LEFT JOIN unemployment_rate_2008_2010 u1         ON sample_states.geo_name = u1.geo_name     LEFT JOIN unemployment_rate_2020_2022 u2         ON sample_states.geo_name = u2.geo_name ORDER BY sample_states.geo_name;"
"Compare the federal funds effective rate, as a percentage to the annualized monthly inflation rate expressed as a percentage based on the consumer price index for urban consumers since 1970","with cpi_data as (SELECT date,                          value,                          lag(value) OVER (ORDER BY date) as prev_value                   FROM   financial_data_package.cybersyn.financial_fred_timeseries                   WHERE  variable_name ilike '%Consumer Price Index%Urban Consumers%'                      and date >= '1970-01-01'), inflation_rate as (SELECT date,                                                      (value - prev_value) / prev_value * 100 as monthly_inflation_rate                                               FROM   cpi_data                                               WHERE  prev_value is not null), federal_funds_rate as (SELECT date,                                                               value as federal_funds_rate                                                        FROM   financial_data_package.cybersyn.financial_fred_timeseries                                                        WHERE  variable_name = 'Federal Funds Effective Rate'                                                           and date >= '1970-01-01') SELECT inflation_rate.date,        100*federal_funds_rate.federal_funds_rate as federal_funds_rate,        (power((1 + inflation_rate.monthly_inflation_rate / 100),               12) - 1) * 100 as annualized_inflation_rate FROM   inflation_rate join federal_funds_rate         ON inflation_rate.date = federal_funds_rate.date ORDER BY inflation_rate.date;"
How many complaints were submitted via each method?,"SELECT submitted_via,        count(*) as count FROM   financial_data_package.cybersyn.financial_cfpb_complaint GROUP BY submitted_via ORDER BY count desc"
"Among the top 10 companies in terms of the total number of complaints received between 2018 and 2022 by CFPB, what is the percentage breakdown of the various companies' responses to customers in each year?","The corrected SQL code is:  ``` WITH top_10_companies AS (     SELECT company,            COUNT(*) AS complaints_count     FROM   financial_data_package.cybersyn.financial_cfpb_complaint     WHERE  date_received BETWEEN '2018-01-01' AND '2022-12-31'     GROUP BY company     ORDER BY complaints_count DESC LIMIT 10 ),  company_responses AS (     SELECT company,            company_response_to_consumer,            DATE_TRUNC('YEAR', date_received) AS year,            COUNT(*) AS response_count     FROM   financial_data_package.cybersyn.financial_cfpb_complaint     WHERE  date_received BETWEEN '2018-01-01' AND '2022-12-31' AND company IN (SELECT company FROM top_10_companies)     GROUP BY company, company_response_to_consumer, year, company, company_response_to_consumer, year ), response_count AS (     SELECT company,            company_response_to_consumer,            year,            SUM(response_count) AS response_count     FROM   company_responses     GROUP BY company, company_response_to_consumer, year ) SELECT company,        company_response_to_consumer,        year,        response_count * 100.0 / SUM(response_count) OVER (PARTITION BY company, year) AS percentage FROM   response_count ORDER BY company, year, percentage DESC ```   Explanation:  The issue with the initial query is that the `response_count` column was not included in the `GROUP BY` clause of the `company_responses` subquery. To correct this, we can add `response_count` to the `GROUP BY` clause of the `company_responses` subquery.  However, this will cause an error in the final `SELECT` statement, since `response_count` is not a valid column to group by. To fix this, we can create a new subquery called `response_count` that groups by `company`, `company_response_to_consumer`, and `year`, and sums up the `response_count` column. We can then use this subquery in the final `SELECT` statement instead of `company_responses`."
Which are the five biggest banks by deposits,"with latest_deposits as (SELECT id_rssd,                                 value                          FROM   financial_data_package.cybersyn.financial_institution_timeseries                          WHERE  variable = 'DEP'                             and date = '2022-12-31'), active_banks as (SELECT *                                            FROM   financial_data_package.cybersyn.financial_institution_entities                                            WHERE  is_active = true) SELECT name,        value FROM   active_banks     INNER JOIN latest_deposits         ON (latest_deposits.id_rssd = active_banks.id_rssd) ORDER BY value desc limit 5;"
Which are the states with the highest number of branch closures in 2022?,"SELECT state_abbreviation,        count(*) as n_closures FROM   financial_data_package.cybersyn.financial_branch_entities WHERE  end_date between '2022-01-01'    and '2022-12-31' GROUP BY state_abbreviation ORDER BY n_closures desc"
"Since 2020, which banks opened at least 3 new branches in states they were new to, and how many new states were there for each bank?  ","with new_branches as (SELECT id_rssd_parent,                              state_abbreviation,                              count(*) as new_branch_count                       FROM   financial_data_package.cybersyn.financial_branch_entities                       WHERE  start_date >= '2020-01-01'                       GROUP BY id_rssd_parent, state_abbreviation), pre2020_branches as (SELECT id_rssd_parent,                                                                           state_abbreviation                                                                    FROM   financial_data_package.cybersyn.financial_branch_entities                                                                    WHERE  start_date < '2020-01-01'                                                                       and end_date is null                                                                       and state_abbreviation is not null                                                                    GROUP BY id_rssd_parent, state_abbreviation) SELECT bank_names.name,        count(*) as new_state_count FROM   new_branches     INNER JOIN financial_data_package.cybersyn.financial_institution_entities as bank_names         ON (new_branches.id_rssd_parent = bank_names.id_rssd)     LEFT JOIN pre2020_branches         ON (new_branches.id_rssd_parent = pre2020_branches.id_rssd_parent and            new_branches.state_abbreviation = pre2020_branches.state_abbreviation) WHERE  pre2020_branches.id_rssd_parent is null GROUP BY bank_names.name having count(*) >= 3 ORDER BY new_state_count desc;"
Calculate the annualized monthly inflation rate as a percentage from the consumer price index for urban consumers since 1965,"WITH cpi_data AS (   SELECT date,          value,          LAG(value) OVER (ORDER BY date) AS prev_value   FROM financial_data_package.cybersyn.financial_fred_timeseries   WHERE variable_name ILIKE '%Consumer Price Index%Urban Consumers%'     AND date >= '1965-01-01' ),  subquery AS (   SELECT date,          value,          LAG(value) OVER (ORDER BY date) AS prev_value,          LAG(date) OVER (ORDER BY date) AS prev_date   FROM cpi_data )  SELECT date,        (POWER((value / prev_value), 1.0/12) - 1) * 100 AS annualized_inflation_rate FROM subquery WHERE prev_value IS NOT NULL ORDER BY date;"
Create a cumulative frequency distribution of the number of complaints received by CFPB against Equifax in 2022,"with equifax_2022_complaints as (SELECT count(*) as n_complaints                                  FROM   financial_data_package.cybersyn.financial_cfpb_complaint                                  WHERE  company = 'Equifax'                                     and date_received between '2022-01-01'                                     and '2022-12-31') SELECT n_complaints,        count(*) as frequency,        sum(count(*)) OVER (ORDER BY n_complaints asc) as cumulative_frequency FROM   equifax_2022_complaints GROUP BY n_complaints ORDER BY n_complaints asc"
How many of the new branches that were opened since 2020 are from banks new to the state? ,"with new_branches as (SELECT id_rssd_parent,                              count(*) as new_branch_count                       FROM   financial_data_package.cybersyn.financial_branch_entities                       WHERE  start_date >= '2020-01-01'                       GROUP BY id_rssd_parent), bank_names as (SELECT id_rssd,                                                 name                                          FROM   financial_data_package.cybersyn.financial_institution_entities), pre2020_branches as (SELECT id_rssd_parent,                                                                                                     state_abbreviation                                                                                              FROM   financial_data_package.cybersyn.financial_branch_entities                                                                                              WHERE  start_date < '2020-01-01'                                                                                                 and end_date is null                                                                                                 and state_abbreviation is not null                                                                                              GROUP BY id_rssd_parent, state_abbreviation) SELECT name,        new_branch_count FROM   bank_names     INNER JOIN new_branches         ON (bank_names.id_rssd = new_branches.id_rssd_parent)     LEFT JOIN pre2020_branches         ON (new_branches.id_rssd_parent = pre2020_branches.id_rssd_parent) WHERE  pre2020_branches.id_rssd_parent is null ORDER BY new_branch_count desc;"
On average how many CFBP complaints are there by company?,"SELECT company,        count(*) as complaints_count FROM   financial_data_package.cybersyn.financial_cfpb_complaint GROUP BY company ORDER BY complaints_count desc"
What are the states with the highest mean monthly not seasonally adjusted unemployment rates since 2020?,"SELECT geo_name,        avg(value) as avg_unemployment_rate FROM   financial_data_package.cybersyn.bureau_of_labor_statistics_employment_timeseries join financial_data_package.cybersyn.geography_index         ON bureau_of_labor_statistics_employment_timeseries.geo_id = geography_index.geo_id WHERE  variable_name like '%Unemployment Rate%Not seasonally adjusted%'    and date >= to_date('2020-01-01')    and level = 'State' GROUP BY geo_name ORDER BY avg_unemployment_rate desc"
"In 2021, how many new branches have banks opened by state?","with new_branches as (SELECT state_abbreviation,                              count(*) as new_branch_count                       FROM   financial_data_package.cybersyn.financial_branch_entities                       WHERE  start_date >= '2021-01-01'                       GROUP BY state_abbreviation) SELECT state_abbreviation,        new_branch_count FROM   new_branches ORDER BY new_branch_count desc;"
"Among the top 10 most complained companies between 2017 and 2022 by CFPB, what are the percentages of each company's various responses to customers?","with top_10_companies as (SELECT company,                                  count(*) as complaints_count                           FROM   financial_data_package.cybersyn.financial_cfpb_complaint                           WHERE  date_received between '2017-01-01'                              and '2022-12-31'                           GROUP BY company                           ORDER BY complaints_count desc limit 10), company_responses as (SELECT company,                                                                        company_response_to_consumer,                                                                        count(*) as response_count                                                                 FROM   financial_data_package.cybersyn.financial_cfpb_complaint                                                                 WHERE  date_received between '2017-01-01'                                                                    and '2022-12-31'                                                                    and company in (SELECT company                                                                                 FROM   top_10_companies)                                                                 GROUP BY company, company_response_to_consumer) SELECT company,        company_response_to_consumer,        response_count,        response_count * 100.0 / sum(response_count) OVER (PARTITION BY company) as percentage FROM   company_responses ORDER BY company, percentage desc"
"What is the 3 month running average of each states' mean monthly not seasonally adjusted unemployment rates, expressed in percentage, between 2007 to 2022?","with monthly_unemployment_rates as (SELECT g.geo_name,                                            b.date,                                            avg(b.value) as avg_unemployment_rate                                     FROM   financial_data_package.cybersyn.bureau_of_labor_statistics_employment_timeseries as b join financial_data_package.cybersyn.geography_index as g                                             ON b.geo_id = g.geo_id                                     WHERE  b.variable_name like '%Unemployment Rate%Not seasonally adjusted%'                                        and b.date between '2007-01-01'                                        and '2022-12-31'                                        and g.level = 'State'                                     GROUP BY g.geo_name, b.date) SELECT geo_name,        date,        avg(avg_unemployment_rate) OVER (PARTITION BY geo_name                                         ORDER BY date rows between 1 preceding and 1 following) as three_month_running_avg,        100 * avg(avg_unemployment_rate) OVER (PARTITION BY geo_name                                               ORDER BY date rows between 1 preceding and 1 following) / avg(avg_unemployment_rate) OVER (PARTITION BY geo_name) - 100 as three_month_running_avg_pct_change FROM   monthly_unemployment_rates ORDER BY geo_name, date;"
Compare the seasonally adjusted Consumer Price Index for all Urban Consumers to the Federal Funds Effective Rate on the last day of each month ,"with cpi as (SELECT date_trunc('month', date) as month,                     last_value(value) OVER (ORDER BY date) as cpi              FROM   financial_data_package.cybersyn.financial_fred_timeseries              WHERE  variable like '%Consumer Price Index%Urban Consumers%Seasonally adjusted%'              ORDER BY month), federal_funds_effective_rate as (SELECT date_trunc('month', date) as month,                                                          last_value(value) OVER (ORDER BY date) as rate                                                   FROM   financial_data_package.cybersyn.financial_fred_timeseries                                                   WHERE  variable = 'Federal Funds Effective Rate'                                                   ORDER BY month) SELECT cpi.month,        cpi.cpi,        federal_funds_effective_rate.rate FROM   cpi     INNER JOIN federal_funds_effective_rate         ON (cpi.month = federal_funds_effective_rate.month);"
What is the count of line items purchased with each discount rate in each region?,"SELECT   r.r_name AS region_name,   l.l_discount AS discount,   COUNT(*) AS count FROM   SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON l.l_orderkey = o.o_orderkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c ON o.o_custkey = c.c_custkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n ON c.c_nationkey = n.n_nationkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.REGION r ON n.n_regionkey = r.r_regionkey GROUP BY   region_name,   discount ORDER BY   region_name,   discount"
"Since 1990, how many bank branches are opened and closed annually?","with branches_opened as (SELECT count(*) as n_branches_opened,                                 date_trunc('YEAR', start_date) as start_year                          FROM   financial_data_package.cybersyn.financial_branch_entities                          WHERE  start_date >= '1990-01-01'                          GROUP BY start_year), branches_closed as (SELECT count(*) as n_branches_closed,                                                  date_trunc('YEAR', end_date) as end_year                                           FROM   financial_data_package.cybersyn.financial_branch_entities                                           WHERE  end_date >= '1990-01-01'                                           GROUP BY end_year) SELECT coalesce(branches_opened.start_year, branches_closed.end_year) as year,        branches_opened.n_branches_opened,        branches_closed.n_branches_closed FROM   branches_opened full     OUTER JOIN branches_closed         ON branches_opened.start_year = branches_closed.end_year ORDER BY year asc"
"Among the top 10 companies in terms of the total number of complaints received between 2017 and 2022 by CFPB, what are the percentages of each company's various responses to customers?","with top_10_companies as (SELECT company,                                  count(*) as complaints_count                           FROM   financial_data_package.cybersyn.financial_cfpb_complaint                           WHERE  date_received between '2017-01-01'                              and '2022-12-31'                           GROUP BY company                           ORDER BY complaints_count desc limit 10), company_responses as (SELECT company,                                                                        company_response_to_consumer,                                                                        count(*) as response_count                                                                 FROM   financial_data_package.cybersyn.financial_cfpb_complaint                                                                 WHERE  date_received between '2017-01-01'                                                                    and '2022-12-31'                                                                    and company in (SELECT company                                                                                 FROM   top_10_companies)                                                                 GROUP BY company, company_response_to_consumer) SELECT company,        company_response_to_consumer,        response_count,        response_count * 100.0 / sum(response_count) OVER (PARTITION BY company) as percentage FROM   company_responses ORDER BY company, percentage desc"
"Compare the seasonally adjusted Consumer Price Index for Urban Consumers, Bank Prime Loan Rate, and the Federal Funds Effective Rate","SELECT a.date,        a.value as bank_prime_loan_rate,        b.value as federal_funds_effective_rate,        c.value as consumer_price_index FROM   financial_data_package.cybersyn.financial_fred_timeseries a join financial_data_package.cybersyn.financial_fred_timeseries b         ON a.date = b.date join financial_data_package.cybersyn.financial_fred_timeseries c         ON a.date = c.date WHERE  a.variable_name like '%Bank Prime Loan Rate%'    and b.variable_name = 'Federal Funds Effective Rate'    and c.variable_name like '%Consumer Price Index%Urban Consumers%Seasonally adjusted%' ORDER BY a.date;"
"Compare the Federal Funds Effective Rate to the rates set by the Bank of England, and the central banks of Canada, Japan and Mexico","SELECT b.date,        a.value as boe_rate,        c.value as boj_rate,        d.value as bom_rate, e.value as boc_rate,        b.value as federal_funds_rate FROM   financial_data_package.cybersyn.financial_fred_timeseries a join financial_data_package.cybersyn.financial_fred_timeseries b         ON a.date = b.date join financial_data_package.cybersyn.financial_fred_timeseries c         ON a.date = c.date join financial_data_package.cybersyn.financial_fred_timeseries d         ON a.date = d.date join financial_data_package.cybersyn.financial_fred_timeseries e         ON a.date = e.date WHERE  a.variable_name like '%Bank of England%'    and b.variable_name = 'Federal Funds Effective Rate'    and c.variable_name like '%Bank of Japan%'    and d.variable_name like '%Mexico%' and e.variable_name like '%Canada%' ORDER BY b.date;"
"Between 1990 and 2023, how many bank branches were opened and closed annually?","with branches_opened as (SELECT count(*) as n_branches_opened,                                 date_trunc('YEAR', start_date) as start_year                          FROM   financial_data_package.cybersyn.financial_branch_entities                          WHERE  start_date >= '1990-01-01'                             and start_date < '2023-01-01'                          GROUP BY start_year), branches_closed as (SELECT count(*) as n_branches_closed,                                                  date_trunc('YEAR', end_date) as end_year                                           FROM   financial_data_package.cybersyn.financial_branch_entities                                           WHERE  end_date >= '1990-01-01'                                              and end_date < '2023-01-01'                                           GROUP BY end_year) SELECT coalesce(branches_opened.start_year, branches_closed.end_year) as year,        branches_opened.n_branches_opened,        branches_closed.n_branches_closed FROM   branches_opened full     OUTER JOIN branches_closed         ON branches_opened.start_year = branches_closed.end_year WHERE  coalesce(branches_opened.start_year, branches_closed.end_year) >= '1990-01-01' ORDER BY year asc;"
Calculate the monthly inflation rate from the consumer price index for urban consumers,"with cpi_data as (SELECT date,                          value,                          lag(value) OVER (ORDER BY date) as prev_value                   FROM   financial_data_package.cybersyn.financial_fred_timeseries                   WHERE  variable like '%Consumer Price Index%Urban Consumers%') SELECT date,        value as cpi,        (value - prev_value) / prev_value as monthly_inflation_rate FROM   cpi_data WHERE  prev_value is not null ORDER BY date;"
Compare the federal funds effective rate to the monthly inflation rate expressed as a percentage based on the consumer price index for urban consumers since 1970,"with cpi_data as (SELECT date,                          value,                          lag(value) OVER (ORDER BY date) as prev_value                   FROM   financial_data_package.cybersyn.financial_fred_timeseries                   WHERE  variable_name ilike '%Consumer Price Index%Urban Consumers%'                      and date >= '1970-01-01'),  inflation_rate as (SELECT date,                           (value - prev_value) / prev_value * 100 as monthly_inflation_rate                    FROM   cpi_data                    WHERE  prev_value is not null),  federal_funds_rate as (SELECT date,                               value as federal_funds_rate                               FROM   financial_data_package.cybersyn.financial_fred_timeseries                               WHERE  variable_name = 'Federal Funds Effective Rate'                                      and date >= '1970-01-01'                        ) SELECT i.date,        i.monthly_inflation_rate,        f.federal_funds_rate FROM   inflation_rate i join federal_funds_rate f         ON i.date = f.date ORDER BY i.date;"
What is the running total of CFBP complaints by product in 2022?,"SELECT product,        date_received,        count(*) OVER (PARTITION BY product                       ORDER BY date_received) as running_total FROM   financial_data_package.cybersyn.financial_cfpb_complaint WHERE  date_received >= '2022-01-01'    and date_received < '2023-01-01' ORDER BY product, date_received"
"Among the top 10 financial institutions in terms of the mean number of complaints annually between 2020 and 2022, what is the distribution of the total number of complaints received annually per institution by the CFPB?","with companies_complaints as (SELECT company,                                      date_trunc('YEAR', date_received) as year,                                      count(*) as complaints_count                               FROM   financial_data_package.cybersyn.financial_cfpb_complaint                               WHERE  date_received between '2020-01-01'                                  and '2022-12-31'                               GROUP BY company, year having count(*) > 0), top_10_companies as (SELECT company,                                                                          avg(complaints_count) as mean_complaints_count                                                                   FROM   companies_complaints                                                                   GROUP BY company                                                                   ORDER BY mean_complaints_count desc limit 10) SELECT company,        date_trunc('YEAR', date_received) as year,        count(*) as annual_complaints_count FROM   financial_data_package.cybersyn.financial_cfpb_complaint WHERE  company in (SELECT company                    FROM   top_10_companies) and date_received between '2020-01-01' and '2022-12-31' GROUP BY company, year"
"How many of the new branches that were opened since 2020 are from banks new to the state, and which state are they in? ","with new_branches as (SELECT id_rssd_parent,                              state_abbreviation,                              count(*) as new_branch_count                       FROM   financial_data_package.cybersyn.financial_branch_entities                       WHERE  start_date >= '2020-01-01'                       GROUP BY id_rssd_parent, state_abbreviation), pre2020_branches as (SELECT id_rssd_parent,                                                                           state_abbreviation                                                                    FROM   financial_data_package.cybersyn.financial_branch_entities                                                                    WHERE  start_date < '2020-01-01'                                                                       and end_date is null                                                                    GROUP BY id_rssd_parent, state_abbreviation) SELECT new_branches.state_abbreviation,        new_branch_count FROM   new_branches     LEFT JOIN pre2020_branches         ON (new_branches.id_rssd_parent = pre2020_branches.id_rssd_parent and            new_branches.state_abbreviation = pre2020_branches.state_abbreviation) WHERE  pre2020_branches.id_rssd_parent is null ORDER BY new_branch_count desc;"
"Among the top 10 companies in terms of the total number of complaints received between 2018 and 2022 by CFPB, what is the percentage breakdown of the various companies' responses to customers?","with top_10_companies as (SELECT company,                                  count(*) as complaints_count                           FROM   financial_data_package.cybersyn.financial_cfpb_complaint                           WHERE  date_received between '2018-01-01'                              and '2022-12-31'                           GROUP BY company                           ORDER BY complaints_count desc limit 10), company_responses as (SELECT company,                                                                        company_response_to_consumer,                                                                        count(*) as response_count                                                                 FROM   financial_data_package.cybersyn.financial_cfpb_complaint                                                                 WHERE  date_received between '2018-01-01'                                                                    and '2022-12-31'                                                                    and company in (SELECT company                                                                                 FROM   top_10_companies)                                                                 GROUP BY company, company_response_to_consumer) SELECT company,        company_response_to_consumer,        response_count,        response_count*100.0/sum(response_count) OVER (PARTITION BY company) as percentage FROM   company_responses ORDER BY company, percentage desc"
"Since 2020, how many new branches have banks opened in each state?","with new_branches as (SELECT state_abbreviation,                              count(*) as new_branch_count                       FROM   financial_data_package.cybersyn.financial_branch_entities                       WHERE  start_date >= '2020-01-01'                       GROUP BY state_abbreviation) SELECT state_abbreviation,        new_branch_count FROM   new_branches ORDER BY new_branch_count desc;"
"Among the top 10 companies in terms of the total number of complaints received between 2018 and 2022 by CFPB, what are the percentages of each company's various responses to customers?","with top_10_companies as (SELECT company,                                  count(*) as complaints_count                           FROM   financial_data_package.cybersyn.financial_cfpb_complaint                           WHERE  date_received between '2018-01-01'                              and '2022-12-31'                           GROUP BY company                           ORDER BY complaints_count desc limit 10), company_responses as (SELECT company,                                                                        company_response_to_consumer,                                                                        count(*) as response_count                                                                 FROM   financial_data_package.cybersyn.financial_cfpb_complaint                                                                 WHERE  date_received between '2018-01-01'                                                                    and '2022-12-31'                                                                    and company in (SELECT company                                                                                 FROM   top_10_companies)                                                                 GROUP BY company, company_response_to_consumer) SELECT company,        company_response_to_consumer,        response_count,        response_count * 100.0 / sum(response_count) OVER (PARTITION BY company) as percentage FROM   company_responses ORDER BY company, percentage desc"
Compare the seasonally adjusted Consumer Price Index for urban consumers to the Federal Funds Effective Rate,"SELECT a.date,        a.value as cpi,        b.value as federal_funds_rate FROM   financial_data_package.cybersyn.financial_fred_timeseries a  INNER join financial_data_package.cybersyn.financial_fred_timeseries b         ON a.date = b.date WHERE  a.variable like '%Consumer Price Index%Urban Consumers%Seasonally adjusted%'    and b.variable = 'Federal Funds Effective Rate' ORDER BY a.date;"
"Among the top 10 companies in terms of the total number of complaints received between 2020 and 2022 by CFPB, what are the various companies' responses to customers in each year expressed in percentage terms?","with top_10_companies as (SELECT company,                                  count(*) as complaints_count                           FROM   financial_data_package.cybersyn.financial_cfpb_complaint                           WHERE  date_received between '2020-01-01'                              and '2022-12-31'                           GROUP BY company                           ORDER BY complaints_count desc limit 10), company_responses as (SELECT company,                                                                        company_response_to_consumer,                                                                        date_trunc('YEAR', date_received) as year,                                                                        count(*) as response_count                                                                 FROM   financial_data_package.cybersyn.financial_cfpb_complaint                                                                 WHERE  date_received between '2020-01-01'                                                                    and '2022-12-31'                                                                    and company in (SELECT company                                                                                 FROM   top_10_companies)                                                                 GROUP BY company, company_response_to_consumer, year) SELECT company,        year,        company_response_to_consumer,        response_count * 100.0 / sum(response_count) OVER (PARTITION BY company,                                                                        year) as percentage FROM   company_responses ORDER BY company, year, percentage desc"
What are the names of the top 5 customers in terms of total sales?,"SELECT c.c_name AS customer_name, SUM(l.l_quantity * l.l_extendedprice) AS total_sales FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON c.c_custkey = o.o_custkey JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l ON o.o_orderkey = l.l_orderkey GROUP BY customer_name ORDER BY total_sales DESC LIMIT 5"
What is the total sales and number of customers for each region?,"SELECT r.r_name AS region, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON l.l_orderkey = o.o_orderkey JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c ON o.o_custkey = c.c_custkey JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n ON c.c_nationkey = n.n_nationkey JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.REGION r ON n.n_regionkey = r.r_regionkey GROUP BY region"
What are the banks with the highest number of new branches since 2020?,"The corrected SQL code is:  ``` WITH new_branches AS (     SELECT id_rssd_parent, COUNT(*) AS new_branch_count     FROM financial_data_package.cybersyn.financial_branch_entities     WHERE start_date >= '2020-01-01'     GROUP BY id_rssd_parent ), bank_names AS (     SELECT id_rssd, name     FROM financial_data_package.cybersyn.financial_institution_entities ) SELECT name, new_branch_count FROM bank_names INNER JOIN new_branches ON (bank_names.id_rssd = new_branches.id_rssd_parent) ORDER BY new_branch_count DESC; ```  The error message was caused by the reference to an invalid column name in the `SELECT` clause of the `bank_names` subquery. The column `name_parent` does not exist in the `financial_institution_entities` table. I have corrected this by selecting the `name` column instead."
Calculate the total quarterly net income for the banking industry over the last four decades,"SELECT att.variable_name,        ts.date,        ts.value FROM financial_data_package.cybersyn.financial_fred_timeseries AS ts JOIN financial_data_package.cybersyn.financial_fred_attributes AS att ON (ts.variable = att.variable) WHERE att.variable_name = 'Income and Expense: Net Income (Loss) Attributable to Bank, Not seasonally adjusted, Quarterly, USD'   AND ts.date >= '1984-01-01';"
"Among the top 10 companies in terms of the total number of complaints received between 2020 and 2022 by CFPB, what are the various companies' responses to customers expressed in percentage terms?","with top_10_companies as (SELECT company,                                  count(*) as complaints_count                           FROM   financial_data_package.cybersyn.financial_cfpb_complaint                           WHERE  date_received between '2020-01-01'                              and '2022-12-31'                           GROUP BY company                           ORDER BY complaints_count desc limit 10), company_responses as (SELECT company,                                                                        company_response_to_consumer,                                                                        count(*) as response_count                                                                 FROM   financial_data_package.cybersyn.financial_cfpb_complaint                                                                 WHERE  date_received between '2020-01-01'                                                                    and '2022-12-31'                                                                    and company in (SELECT company                                                                                 FROM   top_10_companies)                                                                 GROUP BY company, company_response_to_consumer) SELECT company,        company_response_to_consumer,        response_count * 100.0 / sum(response_count) OVER (PARTITION BY company) as percentage FROM   company_responses ORDER BY company, percentage desc"
Randomly sample 10 CFPB customer complaints from the institution with the most number of complaints,"SELECT company,        consumer_complaint_narrative FROM   financial_data_package.cybersyn.financial_cfpb_complaint WHERE  company = (SELECT company                   FROM   financial_data_package.cybersyn.financial_cfpb_complaint                   GROUP BY company                   ORDER BY count(*) desc limit 1) and consumer_complaint_narrative is not null ORDER BY random() limit 10"
How many CFPB complaints were there by state?,"SELECT state,        count(*) as count FROM   financial_data_package.cybersyn.financial_cfpb_complaint GROUP BY state ORDER BY count desc"
What is the 30 year fixed rate mortgage average in the united states?,SELECT avg(value) as avg_rate FROM   financial_data_package.cybersyn.financial_fred_timeseries WHERE  variable = 'MORTGAGE30US'
What are the first 10 rows in the FINANCIAL_BRANCH_ENTITIES table?,"SELECT ID_RSSD, ID_RSSD_PARENT, NAME_PARENT, BRANCH_NAME, CATEGORY, IS_ACTIVE, START_DATE, END_DATE, ADDRESS, ADDRESS_LINE2, CITY, STATE_ABBREVIATION, ZIP_CODE, ID_COUNTRY, ID_STATE, ID_COUNTY, ID_ZIP FROM FINANCIAL_DATA_PACKAGE.CYBERSYN.FINANCIAL_BRANCH_ENTITIES LIMIT 10"
How many CPFB complaints of each product were made in 2022,"SELECT product,        count(*) as count FROM   financial_data_package.cybersyn.financial_cfpb_complaint WHERE  date_received between '2022-01-01'    and '2022-12-31' GROUP BY product ORDER BY count desc"
"Among the top 5 companies in terms of the total number of complaints received between 2020 and 2022 by CFPB, what is the percentage breakdown of the various companies' responses to customers in each year?","with top_5_companies as (SELECT company,                                 count(*) as total_complaints                          FROM   financial_data_package.cybersyn.financial_cfpb_complaint                          WHERE  date_received between '2020-01-01'                             and '2022-12-31'                          GROUP BY company                          ORDER BY total_complaints desc limit 5), company_responses as (SELECT company,                                                                       company_response_to_consumer,                                                                       date_trunc('year', date_received) as year,                                                                       count(*) as response_count                                                                FROM   financial_data_package.cybersyn.financial_cfpb_complaint                                                                WHERE  date_received between '2020-01-01'                                                                   and '2022-12-31'                                                                   and company in (SELECT company                                                                                FROM   top_5_companies)                                                                GROUP BY company, company_response_to_consumer, year) SELECT company,        year,        company_response_to_consumer,        response_count,        response_count*100.0/sum(response_count) OVER (PARTITION BY company,                                                                    year) as percentage FROM   company_responses ORDER BY company, year, percentage desc"
What are the first 10 rows in the GEOGRAPHY_HIERARCHY table?,"SELECT PARENT_GEO_ID, GEO_ID FROM FINANCIAL_DATA_PACKAGE.CYBERSYN.GEOGRAPHY_HIERARCHY LIMIT 10"
What is the mean monthly not seasonally adjusted unemployment rates of Canada between 2007 and 2022,"SELECT date,        avg(value) as avg_unemployment_rate FROM   financial_data_package.cybersyn.bureau_of_labor_statistics_employment_timeseries WHERE  variable_name like '%Unemployment Rate%Not seasonally adjusted%'    and date between '2007-01-01'    and '2022-12-31'    and geo_id like '%CA%' GROUP BY date ORDER BY date;"
What are the first 10 rows in the FINANCIAL_INSTITUTION_EVENTS table?,"SELECT ID_RSSD_SUCCESSOR, NAME_SUCCESSOR, ACTIVE_SUCCESSOR, CATEGORY_SUCCESSOR, ID_RSSD_PREDECESSOR, NAME_PREDECESSOR, ACTIVE_PREDECESSOR, CATEGORY_PREDECESSOR, TRANSACTION_DATE, TRANSFORMATION_TYPE, MERGER_ACCOUNTING_METHOD_UTILIZED FROM FINANCIAL_DATA_PACKAGE.CYBERSYN.FINANCIAL_INSTITUTION_EVENTS LIMIT 10"
"What are the number of countries in each region, in descending order?","SELECT r.r_name AS region_name, COUNT(DISTINCT n.n_name) AS num_countries FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.REGION r  JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n ON r.r_regionkey = n.n_regionkey GROUP BY region_name ORDER BY num_countries DESC"
What are the top 3 customers by sales ranking for each of the top 2 regions by total sales?,"WITH   sales_by_region AS (     SELECT       r.r_name AS region_name,       c.c_name AS customer_name,       SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales     FROM       SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l       JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON l.l_orderkey = o.o_orderkey       JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c ON o.o_custkey = c.c_custkey       JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n ON c.c_nationkey = n.n_nationkey       JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.REGION r ON n.n_regionkey = r.r_regionkey     GROUP BY       region_name,       customer_name   ),   ranked_sales AS (     SELECT       region_name,       customer_name,       total_sales,       RANK() OVER (         PARTITION BY region_name         ORDER BY total_sales DESC       ) AS sales_rank     FROM       sales_by_region   ) SELECT * FROM ranked_sales WHERE region_name IN (   SELECT     r.r_name   FROM     SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l     JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON l.l_orderkey = o.o_orderkey     JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c ON o.o_custkey = c.c_custkey     JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n ON c.c_nationkey = n.n_nationkey     JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.REGION r ON n.n_regionkey = r.r_regionkey   GROUP BY     r.r_name   ORDER BY     SUM(l.l_extendedprice * (1 - l.l_discount)) DESC   LIMIT 2 ) AND sales_rank <= 3;"
What are the names of the top three customers in terms of total sales?,"SELECT c.c_name AS customer_name, SUM(l.l_quantity * l.l_extendedprice) AS total_sales FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON c.c_custkey = o.o_custkey JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l ON o.o_orderkey = l.l_orderkey GROUP BY customer_name ORDER BY total_sales DESC LIMIT 3"
What are the total sales for each year for the most popular part?,"SELECT    TO_CHAR(o.o_orderdate, 'YYYY') AS order_year,    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales FROM    SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON l.l_orderkey = o.o_orderkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.PART p ON l.l_partkey = p.p_partkey WHERE    p.p_name = (     SELECT        p_name      FROM        SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.PART      JOIN        SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM ON p_partkey = l_partkey      GROUP BY        p_name      ORDER BY        SUM(l_quantity) DESC      LIMIT 1   ) GROUP BY    order_year ORDER BY    order_year;"
"Among the top 10 zip codes in terms of the total number of complaints received between 2018 and 2022 by CFPB, what is the percentage breakdown of the various responses to customers? ","with top_10_zip_codes as (SELECT id_zip,                                  count(*) as complaints_count                           FROM   financial_data_package.cybersyn.financial_cfpb_complaint                           WHERE  date_trunc('year', date_received) between '2018-01-01'                              and '2022-12-31'                           GROUP BY id_zip                           ORDER BY complaints_count desc limit 10), zip_code_company_responses as (SELECT id_zip,                                                                                 company_response_to_consumer,                                                                                 count(*) as response_count                                                                          FROM   financial_data_package.cybersyn.financial_cfpb_complaint                                                                          WHERE  date_trunc('year', date_received) between '2018-01-01'                                                                             and '2022-12-31'                                                                             and id_zip in (SELECT id_zip                                                                                         FROM   top_10_zip_codes)                                                                          GROUP BY id_zip, company_response_to_consumer) SELECT id_zip,        company_response_to_consumer,        response_count,        response_count*100.0/sum(response_count) OVER (PARTITION BY id_zip) as percentage FROM   zip_code_company_responses WHERE  id_zip in (SELECT id_zip                   FROM   top_10_zip_codes) ORDER BY id_zip, percentage desc"
What are the first 10 rows in the GEOGRAPHY_OVERLAPS table?,"SELECT GEO_ID, OVERLAPS_WITH FROM FINANCIAL_DATA_PACKAGE.CYBERSYN.GEOGRAPHY_OVERLAPS LIMIT 10"
Which is the zip code with the most number of bank branches,"SELECT id_zip,        count(*) as branch_count FROM   financial_data_package.cybersyn.financial_branch_entities WHERE  end_date is null GROUP BY id_zip ORDER BY branch_count desc limit 1;"
"Using the BLS Price time series, calculate the monthly inflation percentage of airline fares using the consumer price index of airline fares since 1980","with airline_cpi as (SELECT date_trunc('month', date) as month,                             value as cpi                      FROM   financial_data_package.cybersyn.bureau_of_labor_statistics_price_timeseries                      WHERE  variable_name ilike 'cpi%airline fares%monthly%'                         and date >= '1980-01-01'), monthly_inflation as (SELECT month,                                                         (cpi - lag(cpi) OVER (ORDER BY month)) / lag(cpi) OVER (ORDER BY month) * 100 as inflation_percentage                                                  FROM   airline_cpi) SELECT month,        inflation_percentage FROM   monthly_inflation WHERE  inflation_percentage is not null ORDER BY month;"
"For each type of complaint made to CFPB between 2020 and 2022, what is the probability of receiving monetary relief as a company response to consumer?","with complaints_product_response as (SELECT product,                                             company_response_to_consumer,                                             count(*) as count                                      FROM   financial_data_package.cybersyn.financial_cfpb_complaint                                      WHERE  date_received between '2020-01-01'                                         and '2022-12-31'                                      GROUP BY product, company_response_to_consumer), complaints_product as (SELECT product,                                                                                count(*) as n_complaints                                                                         FROM   financial_data_package.cybersyn.financial_cfpb_complaint                                                                         WHERE  date_received between '2020-01-01'                                                                            and '2022-12-31'                                                                         GROUP BY product) SELECT r.product,        100*r.count/n_complaints as prob_relief FROM   complaints_product_response as r     INNER JOIN complaints_product as p         ON p.product = r.product WHERE  r.company_response_to_consumer like '% monetary relief';"
What are the first 10 rows in the FINANCIAL_INSTITUTION_TIMESERIES table?,"SELECT ID_RSSD, VARIABLE, VARIABLE_NAME, VALUE, UNIT, DATE FROM FINANCIAL_DATA_PACKAGE.CYBERSYN.FINANCIAL_INSTITUTION_TIMESERIES LIMIT 10"
What are the first 10 rows in the FINANCIAL_CFPB_COMPLAINT table?,"SELECT ID_ZIP, ID_STATE, PRODUCT, SUB_PRODUCT, ISSUE, SUB_ISSUE, COMPANY, CONSUMER_COMPLAINT_NARRATIVE, COMPANY_PUBLIC_RESPONSE, COMPANY_RESPONSE_TO_CONSUMER, STATE, ZIP_CODE, TAGS, CONSUMER_CONSENT_PROVIDED, SUBMITTED_VIA, CONSUMER_DISPUTED, DATE_RECEIVED, DATE_SENT_TO_COMPANY, TIMELY_RESPONSE FROM FINANCIAL_DATA_PACKAGE.CYBERSYN.FINANCIAL_CFPB_COMPLAINT LIMIT 10"
Compare the states mean monthly not seasonally adjusted unemployment rates in 2008-2010 versus 2020-2022 and select the 10 states with the biggest differences,"with unemployment_rate_2008_2010 as (SELECT geo_name,                                             avg(value) as avg_unemployment_rate                                      FROM   financial_data_package.cybersyn.bureau_of_labor_statistics_employment_timeseries join financial_data_package.cybersyn.geography_index                                              ON bureau_of_labor_statistics_employment_timeseries.geo_id = geography_index.geo_id                                      WHERE  variable_name like '%Unemployment Rate%Not seasonally adjusted%'                                         and date between '2008-01-01'                                         and '2010-12-31'                                         and level = 'State'                                      GROUP BY geo_name), unemployment_rate_2020_2022 as (SELECT geo_name,                                                            avg(value) as avg_unemployment_rate                                                     FROM   financial_data_package.cybersyn.bureau_of_labor_statistics_employment_timeseries join financial_data_package.cybersyn.geography_index                                                             ON bureau_of_labor_statistics_employment_timeseries.geo_id = geography_index.geo_id                                                     WHERE  variable_name like '%Unemployment Rate%Not seasonally adjusted%'                                                        and date between '2020-01-01'                                                        and '2022-12-31'                                                        and level = 'State'                                                     GROUP BY geo_name), differences as (SELECT u1.geo_name,                                            u1.avg_unemployment_rate as avg_unemployment_rate_2008_2010,                                            u2.avg_unemployment_rate as avg_unemployment_rate_2020_2022,                                            u2.avg_unemployment_rate - u1.avg_unemployment_rate as difference                                     FROM   unemployment_rate_2008_2010 u1 join unemployment_rate_2020_2022 u2                                             ON u1.geo_name = u2.geo_name) SELECT geo_name,        avg_unemployment_rate_2008_2010,        avg_unemployment_rate_2020_2022,        difference FROM   differences ORDER BY abs(difference) desc limit 10;"
What are the first 10 rows in the FINANCIAL_INSTITUTION_HIERARCHY table?,"SELECT ID_RSSD_PARENT, NAME_PARENT, ACTIVE_PARENT, CATEGORY_PARENT, ID_RSSD_OFFSPRING, NAME_OFFSPRING, ACTIVE_OFFSPRING, CATEGORY_OFFSPRING, RELATIONSHIP_TERMINATED, PARENT_CONTROLS_OFFSPRING, PERCENT_CONTROL_OF_OFFSPRING, RELATIONSHIP_LEVEL FROM FINANCIAL_DATA_PACKAGE.CYBERSYN.FINANCIAL_INSTITUTION_HIERARCHY LIMIT 10"
"Using the BLS Price time series, calculate the monthly percentage change in airline fares using the consumer price index of airline fares since 1980","with airline_cpi as (SELECT date_trunc('month', date) as month,                             value as cpi                      FROM   financial_data_package.cybersyn.bureau_of_labor_statistics_price_timeseries                      WHERE  variable_name ilike 'CPI%Airline Fares%Not Seasonally Adjusted%Monthly%'                         and date >= '1980-01-01'), monthly_percentage_change as (SELECT month,                                                                 (cpi - lag(cpi) OVER (ORDER BY month)) / lag(cpi) OVER (ORDER BY month) * 100 as percentage_change                                                          FROM   airline_cpi) SELECT month,        percentage_change FROM   monthly_percentage_change WHERE  percentage_change is not null ORDER BY month DESC;"
Compare the Bank Prime Loan Rate to the Federal Funds Effective Rate,"SELECT a.date,        a.value as bank_prime_loan_rate,        b.value as federal_funds_effective_rate FROM   financial_data_package.cybersyn.financial_fred_timeseries a join financial_data_package.cybersyn.financial_fred_timeseries b         ON a.date = b.date WHERE  a.variable_name like '%Bank Prime Loan Rate%'    and b.variable_name = 'Federal Funds Effective Rate' ORDER BY a.date;"
What are the first 10 rows in the FINANCIAL_INSTITUTION_ENTITIES table?,"SELECT ID_RSSD, NAME, CATEGORY, IS_ACTIVE, ADDRESS, CITY, STATE_ABBREVIATION, ZIP_CODE, URL, START_DATE, END_DATE, CHARTERING_AUTHORITY, CHARTER_TYPE, FEDERAL_REGULATOR, ENTITY_TYPE, INSURER, FDIC_CERT, OCC_ID, THRIFT_ID, ID_COUNTRY, ID_STATE, ID_COUNTY, ID_ZIP, LEGAL_ENTITY_IDENTIFIER, EMPLOYER_IDENTIFICATION_NUMBER, REASON_FOR_ENTITY_TERMINATION, INTERNATIONAL_BANKING_FACILITY, NAICS_CODE, MAJORITY_OWNED_BY_MINORITY_OR_WOMEN, SPECIALIZATION_GROUP FROM FINANCIAL_DATA_PACKAGE.CYBERSYN.FINANCIAL_INSTITUTION_ENTITIES LIMIT 10"
What are the average hourly earnings of employees in accommodation and food services in Hawaii since 2010?,"SELECT L.GEO_ID, GEO_NAME, LEVEL, VARIABLE_NAME, VALUE, DATE FROM financial_data_package.cybersyn.BUREAU_OF_LABOR_STATISTICS_EMPLOYMENT_TIMESERIES AS L INNER JOIN financial_data_package.cybersyn.GEOGRAPHY_INDEX AS G     ON L.GEO_ID = G.GEO_ID WHERE VARIABLE_NAME LIKE '%Hourly Earnings%Leisure and Hospitality: Accommodation and Food Services%'  AND VARIABLE_NAME LIKE '%seasonally adjusted%Monthly%' AND DATE > to_date('2010-01-01') AND GEO_NAME = 'Hawaii'"
What are the top 7 customers ranked by total sales?,"SELECT c.c_name AS customer_name, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON l.l_orderkey = o.o_orderkey JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c ON o.o_custkey = c.c_custkey GROUP BY customer_name ORDER BY total_sales DESC LIMIT 7"
Compare the growth and decline of bank branches by state since the start of the pandemic,"WITH pre_covid AS (     SELECT state_abbreviation,            COUNT(*) AS pre_covid_count     FROM financial_data_package.cybersyn.financial_branch_entities     WHERE start_date <= '2020-03-01'       AND (end_date >= '2020-03-01' OR end_date IS NULL)     GROUP BY state_abbreviation ) SELECT cur.state_abbreviation,        pre_covid_count,        COUNT(*)                            AS current_count,        current_count / pre_covid_count - 1 AS pct_change FROM financial_data_package.cybersyn.financial_branch_entities AS cur INNER JOIN pre_covid ON (cur.state_abbreviation = pre_covid.state_abbreviation) WHERE end_date IS NULL GROUP BY cur.state_abbreviation, pre_covid_count ORDER BY pct_change;"
Sample 10 CFPB customer complaints from the institution with the most number of complaints,"SELECT company,        consumer_complaint_narrative FROM   financial_data_package.cybersyn.financial_cfpb_complaint WHERE  company = (SELECT company                   FROM   financial_data_package.cybersyn.financial_cfpb_complaint                   GROUP BY company                   ORDER BY count(*) desc limit 1) and consumer_complaint_narrative is not null limit 10"
"Since 2020, which banks opened new branches in states they were new to, how many new branches were there in each state, and what are the names of these states?  ","with new_branches as (SELECT id_rssd_parent,                              state_abbreviation,                              count(*) as new_branch_count                       FROM   financial_data_package.cybersyn.financial_branch_entities                       WHERE  start_date >= '2020-01-01'                       GROUP BY id_rssd_parent, state_abbreviation), pre2020_branches as (SELECT id_rssd_parent,                                                                           state_abbreviation                                                                    FROM   financial_data_package.cybersyn.financial_branch_entities                                                                    WHERE  start_date < '2020-01-01'                                                                       and end_date is null                                                                       and state_abbreviation is not null                                                                    GROUP BY id_rssd_parent, state_abbreviation) SELECT bank_names.name,        new_branches.state_abbreviation,        new_branch_count FROM   new_branches     INNER JOIN financial_data_package.cybersyn.financial_institution_entities as bank_names         ON (new_branches.id_rssd_parent = bank_names.id_rssd)     LEFT JOIN pre2020_branches         ON (new_branches.id_rssd_parent = pre2020_branches.id_rssd_parent and            new_branches.state_abbreviation = pre2020_branches.state_abbreviation) WHERE  pre2020_branches.id_rssd_parent is null ORDER BY new_branch_count desc, bank_names.name;"
What are the annual hourly earnings of employees in the accommodation and food services sector in each state since 2000?,"SELECT l.geo_id,        geo_name,        level,        variable_name,        value,        date FROM   financial_data_package.cybersyn.bureau_of_labor_statistics_employment_timeseries as l     INNER JOIN financial_data_package.cybersyn.geography_index as g         ON l.geo_id = g.geo_id WHERE  variable_name like '%Leisure and Hospitality: Accommodation and Food Services%'    and variable_name like '%Average Hourly Earnings%Annual%'    and date > to_date('2000-01-01')    and level = 'State' ORDER BY geo_name, date desc"
Which are the top 10 banks by the number of branches closed in 2022?,"with branches_closed as (SELECT id_rssd_parent,                                 count(*) as n_branches_closed                          FROM   financial_data_package.cybersyn.financial_branch_entities                          WHERE  end_date between '2022-01-01'                             and '2022-12-31'                          GROUP BY id_rssd_parent) SELECT name,        n_branches_closed FROM   branches_closed     INNER JOIN financial_data_package.cybersyn.financial_institution_entities as ent         ON (branches_closed.id_rssd_parent = ent.id_rssd) ORDER BY n_branches_closed desc limit 10;"
"Since 2000, how many new branches have been opened per year?","SELECT date_trunc('YEAR', start_date) as year,        count(*) as n_branches_opened FROM   financial_data_package.cybersyn.financial_branch_entities WHERE  start_date >= '2000-01-01' GROUP BY year ORDER BY year asc;"
"How many of the new branches that were opened since 2020 are from banks new to the state, and which state are they in, and what are the names of the banks? ","with new_branches as (SELECT id_rssd_parent,                              state_abbreviation,                              count(*) as new_branch_count                       FROM   financial_data_package.cybersyn.financial_branch_entities                       WHERE  start_date >= '2020-01-01'                       GROUP BY id_rssd_parent, state_abbreviation), pre2020_branches as (SELECT id_rssd_parent,                                                                           state_abbreviation                                                                    FROM   financial_data_package.cybersyn.financial_branch_entities                                                                    WHERE  start_date < '2020-01-01'                                                                       and end_date is null                                                                       and state_abbreviation is not null                                                                    GROUP BY id_rssd_parent, state_abbreviation) SELECT new_branches.state_abbreviation,        new_branch_count,        bank_names.name FROM   new_branches     INNER JOIN financial_data_package.cybersyn.financial_institution_entities as bank_names         ON new_branches.id_rssd_parent = bank_names.id_rssd     LEFT JOIN pre2020_branches         ON new_branches.id_rssd_parent = pre2020_branches.id_rssd_parent and            new_branches.state_abbreviation = pre2020_branches.state_abbreviation WHERE  pre2020_branches.id_rssd_parent is null ORDER BY new_branch_count desc, new_branches.state_abbreviation, bank_names.name;"
Which are the top 10 cities by the number of new branches opened in 2022?,"with new_branches as (SELECT city,                              state_abbreviation,                              count(*) as new_branch_count                       FROM   financial_data_package.cybersyn.financial_branch_entities                       WHERE  start_date >= '2022-01-01'                       GROUP BY city, state_abbreviation) SELECT city || ', ' || state_abbreviation as city_state,        new_branch_count FROM   new_branches ORDER BY new_branch_count desc limit 10;"
Determine which banks have the highest percentage of uninsured deposits,"WITH big_banks AS (     SELECT id_rssd     FROM financial_data_package.cybersyn.financial_institution_timeseries     WHERE variable = 'ASSET'       AND date = '2022-12-31'       AND value > 1E10 ) SELECT name,        1 - value AS pct_uninsured,        ent.is_active FROM financial_data_package.cybersyn.financial_institution_timeseries AS ts INNER JOIN financial_data_package.cybersyn.financial_institution_attributes AS att ON (ts.variable = att.variable) INNER JOIN financial_data_package.cybersyn.financial_institution_entities AS ent ON (ts.id_rssd = ent.id_rssd) INNER JOIN big_banks ON (big_banks.id_rssd = ts.id_rssd) WHERE ts.date = '2022-12-31'   AND att.variable_name = '% Insured (Estimated)'   AND att.frequency = 'Quarterly' ORDER BY pct_uninsured DESC;"
"What is the 3 month running average of each states' mean monthly not seasonally adjusted unemployment rates, between 2007 to 2022?","with monthly_unemployment_rates as (SELECT g.geo_name,                                            b.date,                                            avg(b.value) as avg_unemployment_rate                                     FROM   financial_data_package.cybersyn.bureau_of_labor_statistics_employment_timeseries b join financial_data_package.cybersyn.geography_index g                                             ON b.geo_id = g.geo_id                                     WHERE  b.variable_name like '%Unemployment Rate%Not seasonally adjusted%'                                        and b.date between '2007-01-01'                                        and '2022-12-31'                                        and g.level = 'State'                                     GROUP BY g.geo_name, b.date) SELECT geo_name,        date,        avg(avg_unemployment_rate) OVER (PARTITION BY geo_name                                         ORDER BY date rows between 1 preceding and 1 following) as three_month_running_avg FROM   monthly_unemployment_rates ORDER BY geo_name, date;"
"Since 2005, how many new branches have been opened per year?","SELECT date_trunc('YEAR', start_date) as year,        count(*) as n_branches_opened FROM   financial_data_package.cybersyn.financial_branch_entities WHERE  start_date >= '2005-01-01' GROUP BY year ORDER BY year asc;"
"In each state, what is the percentage of existing bank branches that only began operations since 2020?","with new_branches as (SELECT state_abbreviation,                              count(*) as new_branch_count                       FROM   financial_data_package.cybersyn.financial_branch_entities                       WHERE  start_date >= '2020-01-01'                       GROUP BY state_abbreviation), all_branches as (SELECT state_abbreviation,                                                       count(*) as all_branch_count                                                FROM   financial_data_package.cybersyn.financial_branch_entities                                                WHERE  end_date is null                                                GROUP BY state_abbreviation) SELECT all_branches.state_abbreviation,        100.0 * new_branch_count / all_branch_count as pct_new_branches FROM   all_branches     INNER JOIN new_branches         ON (all_branches.state_abbreviation = new_branches.state_abbreviation) ORDER BY pct_new_branches desc"
How many CPFB complaints of each product were made cumulatively in 2022?,"SELECT product,        date_trunc('month', date_received) as month,        count(*) OVER (PARTITION BY product,                                    date_trunc('month', date_received)                       ORDER BY date_received) as cumulative_count FROM   financial_data_package.cybersyn.financial_cfpb_complaint WHERE  date_received >= '2022-01-01'    and date_received < '2023-01-01' ORDER BY product, month;"
How many bank failures are there in each year since 1945?,"SELECT COUNT(NAME_PREDECESSOR) AS N_BANKS, DATE_TRUNC('YEAR', TRANSACTION_DATE) AS TRANSACTION_YEAR FROM FINANCIAL_DATA_PACKAGE.CYBERSYN.FINANCIAL_INSTITUTION_EVENTS WHERE TRANSFORMATION_TYPE = 'Failure' AND CATEGORY_PREDECESSOR = 'Bank' GROUP BY TRANSACTION_YEAR ORDER BY TRANSACTION_YEAR DESC"
"Since 2010, how many new branches have been opened per year?","SELECT date_trunc('YEAR', start_date) as year,        count(*) as n_branches_opened FROM   financial_data_package.cybersyn.financial_branch_entities WHERE  start_date >= '2010-01-01' GROUP BY year ORDER BY year asc;"
"What are the top 10 countries ranked by total sales, based on customer and order data?","SELECT   n.n_name AS country_name,   SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales FROM   SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c ON n.n_nationkey = c.c_nationkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON c.c_custkey = o.o_custkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l ON o.o_orderkey = l.l_orderkey GROUP BY country_name ORDER BY total_sales DESC LIMIT 10;"
What are the first 10 rows in the GEOGRAPHY_INDEX table?,"SELECT GEO_ID, GEO_NAME, LEVEL, ISO_NAME, ISO_ALPHA2, ISO_ALPHA3, ISO_NUMERIC_CODE, ISO_3166_2_CODE FROM CYBERSYN_US__GLOBAL_PUBLIC_DATA_STARTER_KIT.CYBERSYN.GEOGRAPHY_INDEX LIMIT 10"
"Using the BLS Price time series, calculate the annualized monthly inflation percentage of airline fares using the consumer price index of airline fares since 1980","with airline_cpi as (SELECT date_trunc('month', date) as month,                             value as cpi                      FROM   financial_data_package.cybersyn.bureau_of_labor_statistics_price_timeseries                      WHERE  variable_name ilike 'cpi%airline fares%monthly%'                         and date >= '1980-01-01'), monthly_inflation as (SELECT month,                                                         (power(1+ (cpi - lag(cpi) OVER (ORDER BY month)) / lag(cpi) OVER (ORDER BY month),12)-1) * 100 as inflation_percentage                                                  FROM   airline_cpi) SELECT month,        inflation_percentage FROM   monthly_inflation WHERE  inflation_percentage is not null ORDER BY month;"
"In each state, what percentage of bank branches are new? New is defined as a branch that began operations since 2020","with new_branches as (SELECT state_abbreviation,                              count(*) as new_branch_count                       FROM   financial_data_package.cybersyn.financial_branch_entities                       WHERE  start_date >= '2020-01-01'                       GROUP BY state_abbreviation), all_branches as (SELECT state_abbreviation,                                                       count(*) as all_branch_count                                                FROM   financial_data_package.cybersyn.financial_branch_entities                                                WHERE  end_date is null                                                GROUP BY state_abbreviation) SELECT all_branches.state_abbreviation,        100.0 * new_branch_count / all_branch_count as pct_new_branches FROM   all_branches     INNER JOIN new_branches         ON (all_branches.state_abbreviation = new_branches.state_abbreviation) ORDER BY pct_new_branches desc"
"How many of the new branches that were opened since 2020 are from banks new to the state, which state are they in, and what are the names of the banks? ","with new_branches as (SELECT id_rssd_parent,                              state_abbreviation,                              count(*) as new_branch_count                       FROM   financial_data_package.cybersyn.financial_branch_entities                       WHERE  start_date >= '2020-01-01'                       GROUP BY id_rssd_parent, state_abbreviation), pre2020_branches as (SELECT id_rssd_parent,                                                                           state_abbreviation                                                                    FROM   financial_data_package.cybersyn.financial_branch_entities                                                                    WHERE  start_date < '2020-01-01'                                                                       and end_date is null                                                                       and state_abbreviation is not null                                                                    GROUP BY id_rssd_parent, state_abbreviation) SELECT bank_names.name,        new_branches.state_abbreviation,        new_branch_count FROM   new_branches     INNER JOIN financial_data_package.cybersyn.financial_institution_entities as bank_names         ON new_branches.id_rssd_parent = bank_names.id_rssd     LEFT JOIN pre2020_branches         ON new_branches.id_rssd_parent = pre2020_branches.id_rssd_parent and            new_branches.state_abbreviation = pre2020_branches.state_abbreviation WHERE  pre2020_branches.id_rssd_parent is null ORDER BY new_branch_count desc, new_branches.state_abbreviation, bank_names.name;"
Create a cumulative frequency distribution of the number of complaints received by CFPB against the financial institution with the most number of complaints in 2022,"with fiwmc_2022_complaints as (SELECT count(*) as n_complaints                                FROM   financial_data_package.cybersyn.financial_cfpb_complaint                                WHERE  company = (SELECT company                                                  FROM   financial_data_package.cybersyn.financial_cfpb_complaint                                                  WHERE  date_received between '2022-01-01'                                                     and '2022-12-31'                                                  GROUP BY company                                                  ORDER BY count(*) desc limit 1) and date_received between '2022-01-01' and '2022-12-31') SELECT n_complaints,        count(*) as frequency,        sum(count(*)) OVER (ORDER BY n_complaints asc) as cumulative_frequency FROM   fiwmc_2022_complaints GROUP BY n_complaints ORDER BY n_complaints asc"
What is the average number of items per order?,"SELECT AVG(total_items) AS avg_order_size FROM (   SELECT o.o_orderkey AS order_id, SUM(l.l_quantity) AS total_items   FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l ON o.o_orderkey = l.l_orderkey   GROUP BY o.o_orderkey )"
What are the top two regions by total sales of all orders?,"SELECT   r.r_name AS region_name,   SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales FROM   SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.REGION r   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n ON r.r_regionkey = n.n_regionkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c ON n.n_nationkey = c.c_nationkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON c.c_custkey = o.o_custkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l ON o.o_orderkey = l.l_orderkey GROUP BY region_name ORDER BY total_sales DESC LIMIT 2;"
How many bank failures are there in each year since 1930?,"SELECT count(name_predecessor) as n_banks,        date_trunc('YEAR', transaction_date) as transaction_year FROM   financial_data_package.cybersyn.financial_institution_events WHERE  transformation_type = 'Failure'    and category_predecessor = 'Bank'    and transaction_date >= '1930-01-01' GROUP BY transaction_year ORDER BY transaction_year desc"
Compare the states mean monthly not seasonally adjusted unemployment rates in 2008-2010 versus 2020-2022?,"with unemployment_rate_2008_2010 as (SELECT geo_name,                                             avg(value) as avg_unemployment_rate                                      FROM   financial_data_package.cybersyn.bureau_of_labor_statistics_employment_timeseries join financial_data_package.cybersyn.geography_index                                              ON bureau_of_labor_statistics_employment_timeseries.geo_id = geography_index.geo_id                                      WHERE  variable_name like '%Unemployment Rate%Not seasonally adjusted%'                                         and date between to_date('2008-01-01')                                         and to_date('2010-12-31')                                         and level = 'State'                                      GROUP BY geo_name), unemployment_rate_2020_2022 as (SELECT geo_name,                                                            avg(value) as avg_unemployment_rate                                                     FROM   financial_data_package.cybersyn.bureau_of_labor_statistics_employment_timeseries join financial_data_package.cybersyn.geography_index                                                             ON bureau_of_labor_statistics_employment_timeseries.geo_id = geography_index.geo_id                                                     WHERE  variable_name like '%Unemployment Rate%Not seasonally adjusted%'                                                        and date between to_date('2020-01-01')                                                        and to_date('2022-12-31')                                                        and level = 'State'                                                     GROUP BY geo_name) SELECT a.geo_name,        a.avg_unemployment_rate as avg_unemployment_rate_2008_2010,        b.avg_unemployment_rate as avg_unemployment_rate_2020_2022 FROM   unemployment_rate_2008_2010 a join unemployment_rate_2020_2022 b         ON a.geo_name = b.geo_name ORDER BY a.geo_name;"
What are the total sales for each region?,"SELECT r.r_name as region,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey join snowflake_sample_data.tpch_sf1.nation n         ON c.c_nationkey = n.n_nationkey join snowflake_sample_data.tpch_sf1.region r         ON n.n_regionkey = r.r_regionkey GROUP BY region ORDER BY total_sales desc;"
How many complaints of each product did CPFB receive in 2022?,"SELECT product,        count(*) as count FROM   financial_data_package.cybersyn.financial_cfpb_complaint WHERE  date_received between '2022-01-01'    and '2022-12-31' GROUP BY product ORDER BY count desc"
How many CPFB complaints of each product were made cumulatively for each month in 2022?,"SELECT product,        date_trunc('month', date_received) as month,        count(*) OVER (PARTITION BY product,                                    date_trunc('month', date_received)                       ORDER BY date_received) as cumulative_count FROM   financial_data_package.cybersyn.financial_cfpb_complaint WHERE  date_received >= '2022-01-01'    and date_received < '2023-01-01' ORDER BY product, month;"
What are the first 10 rows in the FINANCIAL_FRED_TIMESERIES table?,"SELECT GEO_ID, VARIABLE, VARIABLE_NAME, DATE, VALUE, UNIT FROM FINANCIAL_DATA_PACKAGE.CYBERSYN.FINANCIAL_FRED_TIMESERIES LIMIT 10"
What are the top 5 customers in terms of total sales?,"SELECT c.c_name AS customer_name, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON l.l_orderkey = o.o_orderkey JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c ON o.o_custkey = c.c_custkey GROUP BY customer_name ORDER BY total_sales DESC LIMIT 5"
"Between 1990 and 2022, how many bank branches were opened and closed annually?","with branches_opened as (SELECT count(*) as n_branches_opened,                                 date_trunc('YEAR', start_date) as start_year                          FROM   financial_data_package.cybersyn.financial_branch_entities                          WHERE  start_date >= '1990-01-01'                             and start_date < '2022-01-01'                          GROUP BY start_year), branches_closed as (SELECT count(*) as n_branches_closed,                                                  date_trunc('YEAR', end_date) as end_year                                           FROM   financial_data_package.cybersyn.financial_branch_entities                                           WHERE  end_date >= '1990-01-01'                                              and end_date < '2022-01-01'                                           GROUP BY end_year) SELECT coalesce(branches_opened.start_year, branches_closed.end_year) as year,        branches_opened.n_branches_opened,        branches_closed.n_branches_closed FROM   branches_opened full     OUTER JOIN branches_closed         ON branches_opened.start_year = branches_closed.end_year WHERE  coalesce(branches_opened.start_year, branches_closed.end_year) >= '1990-01-01' ORDER BY year asc;"
"Among the top 10 zip codes in terms of the total number of complaints received between 2018 and 2022 by CFPB, what is the percentage breakdown of the various companies' responses to customers? ","with top_10_zip_codes as (SELECT id_zip,                                  count(*) as complaints_count                           FROM   financial_data_package.cybersyn.financial_cfpb_complaint                           WHERE  date_trunc('year', date_received) between '2018-01-01'                              and '2022-12-31'                           GROUP BY id_zip                           ORDER BY complaints_count desc limit 10), zip_code_complaints as (SELECT id_zip,                                                                          company,                                                                          count(*) as complaints_count                                                                   FROM   financial_data_package.cybersyn.financial_cfpb_complaint                                                                   WHERE  date_trunc('year', date_received) between '2018-01-01'                                                                      and '2022-12-31'                                                                      and id_zip in (SELECT id_zip                                                                                  FROM   top_10_zip_codes)                                                                   GROUP BY id_zip, company), zip_code_company_responses as (SELECT id_zip,                                                                  company,                                                                  company_response_to_consumer,                                                                  count(*) as response_count                                                           FROM   financial_data_package.cybersyn.financial_cfpb_complaint                                                           WHERE  date_trunc('year', date_received) between '2018-01-01'                                                              and '2022-12-31'                                                              and id_zip in (SELECT id_zip                                                                          FROM   top_10_zip_codes)                                                           GROUP BY id_zip, company, company_response_to_consumer) SELECT id_zip,        company,        company_response_to_consumer,        response_count,        response_count*100.0/sum(response_count) OVER (PARTITION BY id_zip,                                                                    company) as percentage FROM   zip_code_company_responses WHERE  id_zip in (SELECT id_zip                   FROM   top_10_zip_codes) ORDER BY id_zip asc, company asc, percentage desc"
Which are the top 10 banks by the number of new branches opened in 2022?,"with new_branches as (SELECT id_rssd_parent,                              count(*) as new_branch_count                       FROM   financial_data_package.cybersyn.financial_branch_entities                       WHERE  start_date >= '2022-01-01'                       GROUP BY id_rssd_parent), bank_names as (SELECT id_rssd,                                                 name                                          FROM   financial_data_package.cybersyn.financial_institution_entities) SELECT bank_names.name,        new_branch_count FROM   new_branches     INNER JOIN bank_names         ON new_branches.id_rssd_parent = bank_names.id_rssd ORDER BY new_branch_count desc limit 10;"
How many seasonally adjusted employees are there in the accommodation and food services sector in each state since 2015?,"SELECT l.geo_id,        geo_name,        level,        variable_name,        value,        date FROM   financial_data_package.cybersyn.bureau_of_labor_statistics_employment_timeseries as l     INNER JOIN financial_data_package.cybersyn.geography_index as g         ON l.geo_id = g.geo_id WHERE  variable_name like '%Leisure and Hospitality: Accommodation and Food Services%'    and variable_name like '%Total employment, including self-employed, Not seasonally adjusted, Monthly, Persons, NSA%'    and date > to_date('2015-01-01')    and level = 'State' ORDER BY geo_name, date desc"
Sample a CFPB customer complaint,SELECT consumer_complaint_narrative FROM   financial_data_package.cybersyn.financial_cfpb_complaint WHERE  consumer_complaint_narrative is not null limit 1
What is the CPI for tuition in the USA?,SELECT value as cpi_tuition FROM   financial_data_package.cybersyn.financial_fred_timeseries WHERE  variable = 'CPIAUCSL'    and lower(variable_name) like '%tuition%' ORDER BY date desc limit 1
"Since 2018, how many new branches have been opened per year?","SELECT date_trunc('YEAR', start_date) as year,        count(*) as n_branches_opened FROM   financial_data_package.cybersyn.financial_branch_entities WHERE  start_date >= '2018-01-01' GROUP BY year ORDER BY year asc;"
What are the top 10 customers in terms of total sales?,"SELECT c.c_name AS customer_name, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON l.l_orderkey = o.o_orderkey JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c ON o.o_custkey = c.c_custkey GROUP BY customer_name ORDER BY total_sales DESC LIMIT 10"
Compare the Bank Prime Loan Rate to the Federal Funds Effective Rate and the spread between the two,"SELECT a.date,        a.value as bank_prime_loan_rate,        b.value as federal_funds_effective_rate,        a.value - b.value as spread FROM   financial_data_package.cybersyn.financial_fred_timeseries a join financial_data_package.cybersyn.financial_fred_timeseries b         ON a.date = b.date WHERE  a.variable_name like '%Bank Prime Loan Rate%'    and b.variable_name = 'Federal Funds Effective Rate' ORDER BY a.date;"
"Which is the zip code with the most number of bank branches, excluding none values?","SELECT id_zip,        count(*) as branch_count FROM   financial_data_package.cybersyn.financial_branch_entities WHERE  end_date is null    and id_zip is not null GROUP BY id_zip ORDER BY branch_count desc limit 1;"
Sample 10 states and compare the states mean monthly not seasonally adjusted unemployment rates in 2008-2010 versus 2020-2022,"with unemployment_rate_2008_2010 as (SELECT geo_name,                                             avg(value) as avg_unemployment_rate                                      FROM   financial_data_package.cybersyn.bureau_of_labor_statistics_employment_timeseries join financial_data_package.cybersyn.geography_index                                              ON bureau_of_labor_statistics_employment_timeseries.geo_id = geography_index.geo_id                                      WHERE  variable_name like '%Unemployment Rate%Not seasonally adjusted%'                                         and date between '2008-01-01'                                         and '2010-12-31'                                         and level = 'State'                                      GROUP BY geo_name), unemployment_rate_2020_2022 as (SELECT geo_name,                                                            avg(value) as avg_unemployment_rate                                                     FROM   financial_data_package.cybersyn.bureau_of_labor_statistics_employment_timeseries join financial_data_package.cybersyn.geography_index                                                             ON bureau_of_labor_statistics_employment_timeseries.geo_id = geography_index.geo_id                                                     WHERE  variable_name like '%Unemployment Rate%Not seasonally adjusted%'                                                        and date between '2020-01-01'                                                        and '2022-12-31'                                                        and level = 'State'                                                     GROUP BY geo_name), sample_states as (SELECT geo_name                                       FROM   financial_data_package.cybersyn.geography_index                                       SAMPLE (10)                                       WHERE  level = 'State') -- 10% random sample of states SELECT sample_states.geo_name,        u1.avg_unemployment_rate as avg_unemployment_rate_2008_2010,        u2.avg_unemployment_rate as avg_unemployment_rate_2020_2022 FROM   sample_states     LEFT JOIN unemployment_rate_2008_2010 u1         ON sample_states.geo_name = u1.geo_name     LEFT JOIN unemployment_rate_2020_2022 u2         ON sample_states.geo_name = u2.geo_name ORDER BY sample_states.geo_name;"
"Compare the Federal Funds Effective Rate to the rates set by the Bank of England, and the central banks of Japan and Mexico","SELECT b.date,        a.value as boe_rate,        c.value as boj_rate,        d.value as banxico_rate,        b.value as federal_funds_rate FROM   financial_data_package.cybersyn.financial_fred_timeseries a join financial_data_package.cybersyn.financial_fred_timeseries b         ON a.date = b.date join financial_data_package.cybersyn.financial_fred_timeseries c         ON a.date = c.date join financial_data_package.cybersyn.financial_fred_timeseries d         ON a.date = d.date WHERE  a.variable_name like '%Bank of England%'    and b.variable_name = 'Federal Funds Effective Rate'    and c.variable_name like '%Bank of Japan%'    and d.variable_name like '%Mexico%' ORDER BY b.date;"
What are the first 10 rows in the FINANCIAL_FRED_ATTRIBUTES table?,"SELECT VARIABLE, VARIABLE_NAME, VARIABLE_GROUP, SEASONALLY_ADJUSTED, FREQUENCY, UNIT, MEASUREMENT_METHOD FROM FINANCIAL_DATA_PACKAGE.CYBERSYN.FINANCIAL_FRED_ATTRIBUTES LIMIT 10"
Which are the top 10 banks by the number of branches that have been open for more than 40 years?,"with branch_lifetimes as (SELECT id_rssd_parent,                                  count(*) as branch_lifetime                           FROM   financial_data_package.cybersyn.financial_branch_entities                           WHERE  start_date < '2022-01-01'                              and (end_date >= '2022-01-01'                               or end_date is null)                           GROUP BY id_rssd_parent) SELECT name,        branch_lifetime FROM   branch_lifetimes join financial_data_package.cybersyn.financial_institution_entities         ON financial_institution_entities.id_rssd = branch_lifetimes.id_rssd_parent WHERE  branch_lifetime >= 40 ORDER BY branch_lifetime desc limit 10;"
"Since 2020, how many new branches have banks opened by state and by bank type?","with new_branches as (SELECT state_abbreviation,                              category,                              count(*) as new_branch_count                       FROM   financial_data_package.cybersyn.financial_branch_entities                       WHERE  start_date >= '2020-01-01'                       GROUP BY state_abbreviation, category) SELECT state_abbreviation,        category,        new_branch_count FROM   new_branches ORDER BY state_abbreviation, category, new_branch_count desc;"
What is the 3 month running average of each states' mean monthly not seasonally adjusted unemployment rates between 2007 to 2022?,"with monthly_unemployment_rates as (SELECT g.geo_name,                                            b.date,                                            avg(b.value) as avg_unemployment_rate                                     FROM   financial_data_package.cybersyn.bureau_of_labor_statistics_employment_timeseries as b join financial_data_package.cybersyn.geography_index as g                                             ON b.geo_id = g.geo_id                                     WHERE  b.variable_name like '%Unemployment Rate%Not seasonally adjusted%'                                        and b.date between '2007-01-01'                                        and '2022-12-31'                                        and g.level = 'State'                                     GROUP BY g.geo_name, b.date) SELECT geo_name AS STATE,        date,        100*avg(avg_unemployment_rate) OVER (PARTITION BY geo_name                                         ORDER BY date rows between 1 preceding and 1 following) as UNEMPLOYMENT_RATE FROM   monthly_unemployment_rates ORDER BY STATE, date;"
"Since 2020, how many new branches have banks opened by state?","with new_branches as (SELECT state_abbreviation,                              count(*) as new_branch_count                       FROM   financial_data_package.cybersyn.financial_branch_entities                       WHERE  start_date >= '2020-01-01'                       GROUP BY state_abbreviation) SELECT state_abbreviation,        new_branch_count FROM   new_branches ORDER BY new_branch_count desc;"
"Using the BLS Price time series, calculate the monthly inflation percentage of airline fares using the consumer price index of airline fares ","with airline_cpi as (SELECT date_trunc('month', date) as month,                             value as cpi                      FROM   financial_data_package.CYBERSYN.BUREAU_OF_LABOR_STATISTICS_PRICE_TIMESERIES                      WHERE  variable_name ilike 'cpi%airline fares%'),  monthly_inflation as ( SELECT month,        (cpi - lag(cpi) OVER (ORDER BY month)) / lag(cpi) OVER (ORDER BY month) * 100 as inflation_percentage FROM   airline_cpi) SELECT month,        inflation_percentage FROM   monthly_inflation WHERE  inflation_percentage is not null ORDER BY month;"
Compare the seasonally adjusted Consumer Price Index for all Urban Consumers to the Federal Funds Effective Rate  ,"SELECT b.date,        a.value as cpi,        b.value as federal_funds_rate FROM   financial_data_package.cybersyn.financial_fred_timeseries a join financial_data_package.cybersyn.financial_fred_timeseries b         ON a.date = b.date WHERE  a.variable like '%Consumer Price Index%Urban Consumers%Seasonally adjusted%'    and b.variable = 'Federal Funds Effective Rate' ORDER BY b.date;"
Create a cumulative frequency distribution of the number of complaints received by CFPB against the financial institution with the most number of complaints in 2022 on a weekly basis,"with fiwmc_2022_complaints as (SELECT count(*) as n_complaints                                FROM   financial_data_package.cybersyn.financial_cfpb_complaint                                WHERE  company = (SELECT company                                                  FROM   financial_data_package.cybersyn.financial_cfpb_complaint                                                  WHERE  date_received between '2022-01-01'                                                     and '2022-12-31'                                                  GROUP BY company                                                  ORDER BY count(*) desc limit 1) and date_received between '2022-01-01' and '2022-12-31') SELECT date_trunc('week', date_received) as week,        count(*) as frequency,        sum(count(*)) OVER (ORDER BY week asc) as cumulative_frequency FROM   financial_data_package.cybersyn.financial_cfpb_complaint WHERE  company = (SELECT company                   FROM   financial_data_package.cybersyn.financial_cfpb_complaint                   WHERE  date_received between '2022-01-01'                      and '2022-12-31'                   GROUP BY company                   ORDER BY count(*) desc limit 1) and date_received between '2022-01-01' and '2022-12-31' GROUP BY week ORDER BY week asc"
What are the names of the top 3 customers with the highest total sales?,"SELECT c.c_name AS customer_name, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON l.l_orderkey = o.o_orderkey JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c ON o.o_custkey = c.c_custkey GROUP BY customer_name ORDER BY total_sales DESC LIMIT 3"
What are the total sales by country for the top 10 countries in descending order?,"SELECT   n.n_name AS country_name,   SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales FROM   SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c ON n.n_nationkey = c.c_nationkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON c.c_custkey = o.o_custkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l ON o.o_orderkey = l.l_orderkey GROUP BY   country_name ORDER BY   total_sales DESC LIMIT 10;"
Calculate the monthly inflation rate as a percentage from the consumer price index for urban consumers,"with cpi_data as (SELECT date,                          value,                          lag(value) OVER (ORDER BY date) as prev_value                   FROM   financial_data_package.cybersyn.financial_fred_timeseries                   WHERE  variable_name ilike '%Consumer Price Index%Urban Consumers%') SELECT date,        value as cpi,        (value - prev_value) / prev_value * 100 as monthly_inflation_rate_pct FROM   cpi_data WHERE  prev_value is not null ORDER BY date;"
What is the average discount for each region?,"SELECT   r.r_name AS region_name,   AVG(l.l_discount) AS avg_discount FROM   SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON l.l_orderkey = o.o_orderkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c ON o.o_custkey = c.c_custkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n ON c.c_nationkey = n.n_nationkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.REGION r ON n.n_regionkey = r.r_regionkey GROUP BY   region_name;"
Calculate the annualized monthly inflation rate as a percentage since 1980 based on the consumer price index for urban consumers,"with cpi_data as (SELECT date,                          value,                          lag(value) OVER (ORDER BY date) as prev_value                   FROM   financial_data_package.cybersyn.financial_fred_timeseries                   WHERE  variable_name ilike '%Consumer Price Index%Urban Consumers%'                      and date >= '1980-01-01'), subquery as (SELECT date,                                                value,                                                lag(value) OVER (ORDER BY date) as prev_value,                                                lag(date) OVER (ORDER BY date) as prev_date                                         FROM   cpi_data) SELECT date,        (power((value / prev_value), 1.0/12) - 1) * 100 as annualized_inflation_rate FROM   subquery WHERE  prev_value is not null ORDER BY date;"
What is the running total of CPFB complaints of each product in 2022?,"SELECT product,        date_received,        count(*) OVER (PARTITION BY product                       ORDER BY date_received) as running_total FROM   financial_data_package.cybersyn.financial_cfpb_complaint WHERE  date_received >= '2022-01-01'    and date_received < '2023-01-01' ORDER BY product, date_received"
"Since 2021, which cities have seen an increase in branches and by which banks?","WITH pre_2021_branches AS (     SELECT id_rssd_parent,            city,            COUNT(*) AS pre_2021_count     FROM financial_data_package.cybersyn.financial_branch_entities     WHERE start_date < '2021-01-01'       AND (end_date >= '2021-01-01' OR end_date IS NULL)     GROUP BY id_rssd_parent, city ), post_2021_branches AS (     SELECT id_rssd_parent,            city,            COUNT(*) AS post_2021_count     FROM financial_data_package.cybersyn.financial_branch_entities     WHERE start_date >= '2021-01-01'     GROUP BY id_rssd_parent, city ) SELECT post_2021_branches.city,        bank_names.name,        post_2021_count - pre_2021_count AS branch_change FROM post_2021_branches INNER JOIN financial_data_package.cybersyn.financial_institution_entities AS bank_names ON (post_2021_branches.id_rssd_parent = bank_names.id_rssd) LEFT JOIN pre_2021_branches ON (post_2021_branches.id_rssd_parent = pre_2021_branches.id_rssd_parent AND post_2021_branches.city = pre_2021_branches.city) WHERE post_2021_count > pre_2021_count ORDER BY branch_change DESC;"
"Which 5 countries saw the most %increase in fertility between 2012 and 2020 ? where life expectancy is not null in 2012 ,","SELECT geo.geo_name,        ((ts2.value - ts.value) / ts.value) * 100 as increase_percentage FROM   (SELECT geo_id,                date,                value         FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries         WHERE  variable_name = 'Fertility Rate, worldbank.org'            and date = '2012-01-01') as ts join (SELECT geo_id,                                             date,                                             value                                      FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries                                      WHERE  variable_name = 'Fertility Rate, worldbank.org'                                         and date = '2020-01-01') as ts2         ON ts.geo_id = ts2.geo_id join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  geo.level = 'Country'    and ts.value is not null ORDER BY increase_percentage desc limit 5;"
Which 5 countries has the maximum Annual Electricity Consumption in 2019 ?,"SELECT gi.geo_name,        dcts.value as annual_electricity_consumption FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as dcts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as gi         ON dcts.geo_id = gi.geo_id WHERE  dcts.variable_name = 'Annual Electricity Consumption'    and gi.level = 'Country'    and dcts.date between '2019-01-01'    and '2019-12-31' ORDER BY dcts.value desc limit 5"
which country has the most population in 2018 ?,"SELECT geo.geo_name,        ts.value as total_population FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Total Population, census.gov'    and geo.level = 'Country'    and ts.date = '2018-01-01' ORDER BY ts.value desc limit 1;"
Which country has lowest but greater than 0 cumulative rainfall ?,"SELECT geo.geo_name,        sum(ts.value) as cumulative_rainfall FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Mean Rainfall'    and geo.level = 'Country'    and ts.date between '2019-01-01'    and '2019-12-31' GROUP BY geo.geo_name having sum(ts.value) > 0 ORDER BY cumulative_rainfall asc limit 1"
"What are different geo names and related geo names, for countries","SELECT geo_name,        related_geo_name FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.geography_relationships WHERE  level = 'Country' ORDER BY geo_name, related_geo_name"
what are the public holidays in united states in 2023. make sure the dates are unique. order by the date.,"SELECT DISTINCT holiday_name,                 date FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar WHERE  geo_id = 'country/USA'    and date between '2023-01-01'    and '2023-12-31' ORDER BY date asc"
Which 5 countries have the lowest rainfall in 2023?,"SELECT geo.geo_name,        sum(ts.value) as cumulative_rainfall FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Mean Rainfall'    and geo.level = 'Country'    and ts.date between '2023-01-01'    and '2023-12-31' GROUP BY geo.geo_name ORDER BY cumulative_rainfall asc limit 5"
List all the public holidays in the United States in 2023. Show all columns,SELECT * FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar WHERE  geo_id = 'country/USA'    and date between '2023-01-01'    and '2023-12-31'
what is the average rainfall in each country in 2023 ?,"SELECT geo.geo_name,        avg(ts.value) as average_rainfall FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Rainfall'    and geo.level = 'Country'    and ts.date = '2023-01-01' GROUP BY geo.geo_name ORDER BY average_rainfall desc"
what are the top 10 countries by the most public holidays in 2023?,"SELECT geo.geo_name,        count(distinct holiday_name) as num_holidays FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar as cal join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON cal.geo_id = geo.geo_id WHERE  geo.level = 'Country'    and cal.date between '2023-01-01'    and '2023-12-31' GROUP BY geo.geo_name ORDER BY num_holidays desc limit 10"
What are different countries we have information about ?,SELECT DISTINCT iso_name FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index WHERE  level = 'Country' ORDER BY iso_name;
Which country has had the maximum growth of Mean Temperature from 2010 to 2020?,"The corrected SQL code would be:  ``` SELECT geo.geo_name,        ((ts2.value - ts.value) / ts.value) * 100 as growth_percentage FROM   (SELECT geo_id as geo_id1,                date,                MAX(value) as value          FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries ts          join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id         and geo.level = 'Country'         WHERE  variable_name = 'Mean Temperature'            and date = '2010-01-01'        ) as ts       join (SELECT geo_id as geo_id2,                  date,                  MAX(value) as value            FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries ts            join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo           ON ts.geo_id = geo.geo_id           and geo.level = 'Country'           WHERE  variable_name = 'Mean Temperature'           and date = '2020-01-01'        ) as ts2         ON ts.geo_id1 = ts2.geo_id2      join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id1 = geo.geo_id WHERE  geo.level = 'Country' ORDER BY growth_percentage desc limit 1  ```   I added the table alias 'geo' to the SELECT statement in order to specify which table the column 'GEO_ID' should be selected from.     The error was 002028 (42601): SQL compilation error: ambiguous column name 'GEO_ID'"
Which country has lowest but greater than 0 cumulative rainfall in 2023?,"SELECT geo.geo_name,        sum(ts.value) as cumulative_rainfall FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Mean Rainfall'    and geo.level = 'Country'    and ts.date between '2023-01-01'    and '2023-12-31' GROUP BY geo.geo_name having sum(ts.value) > 0 ORDER BY cumulative_rainfall asc limit 1"
What is the overall percentage population growth of california and US  from 2010 to 2018 ? Take max of population for each year to clean the data ,"The corrected SQL code is:  ``` SELECT geo.geo_name,        ((ts2.value - ts.value) / ts.value) * 100 as growth_percentage FROM   (SELECT                 datacommons_timeseries.geo_id,                max(value) as value         FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries   join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON datacommons_timeseries.geo_id = geo.geo_id         WHERE  variable_name = 'Total Population, census.gov'            and date = '2010-01-01'            and (geo.geo_name = 'California'            and geo.level = 'State')            or (geo.geo_name = 'United States'            and geo.level = 'Country')         GROUP BY datacommons_timeseries.geo_id) as ts  join (SELECT                datacommons_timeseries.geo_id,                max(value) as value         FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries   join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON datacommons_timeseries.geo_id = geo.geo_id         WHERE  variable_name = 'Total Population, census.gov'         and date = '2018-01-01'         and (geo.geo_name = 'California'         and geo.level = 'State')          or (geo.geo_name = 'United States'         and geo.level = 'Country')          GROUP BY datacommons_timeseries.geo_id) as ts2      ON ts.geo_id = ts2.geo_id         join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id ORDER BY geo.geo_name ```"
Which 5 countries has the maximum Annual Electricity Consumption in 2015 ?,"SELECT gi.geo_name,        dcts.value as annual_electricity_consumption FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as dcts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as gi         ON dcts.geo_id = gi.geo_id WHERE  dcts.variable_name = 'Annual Electricity Consumption'    and gi.level = 'Country'    and dcts.date between '2015-01-01'    and '2015-12-31' ORDER BY dcts.value desc limit 5"
What are the first 10 rows in the GEOGRAPHY_RELATIONSHIPS table?,"SELECT GEO_NAME, GEO_ID, LEVEL, RELATED_GEO_NAME, RELATED_GEO_ID, RELATED_LEVEL, RELATIONSHIP_TYPE FROM CYBERSYN_US__GLOBAL_PUBLIC_DATA_STARTER_KIT.CYBERSYN.GEOGRAPHY_RELATIONSHIPS LIMIT 10"
What are the first 10 rows in the PUBLIC_HOLIDAY_CALENDAR table?,"SELECT GEO_ID, ISO_ALPHA2, DATE, HOLIDAY_NAME, SUBDIVISION, IS_FINANCIAL FROM CYBERSYN_US__GLOBAL_PUBLIC_DATA_STARTER_KIT.CYBERSYN.PUBLIC_HOLIDAY_CALENDAR LIMIT 10"
show Unemployment Rates in New York City vs. New York state,"SELECT ts.date,        geo.geo_name,        geo.level,        ts.value FROM CYBERSYN_US__GLOBAL_PUBLIC_DATA_STARTER_KIT.cybersyn.datacommons_timeseries AS ts JOIN CYBERSYN_US__GLOBAL_PUBLIC_DATA_STARTER_KIT.cybersyn.geography_index AS geo ON (ts.geo_id = geo.geo_id) WHERE geo.geo_name = 'New York'   AND geo.level IN ('State', 'City')   AND ts.variable_name ILIKE 'Unemployment Rate%'   AND date >= '2015-01-01' ORDER BY date"
On which day did Sierra Leone receive maximum rainfall along with the unit? ,"The corrected SQL query is:  ``` SELECT date,        value,        datacommons_timeseries.unit FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries  JOIN   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_attributes        ON datacommons_timeseries.variable_name = datacommons_attributes.variable_name WHERE  geo_id = 'country/SLE'        AND datacommons_timeseries.variable_name = 'Mean Rainfall' ORDER BY value DESC  LIMIT 1; ```  The error occurred because the column name `variable_name` was ambiguous in the query. I specified which table the column `variable_name` should be selected from to return a valid SQL code."
Compare Median Income to Median Age by Zipcode,"SELECT t1.geo_name,        t1.geo_id,        x as Median_Income,        y as Median_Age FROM   (WITH x_cte AS      (SELECT geo_name,              ts.geo_id,              value AS x,              ROW_NUMBER() OVER (PARTITION BY ts.geo_id                                 ORDER BY date DESC) AS rn       FROM CYBERSYN_US__GLOBAL_PUBLIC_DATA_STARTER_KIT.cybersyn.datacommons_timeseries AS ts       JOIN CYBERSYN_US__GLOBAL_PUBLIC_DATA_STARTER_KIT.cybersyn.geography_index AS geo ON (ts.geo_id = geo.geo_id)       WHERE level = 'CensusZipCodeTabulationArea'         AND variable_name = 'Median Income for All Households') SELECT geo_name,                                                     geo_id,                                                     x    FROM x_cte    WHERE rn=1) t1 JOIN   (WITH y_cte AS      (SELECT geo_name,              ts.geo_id,              value AS y,              ROW_NUMBER() OVER (PARTITION BY ts.geo_id                                 ORDER BY date DESC) AS rn       FROM CYBERSYN_US__GLOBAL_PUBLIC_DATA_STARTER_KIT.cybersyn.datacommons_timeseries AS ts       JOIN CYBERSYN_US__GLOBAL_PUBLIC_DATA_STARTER_KIT.cybersyn.geography_index AS geo ON (ts.geo_id = geo.geo_id)       WHERE level = 'CensusZipCodeTabulationArea'         AND variable_name = 'Median Age of Population') SELECT geo_id,                                                  y    FROM y_cte    WHERE rn = 1) t2 ON t1.GEO_ID = t2.GEO_ID ORDER BY t1.geo_name"
Which 5 countries have the highest Fertility Rate?,"SELECT geo.geo_name,        avg(ts.value) as avg_fertility_rate FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Fertility Rate, worldbank.org'    and geo.level = 'Country' GROUP BY geo.geo_name ORDER BY avg_fertility_rate desc limit 5"
How many different variable are there in the arrtibutes ?,SELECT count(distinct variable_name) as num_variables FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_attributes
what are the public holidays in united states in 2023. make sure the dates are unique,"SELECT DISTINCT holiday_name,                 date FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar WHERE  geo_id = 'country/USA'    and date between '2023-01-01'    and '2023-12-31'"
Which country  saw the highest population variable name growth % from 2010 to 2020 ? ,"SELECT geo.geo_name,        ((ts2.value - ts.value) / ts.value) * 100 as growth_percentage FROM   (SELECT geo_id,                date,                value         FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries         WHERE  variable_name = 'Total Population, census.gov'            and date = '2010-01-01') as ts join (SELECT geo_id,                                             date,                                             value                                      FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries                                      WHERE  variable_name = 'Total Population, census.gov'                                         and date = '2020-01-01') as ts2         ON ts.geo_id = ts2.geo_id join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  geo.level = 'Country' ORDER BY growth_percentage desc limit 1"
what is the most populous state in the United States in year 2018 ? ,"SELECT geo.geo_name,        ts.value as total_population FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Total Population, census.gov'    and geo.level = 'State'    and ts.date = '2018-01-01' ORDER BY ts.value desc limit 1;"
Which country AQI is highest in 2005 ?,"SELECT geo.geo_name,        ts.value FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON (ts.geo_id = geo.geo_id) WHERE  variable_name = 'Air Quality Index, EPA'    and level = 'Country'    and date = '2005-01-01' ORDER BY value desc limit 1"
Which country has had the maximum growth of Mean Temperature from 2010 to 2020? ,"SELECT geo.geo_name,        ((ts2.value - ts.value) / ts.value) * 100 as growth_percentage FROM   (SELECT geo_id,                date,                value         FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries         WHERE  variable_name = 'Mean Temperature'            and date = '2010-01-01') as ts join (SELECT geo_id,                                             date,                                             value                                      FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries                                      WHERE  variable_name = 'Mean Temperature'                                         and date = '2020-01-01') as ts2         ON ts.geo_id = ts2.geo_id join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  geo.level = 'Country' ORDER BY growth_percentage desc limit 1"
"Which 5 countries saw the most %decline in life expectation between 2012 and 2020 ? where life expectancy is not null in 2012 , load a bar chart ","SELECT geo.geo_name,        ((ts2.value - ts.value) / ts.value) * 100 as decline_percentage FROM   (SELECT geo_id,                date,                value         FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries         WHERE  variable_name = 'Life Expectancy, worldbank.org'            and date = '2012-01-01'            and value is not null) as ts join (SELECT geo_id,                                           date,                                           value                                    FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries                                    WHERE  variable_name = 'Life Expectancy, worldbank.org'                                       and date = '2020-01-01'                                       and value is not null) as ts2         ON ts.geo_id = ts2.geo_id join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  geo.level = 'Country' ORDER BY decline_percentage desc limit 5;"
What are the first 10 rows in the DATACOMMONS_ATTRIBUTES table?,"SELECT VARIABLE, VARIABLE_NAME, VARIABLE_GROUP, CATEGORY, UNIT FROM CYBERSYN_US__GLOBAL_PUBLIC_DATA_STARTER_KIT.CYBERSYN.DATACOMMONS_ATTRIBUTES LIMIT 10"
"Which 5 countries saw the most %increase in nominal gdp bewtween 2012 and 2020 ? where life expectancy is not null in 2012 , load a bar chart ","SELECT geo.geo_name,        ((ts2.value - ts.value) / ts.value) * 100 as increase_percentage FROM   (SELECT geo_id,                date,                value         FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries         WHERE  variable_name = 'Nominal GDP'            and date = '2012-01-01') as ts join (SELECT geo_id,                                             date,                                             value                                      FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries                                      WHERE  variable_name = 'Nominal GDP'                                         and date = '2020-01-01') as ts2         ON ts.geo_id = ts2.geo_id join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  geo.level = 'Country'    and ts.date = '2012-01-01' ORDER BY increase_percentage desc limit 5;"
What are different geo names and related geo names?,"SELECT geo_name,        related_geo_name FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.geography_relationships limit 10;"
Which country has the maximum mean snowfall in 2010 ? ,"SELECT geo.geo_name,        ts.value as mean_snowfall FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Mean Snowfall'    and geo.level = 'Country'    and ts.date between '2010-01-01'    and '2010-12-31' ORDER BY mean_snowfall desc limit 1"
which country has the maximum growth of public holidays from 2000 to 2023 in absolute?,"SELECT geo.geo_name,        count(distinct cal.holiday_name) as num_holidays,        count(distinct cal.holiday_name) - count(distinct cal2.holiday_name) as growth FROM   (SELECT *          FROM cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar          WHERE date >= '2023-01-01'         and date < '2024-01-01'        )         as cal  join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON cal.geo_id = geo.geo_id  join (         SELECT *          FROM cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar          WHERE date >= '2000-01-01'         and date < '2001-01-01'       ) as cal2          ON cal.geo_id = cal2.geo_id  WHERE  geo.level = 'Country' GROUP BY geo.geo_name ORDER BY growth desc limit 1       "
What different categories for the Life Expectancy variable  ?,"SELECT DISTINCT category, variable_name FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_attributes WHERE  variable_name ilike '%expectancy%';"
Which country AQI is highest ?,"SELECT geo.geo_name,        date,        sum(value) as AQI FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON (ts.geo_id = geo.geo_id) WHERE  variable_name ilike '%Air%' GROUP BY geo.geo_name, date ORDER BY AQI desc limit 1"
..,"SELECT geo.geo_name,        ts.date,        ts.value FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Total Population, census.gov'    and (geo.geo_id = 'country/USA'     or geo.geo_name = 'California')    and ts.date =  '2010-01-01' ORDER BY geo.geo_name, ts.date "
List all the public holidays in the United States,"SELECT holiday_name,        date FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar WHERE  geo_id = 'country/USA'"
What is the unit of variable windspeed ? ,"SELECT DISTINCT unit FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_attributes WHERE  variable_name = 'Mean Wind Speed'"
On which day did Sierra Leone receive maximum rainfall ? ,"SELECT date,        value FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries WHERE  variable_name = 'Mean Rainfall'    and geo_id = 'country/SLE' ORDER BY value desc limit 1"
What is the year on year population growth  of males between 2010 and 2018 ?,"The corrected query is:  ``` SELECT ts.date,        CASE WHEN lag(ts.value) OVER (ORDER BY ts.date) = 0 THEN NULL ELSE         ((ts.value - lag(ts.value) OVER (ORDER BY ts.date)) / lag(ts.value) OVER (ORDER BY ts.date)) * 100 END as growth_percentage FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries ts WHERE  ts.variable_name = 'Male Population, census.gov' ```   This query uses a `CASE` statement to check if the denominator is zero. If it is, the growth percentage is set to `NULL`. Otherwise, the growth percentage is calculated normally."
What are different geo levels we have information about ?,SELECT DISTINCT level FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index
 What are the 10 countries with highest government debt in 2008 ? ,"SELECT geo.geo_name,        value as government_debt FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON (ts.geo_id = geo.geo_id) WHERE  variable_name = 'Total Gross Government Debt, Percent of GDP'    and date = '2008-01-01'    and level = 'Country' ORDER BY government_debt desc limit 10"
Which country  saw the snowfall variable name  growth % from 2010 to 2018 ? ,"SELECT geo.geo_name,        ((ts2.value - ts.value) / ts.value) * 100 as growth_percentage FROM   (SELECT geo_id,                date,                value         FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries         WHERE  variable_name = 'Snowfall'            and date = '2010-01-01') as ts join (SELECT geo_id,                                             date,                                             value                                      FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries                                      WHERE  variable_name = 'Snowfall'                                         and date = '2018-01-01') as ts2         ON ts.geo_id = ts2.geo_id join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  geo.level = 'Country' ORDER BY growth_percentage desc limit 1"
Which country geoname saw the highest population variable name growth % from 2010 to 2020 ? ,"Here is the corrected SQL query:  ``` SELECT geo.geo_name,        ((ts2.value - ts.value) / ts.value) * 100 as growth_percentage FROM   (SELECT geo_id,                date,                value         FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries         WHERE  variable_name = 'Total Population, census.gov'                and date = '2010-01-01'         ) as ts  JOIN (SELECT geo_id,                date,                value       FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries       WHERE  variable_name = 'Total Population, census.gov'              and date = '2020-01-01'        ) as ts2          on ts.geo_id = ts2.geo_id  join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo        ON ts.geo_id = geo.geo_id WHERE  geo.level = 'Country' ORDER BY growth_percentage desc limit 1  ```"
What are some financial holidays ? ,"SELECT DISTINCT holiday_name FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar WHERE  is_financial = true"
Which 5 countries have the least Life Expectancy ,"SELECT geo.geo_name,        geo.level,        da.variable_name,        da.value as life_expectancy FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as da join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON da.geo_id = geo.geo_id WHERE  da.variable_name ilike '%Life expectancy%'    and geo.level = 'Country' ORDER BY da.value asc limit 5"
Which state has the highest population in the United States in 2018 ?,"SELECT geo.geo_name,        ts.value as total_population FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts  join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_relationships as geo2 ON geo.geo_name = geo2.related_geo_name WHERE  ts.variable_name = 'Total Population, census.gov'    and geo.level = 'State'    and ts.date = '2018-01-01'    and geo2.geo_name = 'United States' ORDER BY ts.value desc limit 1;"
"Fetch population for US, Canada, Mexico since 2000, along with human readable names","-- The timeseries table contains the core data. The geo_index table contains human readable names for geographies. Note the variable name, in this case, can be found in the measures table. SELECT att.variable_name,        geo.geo_name,        geo.geo_id,        date,        value FROM CYBERSYN_US__GLOBAL_PUBLIC_DATA_STARTER_KIT.cybersyn.datacommons_timeseries AS ts JOIN CYBERSYN_US__GLOBAL_PUBLIC_DATA_STARTER_KIT.cybersyn.datacommons_attributes AS att ON (ts.variable = att.variable) JOIN CYBERSYN_US__GLOBAL_PUBLIC_DATA_STARTER_KIT.cybersyn.geography_index AS geo ON (ts.geo_id = geo.geo_id) WHERE att.variable_group ='Total Population'   AND geo.geo_id IN ('country/USA', 'country/CAN', 'country/MEX')   AND date >= '2000-01-01' ORDER BY date DESC"
Which country has the most public holidays in the year 2023 ?,"SELECT geo.geo_name,        count(distinct holiday_name) as num_holidays FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar as cal join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON cal.geo_id = geo.geo_id WHERE  geo.level = 'Country'    and cal.date between '2023-01-01'    and '2023-12-31' GROUP BY geo.geo_name ORDER BY num_holidays desc limit 1"
Which country has the highest count of housing units in the year 2005 ?,"I'm sorry, but without the original SQL code provided in the query, I cannot correct the SQL query. Please provide the original SQL code along with the error message so that I can assist you better.   The error message indicates a syntax error with an unexpected 'I' at the beginning of the SQL code. Additionally, there is a parse error near the end of the code at position 198. Please provide the original SQL code for me to assist you better."
Which country has the highest count of housing units in the year 2020 ?,"SELECT geo.geo_name,        sum(value) as total_housing_units FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON (ts.geo_id = geo.geo_id) WHERE  variable_name = 'Housing Units'    and level = 'Country'    and date = '2020-01-01' GROUP BY geo.geo_name ORDER BY total_housing_units desc limit 1"
What is the different variables  related to the housing sector ? ,"SELECT DISTINCT variable_name FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_attributes WHERE  variable_group ilike '%Housing%'"
What is the overall percentage population growth of california and US  from 2010 to 2018 ?,"SELECT geo.geo_name,        ((ts.value - ts2.value) / ts2.value) * 100 as growth_percentage FROM   (SELECT geo_id,                date,                value         FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries         WHERE  variable_name = 'Total Population, census.gov'            and date = '2010-01-01') as ts join (SELECT geo_id,                                             date,                                             value                                      FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries                                      WHERE  variable_name = 'Total Population, census.gov'                                         and date = '2018-01-01') as ts2         ON ts.geo_id = ts2.geo_id join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  (geo.geo_name = 'California'    and geo.level = 'State')     or (geo.geo_name = 'United States'    and geo.level = 'Country') ORDER BY geo.geo_name"
What are different variable names ?,SELECT DISTINCT variable_name FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_attributes
]Which countries showed the most  decline in life expectancy ?,"SELECT geo_name,        max(case when date = '2020-01-01' then value                 else null end) - max(case when date = '2012-01-01' then value                 else null end) as decline FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index         ON datacommons_timeseries.geo_id = geography_index.geo_id WHERE  variable_name = 'Life Expectancy, worldbank.org'    and date in ('2012-01-01', '2020-01-01')    and geo_name != 'World'    and level = 'Country' GROUP BY geo_name ORDER BY decline desc limit 5;"
what percentage of the US population was living in California in 2018?,"  with base as  (SELECT MAX(ts.value) as val1  FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts  join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Total Population, census.gov'    and geo.geo_name = 'California'    and geo.level = 'State'    and ts.date = '2018-01-01' )  , b2 as  (SELECT MAX(ts.value) as val2  FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts  join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Total Population, census.gov'    and geo.geo_name = 'United States'    and geo.level = 'Country'    and ts.date = '2018-01-01' )  SELECT (val1/val2 )*100 FROM base, b2  "
What is the growth in Total Population of USA year on year in %?,"SELECT date,        value FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts WHERE  variable_name = 'Total Population, census.gov'    and geo_id = 'country/USA' ORDER BY date asc"
What's the annual electricity consumption of the United States and China?,"SELECT geo.geo_name, ts.date,        ts.value FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  variable_name = 'Annual Electricity Consumption'    and geo.geo_name in ('United States', 'China') ORDER BY geo.geo_name"
what are the public holidays in united states in 2023,"SELECT holiday_name,        date FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar WHERE  geo_id = 'country/USA'    and date between '2023-01-01'    and '2023-12-31'"
What is the population growth of US Country And California State year or year from 2010 to 2018 ? ,"SELECT geo.geo_name,        ts.date,        ts.value,        ((ts.value - lag(ts.value) OVER(PARTITION BY geo.geo_name                                        ORDER BY ts.date)) / lag(ts.value) OVER(PARTITION BY geo.geo_name ORDER BY ts.date)) * 100 as growth_percentage FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Total Population, census.gov'    and (geo.geo_id = 'country/USA'     or geo.geo_name = 'California')    and ts.date between '2010-01-01'    and '2018-01-01' ORDER BY geo.geo_name, ts.date"
Find all counties and zip codes in New York,"SELECT related_geo_id,        related_geo_name,        related_level FROM CYBERSYN_US__GLOBAL_PUBLIC_DATA_STARTER_KIT.cybersyn.geography_relationships WHERE geo_name = 'New York'   AND level = 'State'   AND related_level IN ('County', 'CensusZipCodeTabulationArea') ORDER BY related_geo_name"
Which 5 countries have the most public holidays in 2023 ?,"SELECT geo.geo_name,        count(distinct date) as num_holidays FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar as cal join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON cal.geo_id = geo.geo_id WHERE  geo.level = 'Country'    and cal.date between '2023-01-01'    and '2023-12-31' GROUP BY geo.geo_name ORDER BY num_holidays desc limit 5"
Which 5 countries saw the most %decline in life expectation between 2012 and 2020 ? where life expectancy is not null in 2012 ,"SELECT geo.geo_name,        ((ts2.value - ts.value) / ts.value) * 100 as decline_percentage FROM   (SELECT geo_id,                date,                value         FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries         WHERE  variable_name = 'Life Expectancy, worldbank.org'            and date = '2012-01-01'            and value is not null) as ts join (SELECT geo_id,                                           date,                                           value                                    FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries                                    WHERE  variable_name = 'Life Expectancy, worldbank.org'                                       and date = '2020-01-01'                                       and value is not null) as ts2         ON ts.geo_id = ts2.geo_id join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  geo.level = 'Country' ORDER BY decline_percentage desc limit 5;"
What state had the highest population in the united states in the year 2018 ?,"SELECT geo2.*  FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts  join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id  join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_relationships as geo2         ON geo.geo_id = geo2.related_geo_id WHERE  ts.variable_name = 'Total Population, census.gov'    and geo.level = 'State' and geo.geo_name = 'California' "
how many public holidays does india have in the year 2023?,SELECT count(distinct holiday_name) as num_holidays FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar WHERE  geo_id in (SELECT geo_id                   FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index                   WHERE  geo_name = 'India')    and date between '2023-01-01'    and '2023-12-31'
which country has highest cumulative rainfall in 2023 ?,"SELECT geo.geo_name,        sum(ts.value) as cumulative_rainfall FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Mean Rainfall'    and geo.level = 'Country'    and ts.date between '2023-01-01'    and '2023-12-31' GROUP BY geo.geo_name ORDER BY cumulative_rainfall desc limit 1"
Which 5 countries have the highest Fertility Rate from  year 2020 to date?,"SELECT geo.geo_name,        avg(ts.value) as avg_fertility_rate FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Fertility Rate, worldbank.org'    and geo.level = 'Country'    and ts.date >= '2020-01-01' GROUP BY geo.geo_name ORDER BY avg_fertility_rate desc limit 5"
Which 5 countries have the least Life Expectancy in year 2018 ?,"SELECT geo.geo_name,        ts.value as life_expectancy FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Life Expectancy, worldbank.org'    and geo.level = 'Country'    and ts.date = '2018-01-01' ORDER BY ts.value asc limit 5"
what is the cumulative rainfall in each country in 2023 ?,"SELECT geo.geo_name,        sum(ts.value) as cumulative_rainfall FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Mean Rainfall'    and geo.level = 'Country'    and ts.date between '2023-01-01'    and '2023-12-31' GROUP BY geo.geo_name"
What is the percentage population growth of california and US  from 2010 to 2018 ?,"SELECT geo.geo_name,        ((ts.value - lag(ts.value) OVER (PARTITION BY geo.geo_name                                         ORDER BY ts.date)) / lag(ts.value) OVER (PARTITION BY geo.geo_name ORDER BY ts.date)) * 100 as growth_percentage FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Total Population, census.gov'    and geo.level = 'State'    and geo.geo_name = 'California'    and ts.date between '2010-01-01'    and '2018-01-01'     or (geo.level = 'Country'    and geo.geo_name = 'United States'    and ts.variable_name = 'Total Population, census.gov'    and ts.date between '2010-01-01'    and '2018-01-01') ORDER BY geo.geo_name, ts.date;"
What is the year on year population growth  of males between 2010 and 2018 in California ?,"SELECT ts.date,        ((ts.value - lag(ts.value) OVER (ORDER BY ts.date)) / lag(ts.value) OVER (ORDER BY ts.date)) * 100 as growth_percentage FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Male Population, census.gov'    and geo.geo_name = 'California'    and ts.date between '2010-01-01'    and '2018-01-01'"
Which 5 countries have the highest Obesity Rate?,"SELECT geo.geo_name,        ts.value as obesity_rate FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Obesity, adult prevalence rate (%)'    and geo.level = 'Country' ORDER BY ts.value desc limit 5"
Which year has the highest population for the US ? ,"SELECT date,        value FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts WHERE  variable_name = 'Total Population, census.gov'    and geo_id = 'country/USA' ORDER BY value desc limit 1"
what are the public holidays in india have in the year 2023 ?,"SELECT holiday_name,        date FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar WHERE  geo_id in (SELECT geo_id                   FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index                   WHERE  geo_name = 'India')    and date between '2023-01-01'    and '2023-12-31'"
Which 5 countries has the maximum Annual Electricity Consumption in 2020 ?,"SELECT geo.geo_name,        ts.value as annual_electricity_consumption FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  variable_name = 'Annual Electricity Consumption'    and geo.level = 'Country'    and ts.date between '2020-01-01'    and '2020-12-31' ORDER BY annual_electricity_consumption desc limit 5;"
Which 5 countries have the highest Fertility Rate in all years ?,"SELECT geo.geo_name,        avg(ts.value) as avg_fertility_rate FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Fertility Rate, worldbank.org'    and geo.level = 'Country' GROUP BY geo.geo_name ORDER BY avg_fertility_rate desc limit 5"
Which 5 countries have the lowes rainfall in 2023 ?,"SELECT geo.geo_name,        sum(ts.value) as cumulative_rainfall FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Mean Rainfall'    and geo.level = 'Country'    and ts.date between '2023-01-01'    and '2023-12-31' GROUP BY geo.geo_name ORDER BY cumulative_rainfall desc limit 5"
"What the public holdiays in India in 2023, also display if they are a financial holiday or not","SELECT holiday_name,        date,        is_financial FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar WHERE  geo_id = 'country/IND'    and date between '2023-01-01'    and '2023-12-31'"
How many geographies are there?,SELECT count(distinct geo_id) as num_geographies FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index
Which country  saw the snowfall growth % from 2010 to 2018 ? ,"SELECT geo.geo_name,        ((ts2.value - ts.value) / ts.value) * 100 as growth_percentage FROM   (SELECT geo_id,                date,                value         FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries         WHERE  variable_name = 'Snowfall'            and date = '2010-01-01') as ts join (SELECT geo_id,                                             date,                                             value                                      FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries                                      WHERE  variable_name = 'Snowfall'                                         and date = '2018-01-01') as ts2         ON ts.geo_id = ts2.geo_id join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  geo.level = 'Country' ORDER BY growth_percentage desc limit 1"
Which percentage of italy's public holidays in 2023 were financial holidays ?,"SELECT (COUNT(DISTINCT case when is_financial then holiday_name                  else null end) / count(DISTINCT holiday_name)) * 100 as percentage FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar WHERE  geo_id in (SELECT geo_id                   FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index                   WHERE  geo_name = 'Italy')    and date between '2023-01-01'    and '2023-12-31'"
Which 5 countries have the least Fertility Rate in year 2020 ?,"SELECT geo.geo_name,        ts.value as fertility_rate FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Fertility Rate, worldbank.org'    and geo.level = 'Country'    and ts.date = '2020-01-01' ORDER BY ts.value asc limit 5;"
Which country has the highest female population in 2020?,"SELECT geo.geo_name,        ts.value as female_population FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Female Population, census.gov'    and geo.level = 'Country'    and date = '2020-01-01' ORDER BY ts.value desc limit 1;"
What are levels of geoid available ?,SELECT DISTINCT level FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index
Which 5 countries have the least Life Expectancy in year 2020 ?,"SELECT geo.geo_name,        ts.value as life_expectancy FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Life Expectancy, worldbank.org'    and geo.level = 'Country'    and ts.date = '2020-01-01' ORDER BY ts.value asc limit 5;"
Which 5 countries have high asthma  rate?,"SELECT geo.geo_name,        avg(ts.value) as avg_asthma_rate FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Asthma prevalence, adult (% of population ages 18-45)'    and geo.level = 'Country' GROUP BY geo.geo_name ORDER BY avg_asthma_rate desc limit 5;"
Which 5 countries have the highest rainfall in 2023?,"SELECT geo.geo_name,        sum(ts.value) as cumulative_rainfall FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Mean Rainfall'    and geo.level = 'Country'    and ts.date between '2023-01-01'    and '2023-12-31' GROUP BY geo.geo_name ORDER BY cumulative_rainfall desc limit 5"
which country has the most population in year 2018 ? ,"SELECT geo.geo_name,        ts.value as total_population FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Total Population, census.gov'    and geo.level = 'Country'    and ts.date = '2018-01-01' ORDER BY ts.value desc limit 1"
Which are 2 counties that have the highest Air Quality Index variable?,"SELECT geo.geo_name,         MAX(ts.value) as max_aqi FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON (ts.geo_id = geo.geo_id) WHERE  variable_name ilike '%Air Quality Index%'    and level = 'County' GROUP BY 1  ORDER BY max_aqi DESC  LIMIT 2"
"What is the population growth of US Country And California State year or year from 2010 to 2018 ? The California state has multiple values for the population in each year, take the maximum for cleaning the data","SELECT geo.geo_name,        ts.date,        max(ts.value) as value,        ((max(ts.value) - lag(max(ts.value)) OVER(PARTITION BY geo.geo_name                                                  ORDER BY ts.date)) / lag(max(ts.value)) OVER(PARTITION BY geo.geo_name ORDER BY ts.date)) * 100 as growth_percentage FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Total Population, census.gov'    and (geo.geo_id = 'country/USA'     or geo.geo_name = 'California')    and ts.date between '2010-01-01'    and '2018-01-01' GROUP BY geo.geo_name, ts.date ORDER BY geo.geo_name, ts.date"
Which country  highest saw the snowfall growth % from 2010 to 2018 ? ,"SELECT geo.geo_name,        ((ts2.value - ts.value) / ts.value) * 100 as growth_percentage FROM   (SELECT geo_id,                date,                value         FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries         WHERE  variable_name = 'Snowfall'            and date = '2010-01-01') as ts join (SELECT geo_id,                                             date,                                             value                                      FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries                                      WHERE  variable_name = 'Snowfall'                                         and date = '2018-01-01') as ts2         ON ts.geo_id = ts2.geo_id join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  geo.level = 'Country' ORDER BY growth_percentage desc limit 1"
Which US states (use RELATED_GEO_NAME) have the highest population in the latest data?,"The error is caused by the incorrect usage of alias name for the `geography_index` table. To fix this, replace `geo.related_geo_name` with `geo.geo_name`.  Corrected SQL query:  ``` SELECT geo.geo_name as state,        max(ts.value) as population FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries ts         JOIN cybersyn_us__global_public_data_starter_kit.cybersyn.geography_relationships geo_rel         ON ts.geo_id = geo_rel.geo_id         JOIN cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index geo         ON geo.geo_id = geo_rel.related_geo_id WHERE  ts.variable_name = 'Total Population, census.gov'    AND geo.level = 'State'    AND ts.date = (SELECT max(date)                FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries) GROUP BY geo.geo_name ORDER BY population DESC; ```"
Which county has the highest Air Quality variable is highest ?,"SELECT geo.geo_name,        ts.date,        ts.value,        level,         variable_name FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON (ts.geo_id = geo.geo_id) WHERE  variable_name ilike '%Air%' ORDER BY ts.value desc limit 1"
what percentage of Us population was in California in 2018 ? ,"SELECT (ts.value/sum(ts.value) OVER()) * 100 as percentage FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Total Population, census.gov'    and geo.geo_name = 'California'    and ts.date = '2018-01-01'"
Which 5 countries have the most public financial holidays in 2023 ?,"SELECT geo.geo_name,        count(distinct case when is_financial then date                            else null end) as num_financial_holidays FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar as cal join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON cal.geo_id = geo.geo_id WHERE  geo.level = 'Country'    and cal.date between '2023-01-01'    and '2023-12-31' GROUP BY geo.geo_name ORDER BY num_financial_holidays desc limit 5"
What is the total population growth  of males between 2010 and 2018 ?,"SELECT (ts2.value - ts.value) as total_population_growth FROM   (SELECT geo_id,                date,                value         FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries         WHERE  variable_name = 'Total Male Population, census.gov'            and date = '2010-01-01') as ts join (SELECT geo_id,                                             date,                                             value                                      FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries                                      WHERE  variable_name = 'Total Male Population, census.gov'                                         and date = '2018-01-01') as ts2         ON ts.geo_id = ts2.geo_id WHERE  ts.geo_id = 'country/USA'"
What are different Continents we have information around ?,"SELECT DISTINCT iso_name FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index WHERE  level ilike '%Cont%' ORDER BY iso_name;"
Which country has the highest count of housing units?,"SELECT geo.geo_name,        sum(value) as total_housing_units FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON (ts.geo_id = geo.geo_id) WHERE  variable_name = 'Housing Units'    and level = 'Country' GROUP BY geo.geo_name ORDER BY total_housing_units desc limit 1"
What's the annual electricity consumption by country?,"SELECT gi.geo_name,        dcts.date,        dcts.value as annual_electricity_consumption FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as dcts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as gi         ON dcts.geo_id = gi.geo_id WHERE  dcts.variable_name = 'Annual Electricity Consumption'    and gi.level = 'Country' ORDER BY dcts.date"
which country has the maximum decrement of public holidays from 2000 to 2023 ?,"SELECT geo.geo_name,        count(distinct cal.holiday_name) as num_holidays,        count(distinct cal2.holiday_name) - count(distinct cal.holiday_name) as decrement FROM   (SELECT *         FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar         WHERE  date >= '2023-01-01'            and date < '2024-01-01') as cal join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON cal.geo_id = geo.geo_id join (SELECT *                                  FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar                                  WHERE  date >= '2000-01-01'                                     and date < '2001-01-01') as cal2         ON cal.geo_id = cal2.geo_id WHERE  geo.level = 'Country' GROUP BY geo.geo_name ORDER BY decrement desc limit 1"
Which state has the lowest Air Quality Index in 2017 ? ,"SELECT geo.geo_name,        DATE_TRUNC('day', date) as date,        AVG(value) as average_aqi FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts  JOIN cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON (ts.geo_id = geo.geo_id) WHERE  variable_name = 'Air Quality Index, EPA'    AND level = 'State' GROUP BY geo.geo_name, DATE_TRUNC('day', date) ORDER BY average_aqi asc LIMIT 1;"
What are the first 10 rows in the DATACOMMONS_TIMESERIES table?,"SELECT GEO_ID, VARIABLE, VARIABLE_NAME, DATE, VALUE, UNIT FROM CYBERSYN_US__GLOBAL_PUBLIC_DATA_STARTER_KIT.CYBERSYN.DATACOMMONS_TIMESERIES LIMIT 10"
What is the year on year population growth  of males between 2010 and 2018 in California ? Take the maximum value of population for each year ,"SELECT ts.date,        case when lag(ts.value) OVER (ORDER BY ts.date) = 0 then null             else ((ts.value - lag(ts.value) OVER (ORDER BY ts.date)) / lag(ts.value) OVER (ORDER BY ts.date)) * 100 end as growth_percentage FROM   (SELECT date,                max(value) as value         FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries         WHERE  variable_name = 'Male Population, census.gov'            and geo_id in (SELECT geo_id                        FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index                        WHERE  geo_name = 'California')            and date between '2010-01-01'            and '2018-01-01'         GROUP BY date) as ts"
how many public holidays does india have ?,SELECT count(distinct holiday_name) as num_holidays FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar WHERE  geo_id in (SELECT geo_id                   FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index                   WHERE  geo_name = 'India')
Which country has had the maximum growth of Mean Temperature in the last 10 years ? ,"SELECT geo.geo_name,        ((ts2.value - ts.value) / ts.value) * 100 as growth_percentage FROM   (SELECT geo_id,                date,                value         FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries         WHERE  variable_name = 'Mean Temperature'            and date = '2010-01-01') as ts join (SELECT geo_id,                                             date,                                             value                                      FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries                                      WHERE  variable_name = 'Mean Temperature'                                         and date = '2020-01-01') as ts2         ON ts.geo_id = ts2.geo_id join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  geo.level = 'Country' ORDER BY growth_percentage desc limit 1"
In which year did the United States have the highest Population ?,"SELECT date,        value FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts WHERE  variable_name = 'Total Population, census.gov'    and geo_id = 'country/USA' ORDER BY value desc limit 1"
Which country has the most public holidays ?,"SELECT geo.geo_name,        count(DISTINCT holiday_name) as num_holidays FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar as cal join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON cal.geo_id = geo.geo_id WHERE  geo.level = 'Country' GROUP BY geo.geo_name ORDER BY num_holidays desc limit 1"
Which 5 countries have the least Life Expectancy in year 2022 ?,"SELECT geo.geo_name,        ts.value as life_expectancy FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Life Expectancy, worldbank.org'    and geo.level = 'Country'    and ts.date = '2022-01-01' ORDER BY ts.value asc limit 5"
What are the top 10 countries by financial holidays in 2023?,"SELECT geo.geo_name,        count(distinct case when is_financial then holiday_name                            else null end) as num_financial_holidays FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar as cal join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON cal.geo_id = geo.geo_id WHERE  geo.level = 'Country'    and cal.date between '2023-01-01'    and '2023-12-31' GROUP BY geo.geo_name ORDER BY num_financial_holidays desc limit 10"
What is the different variables  ? ,SELECT DISTINCT variable_name FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_attributes
What different variable are there in the arrtibutes ?,SELECT DISTINCT VARIABLE_NAME FROM CYBERSYN_US__GLOBAL_PUBLIC_DATA_STARTER_KIT.cybersyn.datacommons_attributes
What are the different public holidays ?,SELECT DISTINCT holiday_name FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar
Which 5 countries saw the most decline in life expectation between 2012 and 2020 ? ,"SELECT geo.geo_name,        (max(case when ts.date = '2020-01-01' then ts.value                  else null end) - max(case when ts.date = '2012-01-01' then ts.value                  else null end)) as life_expectancy_decline FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  ts.variable_name = 'Life Expectancy, worldbank.org'    and geo.level = 'Country'    and ts.date in ('2012-01-01', '2020-01-01') GROUP BY geo.geo_name ORDER BY life_expectancy_decline desc limit 5"
On which day did Sierra Leone have least but not zero rainfall ? ,"SELECT date,        value FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries WHERE  variable_name = 'Mean Rainfall'    and geo_id = 'country/SLE'    and value > 0 ORDER BY value asc limit 1"
Which country has the maximum Annual Electricity Consumption in 2010 ?,"SELECT geo.geo_name,        ts.value as annual_electricity_consumption FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries as ts join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  variable_name = 'Annual Electricity Consumption'    and geo.level = 'Country'    and ts.date between '2010-01-01'    and '2010-12-31' ORDER BY annual_electricity_consumption desc limit 1"
"Which 5 countries saw the most %increase in mean temperature bewtween 2012 and 2020 ? where life expectancy is not null in 2012 , load a bar chart ","SELECT geo.geo_name,        ((ts2.value - ts.value) / ts.value) * 100 as increase_percentage FROM   (SELECT geo_id,                date,                value         FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries         WHERE  variable_name = 'Mean Temperature, noaa.gov'            and date = '2012-01-01') as ts join (SELECT geo_id,                                             date,                                             value                                      FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.datacommons_timeseries                                      WHERE  variable_name = 'Mean Temperature, noaa.gov'                                         and date = '2020-01-01') as ts2         ON ts.geo_id = ts2.geo_id join cybersyn_us__global_public_data_starter_kit.cybersyn.geography_index as geo         ON ts.geo_id = geo.geo_id WHERE  geo.level = 'Country'    and ts.value is not null ORDER BY increase_percentage desc limit 5;"
List all the public holidays in the United States in 2023,"SELECT holiday_name,        date FROM   cybersyn_us__global_public_data_starter_kit.cybersyn.public_holiday_calendar WHERE  geo_id = 'country/USA'    and date between '2023-01-01'    and '2023-12-31'"
Which campaigns have the lowest CPM?,"SELECT CAMPAIGN_NAME, SUM(SPEND)/SUM(IMPRESSIONS)*1000 AS CPM FROM FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__CAMPAIGN_REPORT GROUP BY CAMPAIGN_NAME ORDER BY CPM ASC LIMIT 10;"
What are the top 5 campaigns by spend?,"SELECT CAMPAIGN_NAME, SUM(SPEND) AS TOTAL_SPEND FROM FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__CAMPAIGN_REPORT GROUP BY CAMPAIGN_NAME ORDER BY TOTAL_SPEND DESC LIMIT 5;"
"For the keywords with the lowest CPM , how many impressions did they have?","``` SELECT      KEYWORD_TEXT,      SUM(IMPRESSIONS) AS TOTAL_IMPRESSIONS,     SUM(SPEND)/SUM(IMPRESSIONS)*1000 AS CPM FROM      FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__KEYWORD_REPORT  GROUP BY      KEYWORD_TEXT  HAVING      TOTAL_IMPRESSIONS > 0  ORDER BY      CPM ASC  LIMIT      10; ```"
What keywords have the highest CPM (cost per thousand impressions)?,"SELECT KEYWORD_TEXT, SUM(SPEND)/SUM(IMPRESSIONS)*1000 AS CPM FROM FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__KEYWORD_REPORT GROUP BY KEYWORD_TEXT ORDER BY CPM DESC LIMIT 10;"
"What are the top 10 spending campaigns and corresponding URLs, along with their account, campaign, and ad group information, from a Google Ads URL report?","SELECT      DATE_DAY,      ACCOUNT_NAME,      ACCOUNT_ID,      CAMPAIGN_NAME,      CAMPAIGN_ID,      AD_GROUP_NAME,      AD_GROUP_ID,      AD_ID,      BASE_URL,      URL_HOST,      URL_PATH,      UTM_SOURCE,      UTM_MEDIUM,      UTM_CAMPAIGN,      UTM_CONTENT,      UTM_TERM,      SPEND,      CLICKS,      IMPRESSIONS FROM      FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__URL_REPORT  ORDER BY      SPEND DESC  LIMIT      10;"
Which campaigns have the lowest CPM? Show the total impressions for each of these campaigns?,"SELECT      CAMPAIGN_NAME,      SUM(SPEND)/SUM(IMPRESSIONS)*1000 AS CPM,     SUM(IMPRESSIONS) AS TOTAL_IMPRESSIONS FROM      FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__CAMPAIGN_REPORT  GROUP BY      CAMPAIGN_NAME  HAVING      SUM(IMPRESSIONS) > 0 ORDER BY      CPM ASC  LIMIT      10;"
Which keywords have the lowest CPM?,"SELECT KEYWORD_TEXT, SUM(SPEND)/SUM(IMPRESSIONS)*1000 AS CPM FROM FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__KEYWORD_REPORT GROUP BY KEYWORD_TEXT ORDER BY CPM ASC LIMIT 10;"
What are the top 10 daily performance metrics for Google Ads accounts?,"SELECT DATE_DAY, ACCOUNT_NAME, ACCOUNT_ID, CURRENCY_CODE, AUTO_TAGGING_ENABLED, TIME_ZONE, SPEND, CLICKS, IMPRESSIONS FROM FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__ACCOUNT_REPORT ORDER BY DATE_DAY DESC LIMIT 10;"
which 10 facebook campaigns had the highest average CTR over all time per the fb_basic_all_levels table? ,"``` SELECT campaign_name, AVG(CTR) as average_ctr FROM mc_facebook_ads.fb_basic_all_levels GROUP BY campaign_name ORDER BY average_ctr DESC LIMIT 10 ```"
What was my total spending by date for Google ads and Facebook ads by quarter?,"SELECT platform,        extract(year FROM   date) as year, to_char(date, 'Q') as quarter, sum(total_spend) as total_spend FROM   (SELECT 'Google Ads' as platform,                date_day as date,                sum(spend) as total_spend         FROM   fivetran_database.mc_google_ads.google_ads__campaign_report         GROUP BY date_day         UNION all SELECT 'Facebook Ads' as platform,                date,                sum(spend) as total_spend         FROM   mc_facebook_ads.fb_basic_all_levels         GROUP BY date) as all_data GROUP BY platform, year, quarter ORDER BY platform, year, quarter;"
Which keywords had the highest clicks?,"SELECT KEYWORD_TEXT, SUM(CLICKS) AS TOTAL_CLICKS FROM FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__KEYWORD_REPORT GROUP BY KEYWORD_TEXT ORDER BY TOTAL_CLICKS DESC LIMIT 10;"
What was the total spend for Google Ads vs Facebook ads by date?,"SELECT date_day,        'Google Ads' as platform,        sum(spend) as total_spend FROM   fivetran_database.mc_google_ads.google_ads__campaign_report GROUP BY date_day UNION all SELECT date,        'Facebook Ads' as platform,        sum(spend) as total_spend FROM   mc_facebook_ads.fb_basic_all_levels GROUP BY date ORDER BY date_day desc;"
what was the daily spend per the fb_basic_all_levels table? ,"SELECT date, SUM(spend) as daily_spend FROM mc_facebook_ads.fb_basic_all_levels GROUP BY date ORDER BY date DESC"
What was my total spending by date for Google ads and Facebook ads?,"SELECT date,        platform,        sum(total_spend) as total_spend FROM   (SELECT date_day as date,                'Google Ads' as platform,                sum(spend) as total_spend         FROM   fivetran_database.mc_google_ads.google_ads__campaign_report         GROUP BY date_day         UNION all SELECT date,                'Facebook Ads' as platform,                sum(spend) as total_spend         FROM   mc_facebook_ads.fb_basic_all_levels         GROUP BY date) as all_data GROUP BY date, platform ORDER BY date desc;"
What is the total ad spend?,SELECT SUM(SPEND) AS TOTAL_SPEND FROM FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__CAMPAIGN_REPORT;
What was the total spend for Google Ads vs Facebook ads by date in 2022?,"SELECT platform,        date,        sum(total_spend) as total_spend FROM   (SELECT 'Google Ads' as platform,                date_day as date,                sum(spend) as total_spend         FROM   fivetran_database.mc_google_ads.google_ads__campaign_report         WHERE  extract(year         FROM   date_day) = 2022         GROUP BY date_day         UNION all SELECT 'Facebook Ads' as platform,                date,                sum(spend) as total_spend         FROM   mc_facebook_ads.fb_basic_all_levels         WHERE  extract(year         FROM   date) = 2022         GROUP BY date) as all_data GROUP BY platform, date ORDER BY date desc"
"What are total clicks by day of the week? Use day names like Monday, Tuesday, etc. When visualizing use a heatmap","Here is the SQL code to get total clicks by day of the week as well as the day names:  ``` SELECT      CASE          WHEN DAYOFWEEK(DATE_DAY) = 1 THEN 'Sunday'          WHEN DAYOFWEEK(DATE_DAY) = 2 THEN 'Monday'          WHEN DAYOFWEEK(DATE_DAY) = 3 THEN 'Tuesday'          WHEN DAYOFWEEK(DATE_DAY) = 4 THEN 'Wednesday'          WHEN DAYOFWEEK(DATE_DAY) = 5 THEN 'Thursday'          WHEN DAYOFWEEK(DATE_DAY) = 6 THEN 'Friday'          WHEN DAYOFWEEK(DATE_DAY) = 7 THEN 'Saturday'      END AS DAY_OF_WEEK_STR,     DAYOFWEEK(DATE_DAY) as DAY_OF_WEEK,     SUM(CLICKS) AS TOTAL_CLICKS  FROM      FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__CAMPAIGN_REPORT  GROUP BY      DAY_OF_WEEK, DAY_OF_WEEK_STR ORDER BY      DAY_OF_WEEK ASC; ```  To visualize this as a heatmap, you can use a tool like Tableau or Power BI and create a heatmap chart using the day of the week as the X axis, the week number or date as the Y axis, and the total clicks as the color or intensity of the heatmap."
What are the latest performance metrics for the keywords in the Google Ads account?,"SELECT DATE_DAY, ACCOUNT_NAME, ACCOUNT_ID, CAMPAIGN_NAME, CAMPAIGN_ID, AD_GROUP_NAME, AD_GROUP_ID, CRITERION_ID, TYPE, STATUS, KEYWORD_MATCH_TYPE, KEYWORD_TEXT, SPEND, CLICKS, IMPRESSIONS FROM FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__KEYWORD_REPORT ORDER BY DATE_DAY DESC LIMIT 10;"
What percentage of each column contains null values?,"Here is the SQL code to calculate the percentage of null values for each column in the `GOOGLE_ADS__CAMPAIGN_REPORT` table:  ``` SELECT      ROUND((SUM(CASE WHEN CAMPAIGN_ID IS NULL THEN 1 ELSE 0 END) / COUNT(*)) * 100, 2) AS PERC_NULL_CAMPAIGN_ID,     ROUND((SUM(CASE WHEN CAMPAIGN_NAME IS NULL THEN 1 ELSE 0 END) / COUNT(*)) * 100, 2) AS PERC_NULL_CAMPAIGN_NAME,     ROUND((SUM(CASE WHEN DATE_DAY IS NULL THEN 1 ELSE 0 END) / COUNT(*)) * 100, 2) AS PERC_NULL_DATE_DAY,     ROUND((SUM(CASE WHEN CLICKS IS NULL THEN 1 ELSE 0 END) / COUNT(*)) * 100, 2) AS PERC_NULL_CLICKS,     ROUND((SUM(CASE WHEN IMPRESSIONS IS NULL THEN 1 ELSE 0 END) / COUNT(*)) * 100, 2) AS PERC_NULL_IMPRESSIONS,     ROUND((SUM(CASE WHEN SPEND IS NULL THEN 1 ELSE 0 END) / COUNT(*)) * 100, 2) AS PERC_NULL_SPEND FROM      FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__CAMPAIGN_REPORT; ```  This query will return the percentage of null values for each column in the table. You can modify the column names to calculate the percentage of null values for other columns in the table."
What are the top 10 keywords by impressions?,"SELECT KEYWORD_TEXT, SUM(IMPRESSIONS) AS TOTAL_IMPRESSIONS FROM FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__KEYWORD_REPORT GROUP BY KEYWORD_TEXT ORDER BY TOTAL_IMPRESSIONS DESC LIMIT 10;"
What is the number of impressions by date?,"SELECT DATE_DAY, SUM(IMPRESSIONS) AS TOTAL_IMPRESSIONS FROM FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__CAMPAIGN_REPORT GROUP BY DATE_DAY ORDER BY DATE_DAY DESC"
What are the recent performance metrics of the top ad groups in Google Ads?,"SELECT DATE_DAY, ACCOUNT_NAME, ACCOUNT_ID, CAMPAIGN_NAME, CAMPAIGN_ID, AD_GROUP_NAME, AD_GROUP_ID, AD_GROUP_STATUS, AD_GROUP_TYPE, SPEND, CLICKS, IMPRESSIONS FROM FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__AD_GROUP_REPORT ORDER BY DATE_DAY DESC LIMIT 10;"
Which campaigns have the highest CPM?,"Please note that CPM is cost per thousand impressions, therefore this query will fetch campaigns with the highest cost per thousand impressions.  ``` SELECT      CAMPAIGN_NAME,      SUM(SPEND)/SUM(IMPRESSIONS)*1000 AS CPM  FROM      FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__CAMPAIGN_REPORT  GROUP BY      CAMPAIGN_NAME  ORDER BY      CPM DESC  LIMIT      10; ```"
What are the top 10 keywords by spend?,"SELECT KEYWORD_TEXT, SUM(SPEND) AS TOTAL_SPEND FROM FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__KEYWORD_REPORT GROUP BY KEYWORD_TEXT ORDER BY TOTAL_SPEND DESC LIMIT 10;"
What are the latest performance metrics for the ads in Google Ads?,"SELECT DATE_DAY, ACCOUNT_NAME, ACCOUNT_ID, CAMPAIGN_NAME, CAMPAIGN_ID, AD_GROUP_NAME, AD_GROUP_ID, AD_ID, AD_NAME, AD_STATUS, AD_TYPE, DISPLAY_URL, SOURCE_FINAL_URLS, SPEND, CLICKS, IMPRESSIONS FROM FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__AD_REPORT ORDER BY DATE_DAY DESC LIMIT 10;"
"What are the top 10 URLs that users clicked on in the last few days, along with information about the ad campaign and associated costs?","SELECT DATE_DAY, ACCOUNT_NAME, ACCOUNT_ID, CAMPAIGN_NAME, CAMPAIGN_ID, AD_GROUP_NAME, AD_GROUP_ID, AD_ID, BASE_URL, URL_HOST, URL_PATH, UTM_SOURCE, UTM_MEDIUM, UTM_CAMPAIGN, UTM_CONTENT, UTM_TERM, SPEND, CLICKS, IMPRESSIONS FROM FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__URL_REPORT ORDER BY DATE_DAY DESC LIMIT 10;"
What was the total spend for Google Ads vs Facebook ads?,"SELECT 'Google Ads' as platform,        sum(spend) as total_spend FROM   fivetran_database.mc_google_ads.google_ads__campaign_report UNION all SELECT 'Facebook Ads' as platform,        sum(spend) as total_spend FROM   mc_facebook_ads.fb_basic_all_levels"
"What are total clicks by day of the week? Use day names like Monday, Tuesday, etc","Assuming you want to display the day names instead of the day of the week number, you can use the following SQL code:  ``` SELECT      CASE          WHEN DAYOFWEEK(DATE_DAY) = 1 THEN 'Sunday'          WHEN DAYOFWEEK(DATE_DAY) = 2 THEN 'Monday'          WHEN DAYOFWEEK(DATE_DAY) = 3 THEN 'Tuesday'          WHEN DAYOFWEEK(DATE_DAY) = 4 THEN 'Wednesday'          WHEN DAYOFWEEK(DATE_DAY) = 5 THEN 'Thursday'          WHEN DAYOFWEEK(DATE_DAY) = 6 THEN 'Friday'          WHEN DAYOFWEEK(DATE_DAY) = 7 THEN 'Saturday'      END AS DAY_OF_WEEK_STR,     DAYOFWEEK(DATE_DAY) as DAY_OF_WEEK,     SUM(CLICKS) AS TOTAL_CLICKS  FROM      FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__CAMPAIGN_REPORT  GROUP BY      DAY_OF_WEEK, DAY_OF_WEEK_STR ORDER BY      DAY_OF_WEEK ASC; ```   Note that the `CASE` statement is used to convert the day of the week number to the corresponding day name."
What was the total spend for Google Ads vs Facebook ads in the year 2022?,"SELECT platform,        sum(total_spend) as total_spend FROM   (SELECT 'Google Ads' as platform,                date_trunc('day', date_day) as date_day,                sum(spend) as total_spend         FROM   fivetran_database.mc_google_ads.google_ads__campaign_report         WHERE  date_trunc('year', date_day) = '2022-01-01'         GROUP BY date_trunc('day', date_day)         UNION all SELECT 'Facebook Ads' as platform,                date_trunc('day', date) as date_day,                sum(spend) as total_spend         FROM   mc_facebook_ads.fb_basic_all_levels         WHERE  date_trunc('year', date) = '2022-01-01'         GROUP BY date_trunc('day', date)) as all_data GROUP BY platform;"
What are the top 5 keywords by spend?,"SELECT KEYWORD_TEXT, SUM(SPEND) AS TOTAL_SPEND FROM FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__KEYWORD_REPORT GROUP BY KEYWORD_TEXT ORDER BY TOTAL_SPEND DESC LIMIT 5;"
What is the total ad spend by date?,"SELECT DATE_DAY, SUM(SPEND) AS TOTAL_SPEND FROM FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__CAMPAIGN_REPORT GROUP BY DATE_DAY ORDER BY DATE_DAY DESC"
What was the quarterly spending in Google ads vs Facebook ads?,"SELECT platform,        date_trunc('quarter', date) as quarter,        sum(spend) as total_spend FROM   (SELECT 'Google Ads' as platform,                date_day as date,                spend         FROM   fivetran_database.mc_google_ads.google_ads__campaign_report         UNION all SELECT 'Facebook Ads' as platform,                date,                spend         FROM   mc_facebook_ads.fb_basic_all_levels) as all_data GROUP BY platform, quarter ORDER BY platform, quarter"
What are the top 3 campaigns by spend?,"SELECT CAMPAIGN_NAME, SUM(SPEND) AS TOTAL_SPEND FROM FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__CAMPAIGN_REPORT GROUP BY CAMPAIGN_NAME ORDER BY TOTAL_SPEND DESC LIMIT 3;"
What are the top 10 campaigns by number of impressions?,"SELECT DATE_DAY, ACCOUNT_NAME, ACCOUNT_ID, CAMPAIGN_NAME, CAMPAIGN_ID, ADVERTISING_CHANNEL_TYPE, ADVERTISING_CHANNEL_SUBTYPE, STATUS, SPEND, CLICKS, IMPRESSIONS FROM FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__CAMPAIGN_REPORT ORDER BY IMPRESSIONS DESC LIMIT 10;"
What are the latest performance metrics for the Google Ads campaigns?,"SELECT DATE_DAY, ACCOUNT_NAME, ACCOUNT_ID, CAMPAIGN_NAME, CAMPAIGN_ID, ADVERTISING_CHANNEL_TYPE, ADVERTISING_CHANNEL_SUBTYPE, STATUS, SPEND, CLICKS, IMPRESSIONS FROM FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__CAMPAIGN_REPORT ORDER BY DATE_DAY DESC LIMIT 10;"
What are total clicks by day of the week?,"SELECT DAYOFWEEK(DATE_DAY) AS DAY_OF_WEEK, SUM(CLICKS) AS TOTAL_CLICKS  FROM FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__CAMPAIGN_REPORT  GROUP BY DAY_OF_WEEK  ORDER BY DAY_OF_WEEK ASC;"
What are the top 5 keywords by impressions?,"SELECT KEYWORD_TEXT, SUM(IMPRESSIONS) AS TOTAL_IMPRESSIONS FROM FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__KEYWORD_REPORT GROUP BY KEYWORD_TEXT ORDER BY TOTAL_IMPRESSIONS DESC LIMIT 5;"
"Which keywords have the lowest CPM, where keyword spend was at least $500","SELECT KEYWORD_TEXT, SUM(SPEND)/SUM(IMPRESSIONS)*1000 AS CPM FROM FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__KEYWORD_REPORT WHERE SPEND >= 500 GROUP BY KEYWORD_TEXT HAVING SUM(IMPRESSIONS) > 0 ORDER BY CPM ASC LIMIT 10;"
Which dates had outlier spending in Facebook ads?,"with daily_spend as (SELECT date,                             sum(spend) as total_spend,                             avg(sum(spend)) OVER() as mean_spend,                             stddev(sum(spend)) OVER() as std_spend                      FROM   mc_facebook_ads.fb_basic_all_levels                      GROUP BY date) SELECT date,        total_spend,        mean_spend,        std_spend,        (total_spend - mean_spend)/std_spend as z_score FROM   daily_spend WHERE  abs((total_spend - mean_spend)/std_spend) > 3 ORDER BY date desc;"
"Which keywords have the lowest CPM, where keyword spend was at least $100","SELECT KEYWORD_TEXT, SUM(SPEND)/SUM(IMPRESSIONS)*1000 AS CPM FROM FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__KEYWORD_REPORT WHERE SPEND >= 100 GROUP BY KEYWORD_TEXT HAVING SUM(IMPRESSIONS) > 0 ORDER BY CPM ASC LIMIT 10;"
What is the distribution of impressions by campaign for the top 5 campaigns by impressions?,"``` SELECT      CAMPAIGN_NAME,      SUM(IMPRESSIONS) AS TOTAL_IMPRESSIONS,      ROUND(SUM(IMPRESSIONS)*100.0/SUM(SUM(IMPRESSIONS)) OVER (),2) AS IMPRESSIONS_PCT FROM      FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__CAMPAIGN_REPORT WHERE      CAMPAIGN_NAME IN (         SELECT              CAMPAIGN_NAME         FROM              FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__CAMPAIGN_REPORT         GROUP BY              CAMPAIGN_NAME         ORDER BY              SUM(IMPRESSIONS) DESC         LIMIT              5     ) GROUP BY      CAMPAIGN_NAME ORDER BY      TOTAL_IMPRESSIONS DESC; ```"
"What are the top spending campaigns by date, account, and campaign, sorted by total spend, clicks, and impressions?","SELECT      DATE_DAY,      ACCOUNT_NAME,      ACCOUNT_ID,      CAMPAIGN_NAME,      CAMPAIGN_ID,      SUM(SPEND) AS TOTAL_SPEND,      SUM(CLICKS) AS TOTAL_CLICKS,      SUM(IMPRESSIONS) AS TOTAL_IMPRESSIONS FROM      FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__CAMPAIGN_REPORT  GROUP BY      DATE_DAY,      ACCOUNT_NAME,      ACCOUNT_ID,      CAMPAIGN_NAME,      CAMPAIGN_ID  ORDER BY      TOTAL_SPEND DESC,      TOTAL_CLICKS DESC,      TOTAL_IMPRESSIONS DESC  LIMIT      10;"
What are total clicks by date?,"SELECT DATE_DAY, SUM(CLICKS) AS TOTAL_CLICKS FROM FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__CAMPAIGN_REPORT GROUP BY DATE_DAY ORDER BY DATE_DAY DESC"
what was the daily spend per the fb_basic_all_levels table by campaign_name? ,"``` SELECT date, campaign_name, SUM(spend) as daily_spend FROM mc_facebook_ads.fb_basic_all_levels GROUP BY date, campaign_name ORDER BY date DESC ```"
What was the total spend for Google Ads vs Facebook ads in the year 2022 compared to 2021 for each quarter?,"SELECT platform,        year,        quarter,        sum(total_spend) as total_spend FROM   (SELECT 'Google Ads' as platform,                extract(year         FROM   date_day) as year, to_char(date_day, 'Q') as quarter, sum(spend) as total_spend         FROM   fivetran_database.mc_google_ads.google_ads__campaign_report         WHERE  extract(year         FROM   date_day) in (2021, 2022)         GROUP BY extract(year         FROM   date_day), to_char(date_day, 'Q')         UNION all SELECT 'Facebook Ads' as platform,                extract(year         FROM   date) as year, to_char(date, 'Q') as quarter, sum(spend) as total_spend         FROM   mc_facebook_ads.fb_basic_all_levels         WHERE  extract(year         FROM   date) in (2021, 2022)         GROUP BY extract(year         FROM   date), to_char(date, 'Q')) as all_data GROUP BY platform, year, quarter ORDER BY platform, year, quarter"
What is the total number of campaigns in the Google Ads Campaign Report?,SELECT COUNT(DISTINCT CAMPAIGN_ID) AS NUM_CAMPAIGNS FROM FIVETRAN_DATABASE.MC_GOOGLE_ADS.GOOGLE_ADS__CAMPAIGN_REPORT
Which dates had outlier spending in Google ads?,"with daily_spend as (SELECT date_day,                             sum(spend) as total_spend,                             avg(sum(spend)) OVER() as mean_spend,                             stddev(sum(spend)) OVER() as std_spend                      FROM   fivetran_database.mc_google_ads.google_ads__campaign_report                      GROUP BY date_day) SELECT date_day,        total_spend,        mean_spend,        std_spend,        (total_spend - mean_spend)/std_spend as z_score FROM   daily_spend WHERE  abs((total_spend - mean_spend)/std_spend) > 3 ORDER BY date_day desc;"
what % of frauds v/s non fraud transactions leave the new balance of the origin account to 0?,"SELECT  'fraud' as type,         sum(case when isfraud = 1 and                      newbalanceorig = 0 then 1                 else 0 end) * 100 / sum(case when isfraud = 1 then 1                 else 0 end) as fraud_percentage     FROM   paysim_table.base_data GROUP BY 1   UNION   SELECT 'non fraud' as type,        sum(case when isfraud = 0 and                      newbalanceorig = 0 then 1                 else 0 end) * 100 / sum(case when isfraud = 0 then 1                 else 0 end) as non_fraud_percentage FROM   paysim_table.base_data GROUP BY 1"
"what is the mean, median, 95th percentile, and 99th percentile amount transferred grouped by if it is fraud vs not","SELECT isfraud,        avg(amount) as mean_amount,        percentile_cont(0.5) within group (ORDER BY amount) as median_amount,        percentile_cont(0.95) within group (ORDER BY amount) as percentile_95th,        percentile_cont(0.99) within group (ORDER BY amount) as percentile_99th FROM   paysim_table.base_data GROUP BY isfraud"
what is destination account received most number of transfers through frauds ?,"SELECT namedest,        count(*) as num_transfers FROM   paysim_table.base_data WHERE  isfraud = 1 GROUP BY namedest ORDER BY num_transfers desc limit 1"
what is the % of fraud across each payment method. ?,"SELECT type,        count(case when isfraud = 1 then 1 end) * 100 / count(*) as fraud_percentage FROM   paysim_table.base_data GROUP BY type;"
give the count of transactions  and frauds across the type of payments?,"SELECT type,        count(*) as num_transactions,        count(case when isfraud = 1 then 1 end) as num_frauds FROM   paysim_table.base_data GROUP BY type;"
what % of frauds v/s non fraud transactions leave the new balance of the origin account to 0. Plot bar chart.,"SELECT 'fraud' as type,        sum(case when isfraud = 1 and                      newbalanceorig = 0 then 1                 else 0 end) * 100 / sum(case when isfraud = 1 then 1                 else 0 end) as fraud_percentage FROM   paysim_table.base_data UNION SELECT 'non fraud' as type,        sum(case when isfraud = 0 and                      newbalanceorig = 0 then 1                 else 0 end) * 100 / sum(case when isfraud = 0 then 1                 else 0 end) as non_fraud_percentage FROM   paysim_table.base_data;"
what are the 5 lowest amount frauds ?,"SELECT amount,        nameorig,        namedest FROM   paysim_table.base_data WHERE  isfraud = 1 ORDER BY amount asc limit 5;"
 what are the total number of transactions in the dataset ,"SELECT count(*) as num_transactions FROM   paysim_table.base_data;"
give the % transactions are frauds across the type of payments?,"SELECT type,        count(case when isfraud = 1 then 1 end) * 100 / count(*) as fraud_percentage FROM   paysim_table.base_data GROUP BY type;"
"what is the mean, median, 95th percentile, and 99th percentile amount transferred via fraud ?","SELECT avg(amount) as mean_amount,        percentile_cont(0.5) within group (ORDER BY amount) as median_amount,        percentile_cont(0.95) within group (ORDER BY amount) as percentile_95th,        percentile_cont(0.99) within group (ORDER BY amount) as percentile_99th FROM   paysim_table.base_data WHERE  isfraud = 1;"
what % of frauds leave the new balance of the origin account to 0? compare this to non frauds,"SELECT         sum(case when isfraud = 1 and newbalanceorig = 0 then 1 else 0 end) * 100 / sum(case when isfraud = 1 then 1 else 0 end) as fraud_percentage,        sum(case when isfraud = 0 and newbalanceorig = 0 then 1 else 0 end) * 100 / sum(case when isfraud = 0 then 1 else 0 end) as non_fraud_percentage FROM   paysim_table.base_data "
the % of frauds with origin accounts and destination accounts that start with letter C vs letter M\,"SELECT sum(case when isfraud = 1 and                      substr(nameorig, 1, 1) = 'C' and                      substr(namedest, 1, 1) = 'C' then 1                 else 0 end) * 100 / sum(case when isfraud = 1 then 1                 else 0 end) as cc_fraud_percentage,        sum(case when isfraud = 1 and                      substr(nameorig, 1, 1) = 'M' and                      substr(namedest, 1, 1) = 'M' then 1                 else 0 end) * 100 / sum(case when isfraud = 1 then 1                 else 0 end) as mm_fraud_percentage FROM   paysim_table.base_data"
how many frauds are of value greater than 1 million and how many are less than 1 million ?,"SELECT case when amount >= 1000000 then 'greater than 1 million' else 'less than 1 million' end as type, count(*) as num_greater FROM   paysim_table.base_data WHERE  isfraud = 1 GROUP By 1"
"what is the mean, median, 95th percentile, and 99th percentile amount transferred if it fraud v/s when it's not fraud","SELECT isfraud,        avg(amount) as mean_amount,        percentile_cont(0.5) within group (ORDER BY amount) as median_amount,        percentile_cont(0.95) within group (ORDER BY amount) as percentile_95th,        percentile_cont(0.99) within group (ORDER BY amount) as percentile_99th FROM   paysim_table.base_data GROUP BY isfraud"
what % of frauds leave the new balance of the origin account to 0? compare this to non frauds.,"SELECT sum(case when isfraud = 1 and                      newbalanceorig = 0 then 1                 else 0 end) * 100 / count(*) as fraud_percentage,        sum(case when isfraud = 0 and                      newbalanceorig = 0 then 1                 else 0 end) * 100 / count(*) as non_fraud_percentage FROM   paysim_table.base_data"
what % of frauds v/s non fraud transactions empty the origin account to 0 balance. Plot bar chart,"SELECT 'fraud' as type,        sum(case when isfraud = 1 and                      newbalanceorig = 0 then 1                 else 0 end) * 100 / sum(case when isfraud = 1 then 1                 else 0 end) as fraud_percentage FROM   paysim_table.base_data UNION SELECT 'non fraud' as type,        sum(case when isfraud = 0 and                      newbalanceorig = 0 then 1                 else 0 end) * 100 / sum(case when isfraud = 0 then 1                 else 0 end) as non_fraud_percentage FROM   paysim_table.base_data"
what are the distribution of payment methods for all the frauds ?,"SELECT type,        count(*) as num_frauds FROM   paysim_table.base_data WHERE  isfraud = 1 GROUP BY type;"
what are 5 reciever accounts with most number of frauds ?,"SELECT namedest,        count(*) as frauds FROM   paysim_table.base_data WHERE  isfraud = 1 GROUP BY 1 ORDER BY frauds desc limit 5"
is there a name which has more than 1 fraud ?,"    SELECT nameorig, COUNT(*) as frauds     FROM paysim_table.base_data     WHERE  isfraud = 1     GROUP BY 1      HAVING COUNT(*) > 1      ORDER BY frauds DESC"
what is the percentage fraud in all transactions ?,SELECT count(case when isfraud = 1 then 1 end) * 100 / count(*) as fraud_percentage FROM   paysim_table.base_data;
the % of frauds with  origin accounts that start with letter C vs letter M,"SELECT sum(case when isfraud = 1 and                      substr(nameorig, 1, 1) = 'C' then 1                 else 0 end) * 100 / sum(case when isfraud = 1 then 1                 else 0 end) as c_fraud_percentage,        sum(case when isfraud = 1 and                      substr(nameorig, 1, 1) = 'M' then 1                 else 0 end) * 100 / sum(case when isfraud = 1 then 1                 else 0 end) as m_fraud_percentage FROM   paysim_table.base_data"
what are the %distribution of across each payment methods for all the frauds ?,"SELECT type,        count(*) * 100 / (SELECT count(*)                   FROM   paysim_table.base_data                   WHERE  isfraud = 1) as fraud_percentage FROM   paysim_table.base_data WHERE  isfraud = 1 GROUP BY type;"
what % of frauds v/s non fraud transactions leave the new balance of the origin account to 0. Plot bar chart with labels,"SELECT 'fraud' as type,        sum(case when isfraud = 1 and                      newbalanceorig = 0 then 1                 else 0 end) * 100 / sum(case when isfraud = 1 then 1                 else 0 end) as fraud_percentage FROM   paysim_table.base_data UNION SELECT 'non fraud' as type,        sum(case when isfraud = 0 and                      newbalanceorig = 0 then 1                 else 0 end) * 100 / sum(case when isfraud = 0 then 1                 else 0 end) as non_fraud_percentage FROM   paysim_table.base_data"
What are the number of frauds in the data,"SELECT count(*) as num_frauds FROM   paysim_table.base_data WHERE  isfraud = 1;"
what % of frauds go to an origin account to with 0 old balance?,SELECT count(*) * 100 / (SELECT count(*)                          FROM   paysim_table.base_data                          WHERE  isfraud = 1) as fraud_percentage FROM   paysim_table.base_data WHERE  isfraud = 1    and oldbalanceorg = 0;
what are the 5 highest amounted fraud transactions ?,"SELECT amount,        nameorig,        namedest FROM   paysim_table.base_data WHERE  isfraud = 1 ORDER BY amount desc limit 5;"
What are the 10 countries with highest government debt in 2008 ? ,"SELECT geo_name,        value FROM   data_commons_public_data.cybersyn.timeseries join data_commons_public_data.cybersyn.geo_index         ON timeseries.geo_id = geo_index.id WHERE  variable_name = 'Amount of Debt: Government'    and date = '2008-01-01'    and geo_id like 'country/%' ORDER BY value desc limit 10;"
what % of frauds v/s non fraud transactions empty the origin account to 0 balance. Plot fraud percentage as bar chart,"SELECT 'fraud' as type,        sum(case when isfraud = 1 and                      newbalanceorig = 0 then 1                 else 0 end) * 100 / sum(case when isfraud = 1 then 1                 else 0 end) as fraud_percentage FROM   paysim_table.base_data UNION SELECT 'non fraud' as type,        sum(case when isfraud = 0 and                      newbalanceorig = 0 then 1                 else 0 end) * 100 / sum(case when isfraud = 0 then 1                 else 0 end) as non_fraud_percentage FROM   paysim_table.base_data"
what are the 5 highest amounted non fraud transactions ?,"SELECT amount,        nameorig,        namedest FROM   paysim_table.base_data WHERE  isfraud = 0 ORDER BY amount desc limit 5;"
what name has created the most number of frauds ?,"SELECT nameorig, COUNT(*) as frauds FROM paysim_table.base_data WHERE  isfraud = 1 GROUP BY 1  ORDER BY frauds DESC LIMIT 1 "
give the % transactions that are frauds across the type of payments?,"SELECT type,        count(case when isfraud = 1 then 1 end) * 100 / count(*) as fraud_percentage FROM   paysim_table.base_data GROUP BY type;"
What are the first 10 rows in the BASE_DATA table?,"SELECT * FROM paysim_table.base_data limit 10;"
what is destination account received most amount of transfer through frauds ?,"SELECT namedest,        sum(amount) as total_amount FROM   paysim_table.base_data WHERE  isfraud = 1 GROUP BY namedest ORDER BY total_amount desc limit 1;"
what % of frauds v/s non fraud transactions leave the new balance of the origin account to 0.,"SELECT sum(case when isfraud = 1 and                      newbalanceorig = 0 then 1                 else 0 end) * 100 / sum(case when isfraud = 1 then 1                 else 0 end) as fraud_percentage,        sum(case when isfraud = 0 and                      newbalanceorig = 0 then 1                 else 0 end) * 100 / sum(case when isfraud = 0 then 1                 else 0 end) as non_fraud_percentage FROM   paysim_table.base_data;"
"what is the mean, median, 95th percentile, and 99th percentile amount transferred via a transaction if it fraud v/s when it's not fraud","SELECT isfraud,        avg(amount) as mean_amount,        percentile_cont(0.5) within group (ORDER BY amount) as median_amount,        percentile_cont(0.95) within group (ORDER BY amount) as percentile_95th,        percentile_cont(0.99) within group (ORDER BY amount) as percentile_99th FROM   paysim_table.base_data GROUP BY isfraud"
"what is the mean, median, 95th percentile, and 99th percentile amount transferred via fraud vs not fraud ?","SELECT avg(amount) as mean_amount,        percentile_cont(0.5) within group (ORDER BY amount) as median_amount,        percentile_cont(0.95) within group (ORDER BY amount) as percentile_95th,        percentile_cont(0.99) within group (ORDER BY amount) as percentile_99th FROM   paysim_table.base_data WHERE  isfraud = 1;"
what % of frauds v/s non fraud transactions leave the new balance of the origin account to 0. Plot bar chart,"SELECT 'fraud' as type,        sum(case when isfraud = 1 and                      newbalanceorig = 0 then 1                 else 0 end) * 100 / sum(case when isfraud = 1 then 1                 else 0 end) as fraud_percentage FROM   paysim_table.base_data UNION SELECT 'non fraud' as type,        sum(case when isfraud = 0 and                      newbalanceorig = 0 then 1                 else 0 end) * 100 / sum(case when isfraud = 0 then 1                 else 0 end) as non_fraud_percentage FROM   paysim_table.base_data;"
the % of frauds with destination accounts that start with letter C vs letter M\,"SELECT sum(case when isfraud = 1 and                      substr(namedest, 1, 1) = 'C' then 1                 else 0 end) * 100 / sum(case when isfraud = 1 then 1                 else 0 end) as c_fraud_percentage,        sum(case when isfraud = 1 and                      substr(namedest, 1, 1) = 'M' then 1                 else 0 end) * 100 / sum(case when isfraud = 1 then 1                 else 0 end) as m_fraud_percentage FROM   paysim_table.base_data"
what % of frauds leave the new balance of the origin account to 0?,"SELECT count(*) * 100 / (SELECT count(*)                          FROM   paysim_table.base_data                          WHERE  isfraud = 1) as fraud_percentage FROM   paysim_table.base_data WHERE  isfraud = 1    and newbalanceorig = 0;"
what is the % of fraud  is flagged as fraud  ?,SELECT count(*) * 100 / (SELECT count(*)                          FROM   paysim_table.base_data                          WHERE  isfraud = 1) as fraud_percentage FROM   paysim_table.base_data WHERE  isfraud = 1    and isflaggedfraud = 1;
what are amounts of 5 biggest frauds that left the origin account at 0 balance ?,"SELECT amount FROM   paysim_table.base_data WHERE  isfraud = 1    and newbalanceorig = 0 ORDER BY amount desc limit 5;"
what are 5 most grossing movies in IMDB top 1000 ,"SELECT series_title,        gross FROM   imdb.public.movies ORDER BY gross desc limit 5;"
what are the top 5 movies and their ratings basis IMDB rating ? ,"SELECT series_title,        imdb_rating FROM   imdb.public.movies ORDER BY imdb_rating desc limit 5"
which 5 director have the most number of movies in the IMDB top 1000 ? ,"SELECT director,        count(*) as num_of_movies FROM   imdb.public.movies GROUP BY director ORDER BY num_of_movies desc limit 5;"
what are the top 5 movies and their ratings basis IMDB ? ,"SELECT series_title,        imdb_rating FROM   imdb.public.movies ORDER BY imdb_rating desc limit 5"
what is the distribution of imdb top 1000 movies across the release year ?,"SELECT released_year, count(*) as num_movies FROM   imdb.public.movies GROUP BY 1 ORDER BY 1;"
What are the 5 best rated action movies ? ,"SELECT series_title,        imdb_rating FROM   imdb.public.movies WHERE  genre = 'Action' ORDER BY imdb_rating desc limit 5;"
What are the top 2 rated movies of ingmar bergman in drama genre and what are the lead actors in the movies ?,"SELECT series_title,        star1,        imdb_rating FROM   imdb.public.movies WHERE  director = 'Ingmar Bergman'    and genre = 'Drama' ORDER BY imdb_rating desc limit 2;;"
what are the top 5 movies basis IMDB rating ? ,"SELECT series_title FROM IMDB.PUBLIC.MOVIES ORDER BY imdb_rating DESC LIMIT 5"
which 5 director has the most number of movies in the IMDB top 1000 ? ,"``` SELECT director,        count(*) as num_movies FROM   imdb.public.movies WHERE  imdb_rating <= 1000 GROUP BY director ORDER BY num_movies desc limit 5; ```"
what is the average IMDB rating for each genre ? ,"SELECT genre,        avg(imdb_rating) as avg_imdb_rating FROM   imdb.public.movies GROUP BY genre;"
"what is the genre wise, average IMDB rating ? ","SELECT genre,        avg(imdb_rating) as avg_imdb_rating FROM   imdb.public.movies GROUP BY genre;"
"What is the runtime of Forest Gump, Saving Private Ryan and The Green Mile","SELECT series_title,        runtime FROM   imdb.public.movies WHERE  series_title in ('Forrest Gump', 'Saving Private Ryan', 'The Green Mile');"
what is the distribution of titles on IMDB across genres ? ,"SELECT genre,        count(*) as num_titles FROM   imdb.public.movies GROUP BY genre ORDER BY num_titles desc;"
"what are the 10 cities with most churned users in the 0-12 month tenure which have churned due to competitor related issue along with the overall churn percent in that city ? Plot churn % as a line, and the abs chured as a bar "," WITH churn_data AS (   SELECT city,          COUNT(CASE WHEN churn_reason ILIKE '%competitor%' AND customer_status = 'Churned' AND                          tenure_in_months BETWEEN 0 AND 12 THEN customer_id END) AS churned_competitor_users,          COUNT(CASE WHEN customer_status = 'Churned' AND tenure_in_months BETWEEN 0 AND 12 THEN customer_id END) AS churned_users,          COUNT(CASE WHEN tenure_in_months BETWEEN 0 AND 12 THEN customer_id END) AS total_users   FROM cutomer_retention.public.telecom_data   GROUP BY city ) SELECT cd.city,        cd.churned_competitor_users,        cd.total_users,        cd.churned_users,        (cd.churned_users * 100.0 / cd.total_users) AS overall_churn_percent FROM churn_data cd WHERE cd.churned_competitor_users IS NOT NULL ORDER BY cd.churned_competitor_users DESC LIMIT 10;"
do married customers have more number of lines per user ?,"SELECT married,        count(case when multiple_lines = 'Yes' then customer_id                   else null end) *100 / count(customer_id) as multiple_lines_percentage FROM   cutomer_retention.public.telecom_data GROUP BY 1;"
"what 5 cities have the least % of customers using premium tech support, along with the numbers of customers in the city ?","SELECT city,        count(distinct customer_id) as total_customers,        count(distinct case when premium_tech_support = 'Yes' then customer_id                            else null end) * 100.0 / count(distinct customer_id) as percentage_of_users_with_premium_tech_support FROM   cutomer_retention.public.telecom_data WHERE  city is not null GROUP BY city ORDER BY 3 asc limit 5;"
What is the percentage of users with premium tech support in each of the top 10 cities with the most customers,"SELECT city,        count(distinct customer_id) as total_customers,        count(distinct case when premium_tech_support = 'Yes' then customer_id                            else null end) * 100.0 / count(distinct customer_id) as percentage_with_premium_tech_support FROM   telecom_data WHERE  city in (SELECT city                 FROM   telecom_data                 GROUP BY city                 ORDER BY count(distinct customer_id) desc limit 10) GROUP BY 1;"
"what is the percentage of users with premium tech support in the each of top 10 cities with most customers, also give total number of customers.","SELECT city,        count(distinct customer_id) as total_customers,        count(distinct case when premium_tech_support = 'Yes' then customer_id                            else null end) * 100.0 / count(distinct customer_id) as percentage_with_premium_tech_support FROM   telecom_data WHERE  city in (SELECT city                 FROM   telecom_data                 GROUP BY city                 ORDER BY count(distinct customer_id) desc limit 10) GROUP BY 1;"
what is the 5 most popular churn reason across 2 cities with most customers where revenue made is greater than 500 ? ,"with city_names as (SELECT city,                            count(*) as total_customers                     FROM   cutomer_retention.public.telecom_data                     GROUP BY 1                     ORDER BY 2 desc limit 2), city_revenue as (SELECT city,                                                   sum(total_charges) as revenue                                            FROM   cutomer_retention.public.telecom_data                                            GROUP BY city), churn_reasons as (SELECT churn_reason,                                          count(*) as total_churns                                   FROM   cutomer_retention.public.telecom_data                                   WHERE  customer_status = 'Churned'                                      and city in (SELECT city                                                FROM   city_names) and total_charges > 500                                   GROUP BY 1                                   ORDER BY 2 desc limit 5) SELECT cr.churn_reason,        cc.city,        revenue,        count(*) as total_churns FROM   cutomer_retention.public.telecom_data cc     INNER JOIN churn_reasons cr         ON cc.churn_reason = cr.churn_reason     INNER JOIN city_revenue crv         ON cc.city = crv.city WHERE  cc.city in (SELECT city                    FROM   city_names) GROUP BY 1, 2, revenue ORDER BY 4 desc;"
give me the distribution of average revenue per user.,"SELECT width_bucket(total_revenue, 0, 10000, 20) *500 avg_revenue_bucket,        count(*) as user_count FROM   cutomer_retention.public.telecom_data GROUP BY 1 ORDER BY 1"
what is the percentage of users with premium tech support in the each of top 10 cities with most customers ? ,"SELECT city,        count(distinct case when premium_tech_support = 'Yes' then customer_id                            else null end) * 100.0 / count(distinct customer_id) as percentage_of_users_with_premium_tech_support FROM   cutomer_retention.public.telecom_data WHERE  city in (SELECT city                 FROM   cutomer_retention.public.telecom_data                 WHERE  city is not null                 GROUP BY city                 ORDER BY count(distinct customer_id) desc limit 10) GROUP BY city;"
what is the churn % for the users who have greater than 2 referrals v/s those who dont ?  generate a bar chart ,"SELECT case when NUMBER_OF_REFERRALS > 2 then 'Greater than 2 Referrals'             else '2 or Fewer Referrals' end as referral_group,        count(distinct case when customer_status = 'Churned' then customer_id                            else null end) * 100.0 / count(distinct customer_id) as churn_percentage FROM   cutomer_retention.public.telecom_data GROUP BY referral_group"
what are the tenure wise churned churned users. bucket tenure as 6months order them properly,"SELECT concat(floor(tenure_in_months/6) * 6,               '-',               floor(tenure_in_months/6) * 6 + 5) as tenure_range,        count(distinct case when customer_status = 'Churned' then customer_id                            else null end) as churned_users FROM   cutomer_retention.public.telecom_data GROUP BY 1 ORDER BY min(tenure_in_months)"
"what is the percentage of users with premium tech support in the each of top 10 cities with most customers, also give total number of customers? ","SELECT city,        count(distinct customer_id) as total_customers,        count(distinct case when premium_tech_support = 'Yes' then customer_id                            else null end) * 100.0 / count(distinct customer_id) as percentage_of_users_with_premium_tech_support FROM   cutomer_retention.public.telecom_data WHERE  city in (SELECT city                 FROM   cutomer_retention.public.telecom_data                 WHERE  city is not null                 GROUP BY city                 ORDER BY count(distinct customer_id) desc limit 10) GROUP BY city"
"plot churn% basis tenure as a bar chart, divide tenure into 10 buckets as a bar chart","SELECT concat(floor(tenure_in_months/10)*10,               '-',               floor(tenure_in_months/10)*10 + 9) as tenure_range,        count(distinct case when customer_status = 'Churned' then customer_id                            else null end) * 100.0 / count(distinct customer_id) as churn_percentage FROM   cutomer_retention.public.telecom_data GROUP BY 1 ORDER BY 1;"
what are top 5 reasons for churn in the data ? load a bar chart,"SELECT churn_reason,        count(*) as total_churns FROM   cutomer_retention.public.telecom_data WHERE  customer_status = 'Churned' GROUP BY 1 ORDER BY 2 desc limit 5;"
what is the distribution across payment method for the 100 customers with the highest total revenue ,"SELECT payment_method,        count(*) as count FROM   cutomer_retention.public.telecom_data WHERE  customer_id in (SELECT customer_id                        FROM   cutomer_retention.public.telecom_data                        ORDER BY total_charges desc limit 100) GROUP BY payment_method;"
what are the tenure wise churned churned users where churn reason is something related to the competitor. bucket tenure as 6months order them properly,"SELECT concat(floor(tenure_in_months/6) * 6,               '-',               floor(tenure_in_months/6) * 6 + 5) as tenure_range,        count(distinct case when customer_status = 'Churned' and                                 churn_reason like '%competitor%' then customer_id                            else null end) as churned_users FROM   cutomer_retention.public.telecom_data GROUP BY 1 ORDER BY min(tenure_in_months)"
what % of users with revenue less than 1500 have premium tech support ?,SELECT count(distinct case when premium_tech_support = 'Yes' then customer_id                            else null end) * 100.0 / count(distinct customer_id) as percentage_of_users_with_premium_tech_support_for_revenue_less_than_1500 FROM   cutomer_retention.public.telecom_data WHERE  total_revenue < 1500
"plot  churn% basis tenure as a bar chart, divide tenure into 10 buckets.","SELECT concat(floor(tenure_in_months/10)*10,               '-',               (floor(tenure_in_months/10)*10)+9) tenure_range,        count(distinct case when customer_status = 'Churned' then customer_id                            else null end)*100.0/count(distinct customer_id) churn_percentage FROM   cutomer_retention.public.telecom_data GROUP BY 1 ORDER BY 1;"
what is the distribution of churned users across age compared it to stayed users? display as a % total,"SELECT age_group,        round((churned_users*100.0) / (churned_users+stayed_users),              2) as churned_user_percentage,        round((stayed_users*100.0) / (churned_users+stayed_users),              2) as stayed_user_percentage FROM   (SELECT case when age between 18 and                          24 then '18-24'                     when age between 25 and                          34 then '25-34'                     when age between 35 and                          44 then '35-44'                     when age between 45 and                          54 then '45-54'                     when age between 55 and                          64 then '55-64'                     when age >= 65 then '65+'                     else 'Others' end as age_group,                count(distinct case when customer_status = 'Churned' then customer_id                                    else null end) as churned_users,                count(distinct case when customer_status = 'Stayed' then customer_id                                    else null end) as stayed_users         FROM   cutomer_retention.public.telecom_data         GROUP BY 1) t;"
what is the 5 most popular churn reason across 2 cities with most customers where revenue made if great than 500 ? ,"with city_names as (SELECT city,                            count(*) as total_customers                     FROM   cutomer_retention.public.telecom_data                     GROUP BY 1                     ORDER BY 2 desc limit 2) SELECT churn_reason,        count(*) as total_churns FROM   cutomer_retention.public.telecom_data WHERE  city in (SELECT city                 FROM   city_names) and customer_status = 'Churned' and total_charges > 500 GROUP BY 1 ORDER BY 2 desc limit 5"
what are the 3 cities with most churned users in the 0-12 month tenure which have churned due to competitor related issue ?,"SELECT city,        count(*) as total_churned_users FROM   cutomer_retention.public.telecom_data WHERE  churn_reason ilike '%competitor%'    and customer_status = 'Churned'    and tenure_in_months between 0    and 12 GROUP BY 1 ORDER BY 2 desc limit 3;"
what 5 cities have the least % of customers using premium tech support ?,"SELECT city,        count(distinct case when premium_tech_support = 'Yes' then customer_id                            else null end) * 100.0 / count(distinct customer_id) as percentage_of_users_with_premium_tech_support FROM   cutomer_retention.public.telecom_data WHERE  city is not null GROUP BY city ORDER BY 2 asc limit 5;"
do married people stream music and movies more than unmarried people.,"with user_data as (SELECT customer_id,                           married,                           streaming_movies,                           streaming_music                    FROM   cutomer_retention.public.telecom_data) SELECT married,        avg(case when streaming_music = 'Yes' then 1                 else 0 end)*100 as music_streaming_percentage,        avg(case when streaming_movies = 'Yes' then 1                 else 0 end)*100 as movie_streaming_percentage FROM   user_data GROUP BY married;"
what % of users with revenue less than 1500  and with revenue greater than 4000 have premium tech support ? Plot bar chart,"SELECT bucket,        count(distinct case when premium_tech_support = 'Yes' then customer_id                            else null end) * 100.0 / count(distinct customer_id) as percentage_of_users_with_premium_tech_support FROM   (SELECT customer_id,                case when total_revenue < 1500 then 'less than 1500'                     when total_revenue > 4000 then 'greater than 4000' end as bucket,                premium_tech_support         FROM   cutomer_retention.public.telecom_data         WHERE  total_revenue < 1500             or total_revenue > 4000) a GROUP BY bucket"
what are the 10 cities with most churned users in the 0-12 month tenure which have churned due to competitor related issue along with the overall churn percent in that city ?,"with churn_data as (SELECT city,                            count(case when churn_reason ilike '%competitor%' and                                            customer_status = 'Churned' and                                            tenure_in_months between 0 and                                            12 then customer_id end) as churned_competitor_users,                            count(case when customer_status = 'Churned' and                                            tenure_in_months between 0 and                                            12 then customer_id end) as churned_users,                            count(case when tenure_in_months between 0 and                                            12 then customer_id end) as total_users                     FROM   cutomer_retention.public.telecom_data                     GROUP BY city) SELECT cd.city,        cd.churned_competitor_users,        cd.total_users,        cd.churned_users,        cd.churned_users*100.0/cd.total_users as overall_churn_percent FROM   churn_data cd WHERE  cd.churned_competitor_users is not null ORDER BY cd.churned_competitor_users desc limit 10;"
"what is the distribution of revenue per customer  ? make buckets of size 500, a bar chart","SELECT count(*) as customer_count FROM   cutomer_retention.public.telecom_data ORDER BY 1"
give me churn % for each offer ,"SELECT offer,        count(DISTINCT case when customer_status = 'Churned' then customer_id                   else null end)*100.0/count(DISTINCT customer_id) as churn_percentage FROM   cutomer_retention.public.telecom_data t GROUP BY offer;"
"what combination of offer, multiple lines, contract gives me lead to what revenue per user along with their churn % ? ","SELECT offer,        multiple_lines,        contract,        sum(total_charges) / count(distinct customer_id) as revenue_per_user,        count(distinct case when customer_status = 'Churned' then customer_id                            else null end) * 100.0 / count(distinct customer_id) as churn_percentage FROM   cutomer_retention.public.telecom_data GROUP BY offer, multiple_lines, contract ORDER BY revenue_per_user desc;"
what is the %churn basis their payment method ?,"SELECT payment_method,        count(distinct case when customer_status = 'Churned' then customer_id                            else null end) * 100.0 / count(distinct customer_id) as churn_percentage FROM   cutomer_retention.public.telecom_data GROUP BY payment_method;"
what is the 5 most popular churn reason across 2 cities with most customers where the revenue made from the customer is greater than 100 ? ,"with city_names as (SELECT city,                            count(*) as total_customers                     FROM   cutomer_retention.public.telecom_data                     GROUP BY 1                     ORDER BY 2 desc limit 2), city_revenue as (SELECT city,                                                   sum(total_charges) as revenue                                            FROM   cutomer_retention.public.telecom_data                                            GROUP BY city), churn_reasons as (SELECT churn_reason,                                          count(*) as total_churns                                   FROM   cutomer_retention.public.telecom_data                                   WHERE  city in (SELECT city                                                   FROM   city_names) and total_charges > 100 and customer_status = 'Churned'                                   GROUP BY 1                                   ORDER BY 2 desc limit 5) SELECT cr.churn_reason,        cc.city,        revenue,        count(*) as total_churns FROM   cutomer_retention.public.telecom_data cc     INNER JOIN churn_reasons cr         ON cc.churn_reason = cr.churn_reason     INNER JOIN city_revenue crv         ON cc.city = crv.city WHERE  cc.city in (SELECT city                    FROM   city_names) GROUP BY 1, 2, revenue ORDER BY 4 desc;"
what is the % of users who had a refund amount for each customer status ?,"SELECT customer_status,        count(distinct case when total_refunds > 0 then customer_id                            else null end) / count(distinct customer_id) as refund_percentage FROM   cutomer_retention.public.telecom_data GROUP BY customer_status"
give me the distribution of average revenue per user ,"SELECT width_bucket(total_revenue, 0, 10000, 20) avg_revenue_bucket,        count(*) as user_count FROM   cutomer_retention.public.telecom_data GROUP BY 1 ORDER BY 1"
"what is the distribution of revenue per customer  ? make buckets of size 100, load a bar chart","SELECT width_bucket(total_revenue, 0, 10000, 100) * 100 as revenue_range,                   count(*) as customer_count            FROM   cutomer_retention.public.telecom_data            GROUP BY 1            ORDER BY 1"
display 10 rows of the telecom dataset ,"SELECT * FROM cutomer_retention.public.telecom_data limit 10;"
"what is the 5 most popular churn reason across 2 cities with most customers, the churned users must have greater than 500 revenue","with city_names as (SELECT city,                            count(*) as total_customers                     FROM   cutomer_retention.public.telecom_data                     GROUP BY 1                     ORDER BY 2 desc limit 2) SELECT churn_reason,        count(*) as total_churns FROM   cutomer_retention.public.telecom_data cc WHERE  city in (SELECT city                 FROM   city_names) and customer_status = 'Churned' and total_revenue > 500 GROUP BY 1 ORDER BY 2 desc limit 5"
what the 5 zipcodes with most customers and their chrun%,"SELECT zip_code,        count(*) as total_customers,        count(case when customer_status = 'Churned' then customer_id                   else null end)*100.0/count(*) as churn_percentage FROM   cutomer_retention.public.telecom_data WHERE  zip_code is not null GROUP BY zip_code ORDER BY 2 desc limit 5;"
Plot the distribution of total revenue per user ? ,"SELECT total_revenue,        count(*) as user_count FROM   cutomer_retention.public.telecom_data GROUP BY total_revenue ORDER BY total_revenue"
give me churn % for each Internet Connection Type ?,"SELECT internet_type,        count(distinct case when customer_status = 'Churned' then customer_id                            else null end)*100.0/count(distinct customer_id) as churn_percentage FROM   cutomer_retention.public.telecom_data t GROUP BY internet_type;"
what is the most popular churn reason across 2 cities with most customers ? ,"with city_names as  (SELECT city,        count(*) as total_customers FROM   cutomer_retention.public.telecom_data GROUP BY 1 ORDER BY 2 desc limit 2 )  SELECT churn_reason,         COUNT(*) FROM cutomer_retention.public.telecom_data WHERE city in    (    SELECT city     FROM city_names   ) GROUP BY 1  ORDER By 2 DESC "
what is the average revenue per user ,"SELECT avg(total_revenue) as avg_revenue_per_user FROM   cutomer_retention.public.telecom_data;"
what % of customers have churn status as churned ?,"SELECT count(*)*100.0/(SELECT count(*)                        FROM   cutomer_retention.public.telecom_data) as churn_percentage FROM   cutomer_retention.public.telecom_data WHERE  customer_status = 'Churned'; "
what is the distribution across payment method for the 100 customers with the highest total revenue vs overall distribution ,"-- Overall distribution SELECT payment_method,        count(*) as count FROM   cutomer_retention.public.telecom_data GROUP BY payment_method;"
do married people stream music and movies more than unmarried people ?,"with user_data as (SELECT customer_id,                           married,                           streaming_movies,                           streaming_music                    FROM   cutomer_retention.public.telecom_data) SELECT married,        avg(case when streaming_music = 'Yes' then 1                 else 0 end)*100 as music_streaming_percentage,        avg(case when streaming_movies = 'Yes' then 1                 else 0 end)*100 as movie_streaming_percentage FROM   user_data GROUP BY married;"
what are top 5 cities with maximum churned users,"SELECT city,        count(*) as total_churned_users FROM   cutomer_retention.public.telecom_data WHERE  customer_status = 'Churned' GROUP BY city ORDER BY total_churned_users desc limit 5;"
what % of churned users had an extra data charge vs what % of stayed users had an extra charge  ?,"Corrected query:  ``` SELECT customer_status,        COUNT(DISTINCT CASE WHEN total_extra_data_charges > 0 THEN customer_id ELSE NULL END) / COUNT(DISTINCT customer_id) FROM cutomer_retention.public.telecom_data WHERE customer_status IN ('Churned','Stayed') GROUP BY 1 ```   The column name `total_extra_data_charge` was incorrect. It should be `total_extra_data_charges`."
"what is the distribution of revenue per customer, bucket by total revenue at intervals of 500","SELECT width_bucket(total_revenue, 0, 10000, 500) * 500 as revenue_range,        count(*) as customer_count FROM   cutomer_retention.public.telecom_data GROUP BY 1 ORDER BY 1"
what are the 4 biggest churn reasons ?,"SELECT churn_reason,        count(*) FROM   cutomer_retention.public.telecom_data WHERE  customer_status = 'Churned' GROUP BY 1 ORDER BY count(*) desc limit 4;"
"what combination of offer, multiple lines, contract leads to what revenue per user along with their churn % ? ","SELECT offer,        multiple_lines,        contract,        sum(total_charges) / count(distinct customer_id) as revenue_per_user,        count(distinct case when customer_status = 'Churned' then customer_id                            else null end) * 100.0 / count(distinct customer_id) as churn_percentage FROM   cutomer_retention.public.telecom_data GROUP BY offer, multiple_lines, contract ORDER BY revenue_per_user desc;"
what is the distribution across payment method for the 100 customers with the highest total revenue vs overall distribution across the payment methods .,"The corrected SQL query is:  ``` WITH top_100_dist AS (   SELECT customer_id, total_charges   FROM cutomer_retention.public.telecom_data   ORDER BY total_charges DESC    LIMIT 100 ) SELECT 'top_100' AS distribution, payment_method, COUNT(*) AS count FROM cutomer_retention.public.telecom_data a WHERE customer_id IN (SELECT customer_id FROM top_100_dist) GROUP BY 1, 2 UNION SELECT 'overall' AS distribution, payment_method, COUNT(*) AS count FROM cutomer_retention.public.telecom_data a GROUP BY 1, 2;  ```  The error occurred because there was text before the SQL code."
what is the distribution of revenue per customer  ?,"SELECT case when total_revenue < 500 then '500'              when total_revenue >=500 and total_revenue <1000 then '500-999'             when total_revenue >=1000 and total_revenue <1500 then '1000-1499'             when total_revenue >=1500 and total_revenue <2000 then '1500-1999'             when total_revenue >=2000 and total_revenue <2500 then '2000-2499'             when total_revenue >=2500 and total_revenue <3000 then '2500-2999'             when total_revenue >=3000 and total_revenue <3500 then '3000-3499'             else '>=3500' end as rev_bucket,        count(*) as customer_count FROM   cutomer_retention.public.telecom_data GROUP BY 1  ORDER BY 1"
What is the tenure of the users who have churned due to a competitor related issue,"SELECT concat(floor(tenure_in_months/6) * 6,               '-',               floor(tenure_in_months/6) * 6 + 5) as tenure_range,        count(distinct case when churn_reason ilike '%competitor%' and                                 customer_status = 'Churned' then customer_id                            else null end) as churned_users FROM   cutomer_retention.public.telecom_data GROUP BY 1 ORDER BY min(tenure_in_months) "
What are the tenure wise churned users where churn reason is related to the competitor. ,"SELECT concat(floor(tenure_in_months/6) * 6,               '-',               floor(tenure_in_months/6) * 6 + 5) as tenure_range,        count(distinct case when churn_reason ilike '%competitor%' and                                 customer_status = 'Churned' then customer_id                            else null end) as churned_users FROM   cutomer_retention.public.telecom_data GROUP BY 1 ORDER BY min(tenure_in_months)"
which 5 cities have the highest churned users due to attitude of customer support ?,"SELECT city,        count(*) as total_churned_users FROM   cutomer_retention.public.telecom_data WHERE  churn_reason = 'Attitude of support person'    and customer_status = 'Churned' GROUP BY 1 ORDER BY 2 desc limit 5;"
what is the distribution of churned users across age ? ,"SELECT case when age between 18 and                  24 then '18-24'             when age between 25 and                  34 then '25-34'             when age between 35 and                  44 then '35-44'             when age between 45 and                  54 then '45-54'             when age between 55 and                  64 then '55-64'             when age >= 65 then '65+'             else 'Others' end as age_group,        count(case when customer_status = 'Churned' then customer_id                   else null end) as churned_users FROM   cutomer_retention.public.telecom_data GROUP BY 1;"
"plot  churn% basis tenure as a bar chart, divide tenure into 10 buckets ","SELECT concat(floor(tenure_in_months/ 10) * 10,               '-',               floor(tenure_in_months/ 10) * 10 + 9) as tenure_range,        count(distinct case when customer_status = 'Churned' then customer_id                            else null end) * 100.0 / count(distinct customer_id) as churn_percentage FROM   cutomer_retention.public.telecom_data GROUP BY 1 ORDER BY 1"
what are the 10 cities with most churned users in the 012 month tenure which have churned due to competitor related issues along with the overall churn percent in that city?,"with churn_data as  ( SELECT city,         count(case when churn_reason ilike '%competitor%' and                customer_status = 'Churned' and tenure_in_months between 0 and 12 then    customer_id end) as churned_competitor_users,          count(case when customer_status = 'Churned' and                tenure_in_months between 0 and 12 then customer_id end) as churned_users,          count(case when tenure_in_months between 0 and 12 then customer_id end) as total_users                      FROM   cutomer_retention.public.telecom_data GROUP BY city )     SELECT cd.city,        cd.churned_competitor_users,        cd.total_users,        cd.churned_users,        (cd.churned_users * 100.0 / cd.total_users) as overall_churn_percent,        (cd.churned_competitor_users * 100.0 / cd.churned_users) as churned_competitor_percent FROM   churn_data cd WHERE  cd.churned_competitor_users is not null ORDER BY cd.churned_competitor_users desc limit 10; "
what is the churn % for the customers who a phone service v/s those who dont ?,"SELECT phone_service,        count(distinct case when customer_status = 'Churned' then customer_id                            else null end) * 100.0 / count(distinct customer_id) as churn_percentage FROM   cutomer_retention.public.telecom_data GROUP BY phone_service"
what are the 10 cities with most churned users in the 0-12 month tenure which have churned due to competitor related issue ?,"SELECT city,        count(*) as total_churned_users FROM   cutomer_retention.public.telecom_data WHERE  churn_reason ilike '%competitor%'    and customer_status = 'Churned'    and tenure_in_months between 0    and 12 GROUP BY 1 ORDER BY 2 desc limit 10;"
what % of customers with dependants have multiple lines  v/s those who don't have ? ,"SELECT case when number_of_dependents > 0 then 'Has dependants' else 'No dependants' end as cohort,        count(distinct case when multiple_lines = 'Yes' then customer_id                            else null end) * 100.0 / count(distinct customer_id) as multiple_lines_percentage FROM   cutomer_retention.public.telecom_data GROUP BY cohort;"
"what is the 5 most popular churn reason across 2 cities with most customers, the churned users must have greater than 100 revenue","with city_names as (SELECT city,                            count(*) as total_customers                     FROM   cutomer_retention.public.telecom_data                     GROUP BY 1                     ORDER BY 2 desc limit 2                     )  SELECT churn_reason,        count(*) as total_churns FROM   cutomer_retention.public.telecom_data cc WHERE  city in (SELECT city                 FROM   city_names) and customer_status = 'Churned' and total_revenue > 100 GROUP BY 1 ORDER BY 2 desc limit 5"
what is the churn% across males and females ?,"SELECT gender,        count(case when customer_status = 'Churned' then customer_id else null end)*100.0/count(*) as churn_percentage FROM   cutomer_retention.public.telecom_data t GROUP BY gender;"
"What % of users with less than 1500, and revenue greater than 4000 have premium tech support respectively ?","SELECT bucket,        count(distinct case when premium_tech_support = 'Yes' then customer_id                            else null end) * 100.0 / count(distinct customer_id) as percentage_of_users_with_premium_tech_support FROM   (SELECT customer_id,                case when total_revenue < 1500 then 'less than 1500'                     when total_revenue > 4000 then 'greater than 4000' end as bucket,                premium_tech_support         FROM   cutomer_retention.public.telecom_data         WHERE  total_revenue < 1500             or total_revenue > 4000) a GROUP BY bucket "
What is the tenure of the users who have churned due to a competitor related issue.,"SELECT concat(floor(tenure_in_months/6) * 6,               '-',               floor(tenure_in_months/6) * 6 + 5) as tenure_range,        count(distinct case when churn_reason ilike '%competitor%' and                                 customer_status = 'Churned' then customer_id                            else null end) as churned_users FROM   cutomer_retention.public.telecom_data GROUP BY 1 ORDER BY min(tenure_in_months)"
"what are average, median, and 95th percentile monthly charges for churned users v/s stayed users  ?","SELECT customer_status,        avg(monthly_charge) as avg_monthly_charges,        percentile_cont(0.5) within group (ORDER BY monthly_charge) as median_monthly_charges,        percentile_cont(0.95) within group (ORDER BY monthly_charge) as percentile_95_monthly_charges FROM   cutomer_retention.public.telecom_data WHERE  monthly_charge is not null GROUP BY customer_status"
what is the 5 most popular churn reason across 2 cities with most customers ? ,"with city_names as (SELECT city,                            count(*) as total_customers                     FROM   cutomer_retention.public.telecom_data                     GROUP BY 1                     ORDER BY 2 desc limit 2) SELECT churn_reason,        count(*) as total_churns FROM   cutomer_retention.public.telecom_data WHERE  city in (SELECT city                 FROM   city_names) and customer_status = 'Churned' GROUP BY 1 ORDER BY 2 desc limit 5"
what is the churn % for the customers who have a tenure of greater than 12 months and those who have a tenure of less than 12 months ?,"SELECT case when tenure_in_months > 12 then 'Greater than 12 months'             else 'Less than 12 months' end as tenure_group,        count(distinct case when customer_status = 'Churned' then customer_id                            else null end) * 100.0 / count(distinct customer_id) as churn_percentage FROM   cutomer_retention.public.telecom_data GROUP BY tenure_group"
Which are the top 10 cities with the highest number and percentage of users with less than 12 months who churned due to a competitor?,"with churn_data as (SELECT city,                            count(case when churn_reason ilike '%competitor%' and                                            customer_status = 'Churned' and                                            tenure_in_months between 0 and                                            12 then customer_id end) as churned_competitor_users,                            count(case when customer_status = 'Churned' and                                            tenure_in_months between 0 and                                            12 then customer_id end) as churned_users,                            count(case when tenure_in_months between 0 and                                            12 then customer_id end) as total_users                     FROM   cutomer_retention.public.telecom_data                     GROUP BY city) SELECT cd.city,        cd.churned_competitor_users,        cd.total_users,        cd.churned_users,        (cd.churned_users * 100.0 / cd.total_users) as overall_churn_percent,        (cd.churned_competitor_users * 100.0 / cd.churned_users) as churned_competitor_percent FROM   churn_data cd WHERE  cd.churned_competitor_users is not null ORDER BY cd.churned_competitor_users desc limit 10;"
what are the top 5 reasons for churn of customers ? ,"SELECT churn_reason,        count(*) as total_churns FROM   cutomer_retention.public.telecom_data WHERE  customer_status = 'Churned' GROUP BY 1 ORDER BY 2 desc limit 5;"
what are the tenure wise churned churned users. bucket tenure as 6months ,"SELECT concat(floor(tenure_in_months/ 6) * 6,               '-',               floor(tenure_in_months/ 6) * 6 + 5) as tenure_range,        count(distinct case when customer_status = 'Churned' then customer_id                            else null end) as churned_users FROM   cutomer_retention.public.telecom_data GROUP BY 1 ORDER BY 1"
what are the 4 biggest churn categories ?,"SELECT churn_category,        count(*) FROM   cutomer_retention.public.telecom_data WHERE  customer_status = 'Churned' GROUP BY 1 ORDER BY count(*) desc limit 4;"
what % of users with revenue less than 1500  and with revenue greater than 4000 have premium tech support ?,"SELECT bucket,        count(distinct case when premium_tech_support = 'Yes' then customer_id                            else null end) * 100.0 / count(distinct customer_id) as percentage_of_users_with_premium_tech_support FROM   (SELECT customer_id,                case when total_revenue < 1500 then 'less than 1500'                     when total_revenue > 4000 then 'greater than 4000' end as bucket,                premium_tech_support         FROM   cutomer_retention.public.telecom_data         WHERE  total_revenue < 1500             or total_revenue > 4000) a GROUP BY bucket"
what is the distribution across payment method for the 100 customers with the highest total revenue vs overall distribution across the payment methods ,"Here's the corrected SQL query:  ``` -- Overall distribution WITH top_100_dist AS (   SELECT customer_id, total_revenue   FROM cutomer_retention.public.telecom_data   ORDER BY 2 DESC    LIMIT 100 ) SELECT 'top_100', payment_method, count(*) AS count FROM cutomer_retention.public.telecom_data a  WHERE customer_id IN (SELECT customer_id FROM top_100_dist) GROUP BY 1,2 UNION  SELECT 'overall', payment_method, count(*) AS count FROM cutomer_retention.public.telecom_data a  GROUP BY 1,2 ```   I replaced `user_id` with `customer_id` in the `WHERE` clause of the first `SELECT` statement because the `customer_id` is the column being selected in the `WITH` clause."
which city has the highest churned users due to attitude of customer support ?,"SELECT city,        count(*) as total_churned_users FROM   cutomer_retention.public.telecom_data WHERE  churn_reason = 'Attitude of support person'    and customer_status = 'Churned' GROUP BY 1 ORDER BY 2 desc limit 1;"
What are the top 5 reasons for churn of customers ?,"SELECT churn_reason,        count(*) as total_churns FROM   public.telecom_data WHERE  customer_status = 'Churned' GROUP BY churn_reason ORDER BY total_churns desc limit 5;"
what are the 2 biggest churn categories ?,"SELECT churn_category,        count(*) FROM   cutomer_retention.public.telecom_data WHERE  customer_status = 'Churned' GROUP BY 1 limit 2;"
what is the distribution of churned users across age compared it to stayed users?,"SELECT age_group,        churned_users,        stayed_users FROM   (SELECT case when age between 18 and                          24 then '18-24'                     when age between 25 and                          34 then '25-34'                     when age between 35 and                          44 then '35-44'                     when age between 45 and                          54 then '45-54'                     when age between 55 and                          64 then '55-64'                     when age >= 65 then '65+'                     else 'Others' end as age_group,                count(distinct case when customer_status = 'Churned' then customer_id                                    else null end) as churned_users,                count(distinct case when customer_status = 'Stayed' then customer_id                                    else null end) as stayed_users         FROM   cutomer_retention.public.telecom_data         GROUP BY 1) t"
what is the distribution of churned users across age compared it to stayed users? ,"SELECT age_group,        churned_users,        stayed_users FROM   (SELECT case when age between 18 and                          24 then '18-24'                     when age between 25 and                          34 then '25-34'                     when age between 35 and                          44 then '35-44'                     when age between 45 and                          54 then '45-54'                     when age between 55 and                          64 then '55-64'                     when age >= 65 then '65+'                     else 'Others' end as age_group,                count(distinct case when customer_status = 'Churned' then customer_id                                    else null end) as churned_users,                count(distinct case when customer_status = 'Stayed' then customer_id                                    else null end) as stayed_users         FROM   cutomer_retention.public.telecom_data         GROUP BY 1) t"
do married customers have more number of lines per user ,"SELECT married,        COUNT(case when multiple_lines = 'Yes' then customer_id else null end) *100 / COUNT(customer_id) as multiple_lines_percentage FROM   cutomer_retention.public.telecom_data GROUP BY 1;"
"plot  churn% basis tenure as a bar chart, divide tenure into 10 buckets as a bar chart. ","SELECT concat(floor(tenure_in_months / 10) * 10,               '-',               floor(tenure_in_months / 10) * 10 + 9) as tenure_range,        count(distinct case when customer_status = 'Churned' then customer_id                            else null end) * 100.0 / count(distinct customer_id) as churn_percentage FROM   cutomer_retention.public.telecom_data GROUP BY 1 ORDER BY tenure_range;"
does premium tech support lead to lesser churn %,"SELECT premium_tech_support,        count(distinct case when customer_status = 'Churned' then customer_id                            else null end) * 100.0 / count(distinct customer_id) as churn_percentage FROM   cutomer_retention.public.telecom_data GROUP BY 1"
"what is the distribution of revenue per customer  ? make buckets of size 500, load a bar chart","SELECT width_bucket(total_revenue, 0, 10000, 500) * 500 as revenue_range,        count(*) as customer_count FROM   cutomer_retention.public.telecom_data GROUP BY 1 ORDER BY 1"
what is the distribution of revenue per customer  ? make buckets of size 100,"SELECT width_bucket(total_revenue, 0, 10000, 100) * 100 as revenue_range,        count(*) as customer_count FROM   cutomer_retention.public.telecom_data GROUP BY 1 ORDER BY 1"
what combination of premium tech support and unlimited data leads to what % of churn,"SELECT premium_tech_support,        unlimited_data,        count(case when customer_status = 'Churned' then customer_id                   else null end)*100.0/count(*) as churn_percentage FROM   cutomer_retention.public.telecom_data t GROUP BY premium_tech_support, unlimited_data;"
Question 2: What is the tenure of the users who have churned due to a Competitor related issue. ,"SELECT concat(floor(tenure_in_months/6) * 6,'-',              floor(tenure_in_months/6) * 6 + 5) as tenure_range,        count(distinct case when churn_reason ilike '%competitor%' and  customer_status ilike '%churn%' then customer_id         else null end) as churned_users FROM   cutomer_retention.public.telecom_data GROUP BY 1 ORDER BY min(tenure_in_months) "
what are top 5 reasons for churn in the data ?,"SELECT churn_reason,        count(*) as total_churns FROM   cutomer_retention.public.telecom_data WHERE  customer_status = 'Churned' GROUP BY 1 ORDER BY 2 desc limit 5;"
"plot tenure wise churn% as a bar chart, divide tenure into 10 buckets","SELECT concat(floor(tenure_in_months/ 10) * 10,               '-',               floor(tenure_in_months/ 10) * 10 + 9) as tenure_range,        count(distinct case when customer_status = 'Churned' then customer_id                            else null end) * 100.0 / count(distinct customer_id) as churn_percentage FROM   cutomer_retention.public.telecom_data GROUP BY 1 ORDER BY 1"
"what are the 10 cities with most churned users in the 0-12 month tenure which have churned due to competitor related issue along with the overall churn percent in that city ? Plot churn % as a line, and the abs chured as a bar.","with churn_data as (SELECT city,                            count(case when churn_reason ilike '%competitor%' and                                            customer_status = 'Churned' and                                            tenure_in_months between 0 and                                            12 then customer_id end) as churned_competitor_users,                            count(case when customer_status = 'Churned' and                                            tenure_in_months between 0 and                                            12 then customer_id end) as churned_users,                            count(case when tenure_in_months between 0 and                                            12 then customer_id end) as total_users                     FROM   cutomer_retention.public.telecom_data                     GROUP BY city) SELECT cd.city,        cd.churned_competitor_users,        cd.total_users,        cd.churned_users,        (cd.churned_users * 100.0 / cd.total_users) as overall_churn_percent FROM   churn_data cd WHERE  cd.churned_competitor_users is not null ORDER BY cd.churned_competitor_users desc limit 10"
What is the distribution offers have we given to the users with revenue less than 1500  v/s those for revenue more than 4000.,"with revenue as (SELECT customer_id,                         case when total_revenue  < 1500 then 'Less than 1500'                              when total_revenue  >= 1500 and total_revenue <= 4000 then '1500-4000'                              when total_revenue  >4000  then '>4000' end as bucket                   FROM                            cutomer_retention.public.telecom_data                  ) SELECT offer,        bucket,        count(*) as count FROM   cutomer_retention.public.telecom_data a LEFT JOIN revenue b  on a.customer_id = b.customer_id  GROUP BY offer, bucket ORDER BY count desc;"
Hey Vanna! What is the distribution of average revenue per user  ? ,"SELECT width_bucket(total_revenue, 0, 10000, 20) *500 avg_revenue_bucket,        count(*) as user_count FROM   cutomer_retention.public.telecom_data GROUP BY 1 ORDER BY 1"
what the 10 zipcodes with most customers and their churn%,"SELECT zip_code,        count(*) as total_customers,        count(case when customer_status = 'Churned' then customer_id                   else null end)*100.0/count(*) as churn_percentage FROM   cutomer_retention.public.telecom_data WHERE  zip_code is not null GROUP BY zip_code ORDER BY 2 desc limit 10;"
what is the average revenue per customer ?,"SELECT avg(total_revenue) as avg_revenue_per_customer FROM   cutomer_retention.public.telecom_data;"
what are the tenure wise churned users where churn reason is something related to the competitor. bucket tenure as 6months order them properly,"SELECT concat(floor(tenure_in_months/6) * 6,               '-',               floor(tenure_in_months/6) * 6 + 5) as tenure_range,        count(distinct case when churn_reason ilike '%competitor%' and                                 customer_status = 'Churned' then customer_id                            else null end) as churned_users FROM   cutomer_retention.public.telecom_data GROUP BY 1 ORDER BY min(tenure_in_months)"
what 5 cities have the maximum  churn rate ?,"SELECT city,        count(*),        count(case when customer_status = 'Churned' then customer_id else null end)/ count(*) as churn_percentage FROM   cutomer_retention.public.telecom_data WHERE  city is not null GROUP BY city ORDER BY churn_percentage desc limit 5;"
what is the % of users who had a refund amount &gt0 for each customer status ?,"SELECT customer_status,        count(distinct case when total_refunds > 0 then customer_id                            else null end) / count(distinct customer_id) as refund_percentage FROM   cutomer_retention.public.telecom_data GROUP BY customer_status"
"what combination of offer, multiple lines, contract gives me the most revenue per user ? ","SELECT offer,        multiple_lines,        contract,        sum(total_charges) / count(distinct customer_id) as revenue_per_user FROM   cutomer_retention.public.telecom_data GROUP BY offer, multiple_lines, contract ORDER BY revenue_per_user desc limit 1;"
Hey Vanna! Find me the average revenue per user ?,SELECT avg(total_revenue) as avg_revenue_per_user FROM   cutomer_retention.public.telecom_data;
what is the % of married people v/s the % of unmarried people who stream music ,"SELECT married,        count(case when streaming_music = 'Yes' then customer_id                   else null end) * 100.0 / count(customer_id) as streaming_music_percentage FROM   cutomer_retention.public.telecom_data GROUP BY married;"
Plot the distribution of total revenue per user using 10 deciles? ,"SELECT ntile(10) OVER (ORDER BY total_revenue) as revenue_decile,        sum(total_revenue) as total_revenue_per_user FROM   cutomer_retention.public.telecom_data GROUP BY total_revenue"
"What is the engineer to product manager ratio in Facebook, Amazon, Google ? ","SELECT company,        count(case when title like '%Engineer%' then 1                   else null end) as engineer_count,        count(case when title like '%Product Manager%' then 1                   else null end) as product_manager_count,        count(case when title like '%Engineer%' then 1                   else null end) / count(case when title like '%Product Manager%' then 1                   else null end) as ratio FROM   salaries_data WHERE  company in ('Facebook', 'Amazon', 'Google') GROUP BY company;"
Which 3 cities has the highest average salary for software engineers at Google ? ,"SELECT location,        avg(totalyearlycompensation) as average_salary FROM   salaries_data WHERE  company = 'Google'    and title like '%Software Engineer%' GROUP BY location ORDER BY average_salary desc limit 3;"
Which is the top 4 most common level of software engineers at amazon ?,"SELECT level,        count(*) as count_employees FROM   salaries_data WHERE  company = 'Amazon'    and title like '%Software Engineer%' GROUP BY level ORDER BY count_employees desc limit 4;"
what is the most compensated title related to software engineering at Google ?,"SELECT title,        max(totalyearlycompensation) as max_compensation FROM   salaries_data WHERE  company = 'Google'    and title like '%Software Engineer%' GROUP BY title ORDER BY max_compensation desc limit 1;"
What is average total years of experience related to the 5 most popular job titles?,"SELECT title,        avg(yearsofexperience) as average_years_of_experience FROM   salaries_data WHERE  title in (SELECT title                  FROM   (SELECT title,                                 count(*) as title_count                          FROM   salaries_data                          GROUP BY title                          ORDER BY title_count desc limit 5)) GROUP BY title;"
What 5 companies have the highest average total compensation salaries in the top 25 employers?,"SELECT company,        avg(totalyearlycompensation) as average_compensation FROM   salaries_data WHERE  company in (SELECT company                    FROM   salaries_data                    GROUP BY company                    ORDER BY count(*) desc limit 25) GROUP BY company ORDER BY average_compensation desc limit 5;"
What company has the most analysts in the top 50 employers ?,"SELECT company,        count(*) as analyst_count FROM   salaries_data WHERE  title ilike '%Analyst%'    and company in (SELECT company                 FROM   salaries_data                 GROUP BY company                 ORDER BY count(*) desc limit 50) GROUP BY company ORDER BY analyst_count desc limit 1;"
what are 10 common designation for employees ? ,"SELECT title,        count(*) as count_employees FROM   salaries_Data GROUP BY 1 ORDER BY count_employees desc limit 10;"
What is average total years of experience related to the 5 most popular job titles  ? Load bar chart,"Apologies, but I'm unable to assist."
Which 5 company has the highest avg stock value grants among the top 40 employers? ,"SELECT company,        avg(stockgrantvalue) as average_stock_value FROM   salaries_data WHERE  company in (SELECT company                    FROM   salaries_data                    GROUP BY company                    ORDER BY count(*) desc limit 40) GROUP BY company ORDER BY average_stock_value desc limit 5;"
"which 7 companies have the highest % of asians  employees, in the top 20 employers by size ? Draw bar chart ","SELECT company,        count(case when race = 'Asian' then 1                   else null end) * 100.0 / count(*) as asian_percentage FROM   salaries_data WHERE  company in (SELECT company                    FROM   salaries_data                    GROUP BY company                    ORDER BY count(*) desc limit 20) GROUP BY company ORDER BY asian_percentage desc limit 7;"
compare the spearman's correlation between yearsofexperience and basesalary and yearsatcompany and basesalary ,"The corrected SQL query is:  ``` SELECT corr(rank_experience, rank_salary) as spearman_correlation_experience_salary,        corr(rank_years, rank_salary) as spearman_correlation_years_salary FROM (   SELECT yearsofexperience,          basesalary,          yearsatcompany,          RANK() OVER (ORDER BY yearsofexperience) as rank_experience,          RANK() OVER (ORDER BY basesalary) as rank_salary,          RANK() OVER (ORDER BY yearsatcompany) as rank_years   FROM salaries_data ) subquery; ```  The error occurred because the query was starting with ""Spearman's correlation is not directly available in SQL."" This text is not valid SQL syntax and should be removed."
"What % of amazon engineers have a doctorate , master or a bachelors degree ? ","SELECT case when doctorate_degree = 1 then 'Doctorate Degree'             when masters_degree = 1 then 'Master''s Degree'             when bachelors_degree = 1 then 'Bachelor''s Degree'             else 'Other' end as education_level,        avg(totalyearlycompensation) as average_compensation FROM   salaries_data GROUP BY education_level;"
"what is the avg compensation of a doctorate, a bachelor's and a master's employee ","SELECT case when doctorate_degree = 1 then 'A. Doctorate Degree'             when masters_degree = 1 and doctorate_degree = 0 then 'B. Masters Degree'              when bachelors_degree = 1 and masters_degree = 0 and doctorate_degree= 0 then 'C. Bachelors Degree'              else ' D. Others' end as education_level,        avg(totalyearlycompensation) as average_compensation FROM   salaries_data GROUP BY 1;"
What are the total number of companies in the data ?,SELECT count(distinct company) as total_companies FROM   salaries_data;
Which 3 cities have the highest average salary for a software engineers at Google? ,"SELECT location,        avg(totalyearlycompensation) as average_salary FROM   salaries_data WHERE  company = 'Google'    and title like '%Software Engineer%' GROUP BY location ORDER BY average_salary desc limit 3;"
"compare the correlation coefficient of yearsofexperience, yearsatcompany with total compensation ","SELECT corr(yearsofexperience,             totalyearlycompensation) as correlation_experience_compensation,        corr(yearsatcompany, totalyearlycompensation) as correlation_years_compensation FROM   salaries_data;"
what are different tags in the data ?,"SELECT DISTINCT tag FROM   salaries_data;"
what 3 locations have the highest avg yearly compensation at Apple for Software Engineers?,"SELECT location,        avg(totalyearlycompensation) as average_compensation FROM   salaries_data WHERE  company = 'Apple'    and title = 'Software Engineer' GROUP BY location ORDER BY average_compensation desc limit 3;"
what are count of asian vs no asians in the data ,"SELECT race_asian, COUNT(*) as count_asian FROM   salaries_data GROUP By 1 "
"Which 7 companies have the highest % of asians  employees, in the top 20 employers by size?","SELECT company,        count(case when race = 'Asian' then 1                   else null end) * 100.0 / count(*) as asian_percentage FROM   salaries_data WHERE  company in (SELECT company                    FROM   salaries_data                    GROUP BY company                    ORDER BY count(*) desc limit 20) GROUP BY company ORDER BY asian_percentage desc limit 7;"
compare the correlation between years of experience and base salary and years at company and basesalary ,"SELECT corr(yearsofexperience, basesalary) as correlation_experience_salary,        corr(yearsatcompany, basesalary) as correlation_years_salary FROM   salaries_data;"
"What is the engineer to product manager ratio in Facebook, Amazon and Google?","SELECT company,        count(case when title like '%Engineer%' then 1                   else null end) as engineer_count,        count(case when title like '%Product Manager%' then 1                   else null end) as product_manager_count,        count(case when title like '%Engineer%' then 1                   else null end) / count(case when title like '%Product Manager%' then 1                   else null end) as ratio FROM   salaries_data WHERE  company in ('Facebook', 'Amazon', 'Google') GROUP BY company;"
Which 4 locations have the most employees ?,"SELECT location,        count(*) as employee_count FROM   salaries_data GROUP BY location ORDER BY employee_count desc limit 4;"
what 5 companies have the highest average base salaries ?,"SELECT company,        avg(basesalary) as average_salary FROM   salaries_data GROUP BY company ORDER BY average_salary desc limit 5;"
what are different levels related to software engineering roles at apple ?,"SELECT DISTINCT level FROM   salaries_data WHERE  company = 'Apple'    and title ilike '%Software%';"
Which is the most common level of software engineers at amazon ,"SELECT level,        count(*) as count_employees FROM   salaries_data WHERE  company = 'Amazon'    and title like '%Software Engineer%' GROUP BY level ORDER BY count_employees desc limit 1;"
Which 3 cities have the highest average salary for software engineers at Google ? ,"SELECT location,        avg(totalyearlycompensation) as average_salary FROM   salaries_data WHERE  company = 'Google'    and title like '%Software Engineer%' GROUP BY location ORDER BY average_salary desc limit 3;"
what are top 4 biggest employers ? ,"SELECT company,        count(*) as employee_count FROM   salaries_data GROUP BY company ORDER BY employee_count desc limit 4;"
Which 5 company has the highest avg stock value grants among the top 25 employers? Load suitable bar chart,"SELECT company,        avg(stockgrantvalue) as average_stock_value FROM   salaries_data WHERE  company in (SELECT company                    FROM   salaries_data                    GROUP BY company                    ORDER BY count(*) desc limit 25) GROUP BY company ORDER BY average_stock_value desc limit 5;"
"How much do employees with a bachelor's, master's, and doctorate earn on average respectively? ","SELECT case when doctorate_degree = 1 then 'Doctorate Degree'             when masters_degree = 1 then 'Master''s Degree'             when bachelors_degree = 1 then 'Bachelor''s Degree'             else 'Other' end as education_level,        avg(totalyearlycompensation) as average_compensation FROM   salaries_data GROUP BY education_level;"
Which is the top 4 most common level of software engineers and their median salary at amazon ?,"SELECT level,        COUNT(*),        median(totalyearlycompensation) as median_salary FROM   salaries_data WHERE level in      (SELECT level     FROM salaries_data     WHERE company = 'Amazon'     GROUP BY level     ORDER BY COUNT(*) DESC     LIMIT 4)    and title like '%Software Engineer%' GROUP BY level ORDER BY median_salary desc LIMIT 4;"
What is average total years of experience related to the 5 most popular titles?,"SELECT title,        avg(yearsofexperience) as average_years_of_experience FROM   salaries_data WHERE  title in (SELECT title                  FROM   (SELECT title,                                 count(*) as title_count                          FROM   salaries_data                          GROUP BY title                          ORDER BY title_count desc limit 5)) GROUP BY title;"
what are count of masters degree holders v/s non masters ,"SELECT masters_degree,        count(*) as count_education FROM   salaries_data GROUP BY 1;"
"What is  the correlation coefficient of yearsofexperience, yearsatcompany with total compensation ","SELECT corr(yearsofexperience,             totalyearlycompensation) as correlation_experience_compensation,        corr(yearsatcompany, totalyearlycompensation) as correlation_years_compensation FROM   salaries_data;"
what are count of hispanic and non hispanic people in the data ,"SELECT race_hispanic,        count(*) as count_hispanic FROM   salaries_data GROUP BY 1;"
"which 7 companies have the highest % of asians  employees, in the top 5 employers by size ?","SELECT company,        count(case when race = 'Asian' then 1                   else null end) * 100.0 / count(*) as asian_percentage FROM   salaries_data WHERE  company in (SELECT company                    FROM   salaries_data                    GROUP BY company                    ORDER BY count(*) desc limit 5) GROUP BY company ORDER BY asian_percentage desc limit 7;"
compare the pearson's correlation between yearsofexperience and basesalary and yearsatcompany and basesalary ,"SELECT corr(yearsofexperience, basesalary) as correlation_experience_salary,        corr(yearsatcompany, basesalary) as correlation_years_salary FROM   salaries_data;"
what 3 locations have the highest avg yearly compensation at Apple for Software Engineers ?,"SELECT location,        avg(totalyearlycompensation) as average_compensation FROM   salaries_data WHERE  company = 'Apple'    and title = 'Software Engineer' GROUP BY location ORDER BY average_compensation desc limit 3;"
what location has the highest avg yearly compensation at Apple for Software Engineers ?,"SELECT location,        avg(totalyearlycompensation) as average_compensation FROM   salaries_data WHERE  company = 'Apple'    and title = 'Software Engineer' GROUP BY location ORDER BY average_compensation desc limit 1;"
What is the avg compensation of employees basis their race ? ,"SELECT race,        avg(totalyearlycompensation) as average_compensation FROM   salaries_data GROUP BY race;"
What 5 companies have the highest average total compensation salaries ?,"SELECT company,        avg(totalyearlycompensation) as average_compensation FROM   salaries_data GROUP BY company ORDER BY average_compensation desc limit 5;"
"what 3 most compensated employees in the data, what are their roles, companies, and locations  ?","SELECT         title,        company,        location,        totalyearlycompensation FROM   salaries_data ORDER BY totalyearlycompensation desc limit 3;"
Which company ahs the highest stock value grants among the top 25 employers ?,"SELECT company,        avg(stockgrantvalue) as total_stock_value FROM   salaries_data WHERE  company in (SELECT company                    FROM   salaries_data                    GROUP BY company                    ORDER BY count(*) desc limit 25) GROUP BY company ORDER BY total_stock_value desc limit 1;"
What is the % of employees having a master's degree basis their race ? ,"SELECT race,        count(case when masters_degree = 1 then 1                   else null end) * 100.0 / count(*) as percentage_masters FROM   salaries_data GROUP BY race;"
what 3 most compensated title related to software engineering at Google ?,"SELECT title,        max(totalyearlycompensation) as max_compensation FROM   salaries_data WHERE  company = 'Google'    and title like '%Software Engineer%' GROUP BY title ORDER BY max_compensation desc limit 3;"
"what are different levels related to software engineering roles at apple, along with number of employees  ?","SELECT level,        count(*) as count_employees FROM   salaries_data WHERE  company = 'Apple'    and title like '%Software Engineer%' GROUP BY level ORDER BY count_employees DESC;"
"which 7 companies have the highest % of asians  employees, in the top 20 employers by size ?","SELECT company,        count(case when race = 'Asian' then 1                   else null end) * 100.0 / count(*) as asian_percentage FROM   salaries_data WHERE  company in (SELECT company                    FROM   salaries_data                    GROUP BY company                    ORDER BY count(*) desc limit 20) GROUP BY company ORDER BY asian_percentage desc limit 7;"
Which 5 company has the highest avg stock value grants among the top 25 employers ?,"SELECT company,        avg(stockgrantvalue) as average_stock_value FROM   salaries_data WHERE  company in (SELECT company                    FROM   salaries_data                    GROUP BY company                    ORDER BY count(*) desc limit 25) GROUP BY company ORDER BY average_stock_value desc limit 5;"
"which 2 companies have the highest % of asians  employees, in the top 5 employers by size ?","SELECT company,        count(case when race = 'Asian' then 1                   else null end) * 100.0 / count(*) as asian_percentage FROM   salaries_data WHERE  company in (SELECT company                    FROM   salaries_data                    GROUP BY company                    ORDER BY count(*) desc limit 5) GROUP BY company ORDER BY asian_percentage desc limit 2;"
What is average total years of experience related to the 5 most popular job titles  ?,"SELECT title,        avg(yearsofexperience) as average_years_of_experience FROM   salaries_data WHERE  title in (SELECT title                  FROM   (SELECT title,                                 count(*) as title_count                          FROM   salaries_data                          GROUP BY title                          ORDER BY title_count desc limit 5)) GROUP BY title;"
Which location have the most employees ?,"SELECT location,        count(*) as employee_count FROM   salaries_data GROUP BY location ORDER BY employee_count desc limit 1;"
What is average total years of experience related to the 5 most popular job titles ?,"SELECT title,        ROUND(avg(yearsofexperience),2) as average_years_of_experience FROM   salaries_data WHERE  title in (SELECT title                  FROM   (SELECT title,                                 count(*) as title_count                          FROM   salaries_data                          GROUP BY title                          ORDER BY title_count desc limit 5)) GROUP BY title;"
What is the average salary of employees?,SELECT AVG(salary) FROM employees
Which 3 cities have the highest average salary for a software engineers at Google ? ,"SELECT location,        avg(totalyearlycompensation) as average_salary FROM   salaries_data WHERE  company = 'Google'    and title like '%Software Engineer%' GROUP BY location ORDER BY average_salary desc limit 3;"
What is the engineer to product manager ratio in FAANG companies?,"SELECT company,        count(case when title like '%Engineer%' then 1                   else null end) / count(case when title like '%Product Manager%' then 1                   else null end) as ratio FROM   salaries_data WHERE  company in ('Facebook', 'Amazon', 'Apple', 'Netflix', 'Google') GROUP BY company;"
what are different titles in the data ?,"SELECT DISTINCT title FROM   salaries_data;"
What is average total years of experience related to the most popular titles ?,"SELECT title,        avg(yearsofexperience) as average_years_of_experience FROM   salaries_data WHERE title in  ( SELECT title FROM    (       SELECT title, COUNT(*)       FROM salaries_data       GROUP BY 1        ORDER BY 2 DESC        LIMIT 5    ) ) GROUP BY title;"
what 5 companies have the highest total yearly compensation ? ,"SELECT company,        avg(TOTALYEARLYCOMPENSATION) as total_compensation FROM   salaries_data GROUP BY company ORDER BY total_compensation desc limit 5;"
What 5 companies have the most analysts in the top 50 employers ?,"SELECT company,        count(*) as analyst_count FROM   salaries_data WHERE  title like '%Analyst%'    and company in (SELECT company                 FROM   salaries_data                 GROUP BY company                 ORDER BY count(*) desc limit 50) GROUP BY company ORDER BY analyst_count desc limit 5;"
"What is the engineer to product manager ratio in Facebook, Amazon and Google ? ","SELECT company,        count(case when title like '%Engineer%' then 1                   else null end) /        count(case when title like '%Product Manager%' then 1                   else null end) as ratio FROM   salaries_data WHERE  company in ('Facebook', 'Amazon', 'Google') GROUP BY company;"
Which city has the highest average salary for software engineers at Google ? ,"SELECT location,        avg(totalyearlycompensation) as average_salary FROM   salaries_data WHERE  company = 'Google'    and title like '%Software Engineer%' GROUP BY location ORDER BY average_salary desc limit 1;"
Which 5 company has the highest avg stock value grants among the top 40 employers? Load suitable bar chart,"SELECT company,        avg(stockgrantvalue) as average_stock_value FROM   salaries_data WHERE  company in (SELECT company                    FROM   salaries_data                    GROUP BY company                    ORDER BY count(*) desc limit 40) GROUP BY company ORDER BY average_stock_value desc limit 5;"
"what are the year on year total visits on Tesla and ford from 2018 to 2023 ? Convert varchar to date using to date function , Plot a line chart ","SELECT company_name,        extract(year FROM   to_date(date, 'YYYY-MM-DD')) as year, sum(total_visits) as total_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  (company_name ilike '%Tesla%'     or company_name = 'Ford')    and to_date(date, 'YYYY-MM-DD') between '2018-01-01'    and '2023-12-31' GROUP BY company_name, extract(year FROM   to_date(date, 'YYYY-MM-DD')) ORDER BY company_name, year;"
Which 10 domains received the highest amount of traffic on Black Friday in 2021 vs 2020,"SELECT domain,        sum(case when date = '2021-11-26' then total_visits                 else 0 end) as visits_2021,        sum(case when date = '2020-11-27' then total_visits                 else 0 end) as visits_2020 FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  date in ('2021-11-26', '2020-11-27') GROUP BY domain ORDER BY (visits_2021 - visits_2020) desc limit 10"
what are mobile visits for total visits for Coca Cola vs Pepsi in 2021 ?,"SELECT 'Coca Cola' as company,        sum(mobile_visits) as mobile_visits_2021,        sum(total_visits) as total_visits_2021 FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  company_name ilike '%Coca Cola%'    and date between '2021-01-01'    and '2021-12-31' UNION SELECT 'Pepsi' as company,        sum(mobile_visits) as mobile_visits_2021,        sum(total_visits) as total_visits_2021 FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  company_name ilike '%Pepsi%'    and date between '2021-01-01'    and '2021-12-31'"
What's the average visit duration by date for each GOOGL domain?,"``` SELECT DATE, DOMAIN, AVG(TOTAL_AVG_VISIT_DURATION) AS AVG_VISIT_DURATION FROM S__P_500_BY_DOMAIN_AND_AGGREGATED_BY_TICKERS_SAMPLE.DATAFEEDS.SP_500 WHERE TICKER = 'GOOGL' GROUP BY DATE, DOMAIN ORDER BY DATE ASC ```"
what are mobile visits for Expedia  from 2010 to 2021  ? Convert date from varchar to date using to date function ,"SELECT sum(mobile_visits) as mobile_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  company_name ilike '%expedia%'    and to_date(date, 'YYYY-MM-DD') between '2010-01-01'    and '2021-12-31';"
What is the highest traffic domain for each ticker and whats the YoY growth rate for the top 10 fastest / slowest growing,"with ticker_max_traffic as (SELECT ticker,                                    domain,                                    max(total_visits) as max_traffic                             FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500                             GROUP BY ticker, domain), traffic_data as (SELECT domain,                                                   extract(year                                            FROM   cast(date as date)) as year, sum(total_visits) as total_visits                                            FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500                                            GROUP BY domain, extract(year                                            FROM   cast(date as date))), yoy_data as (SELECT current_year.domain,                                                  current_year.year,                                                  (current_year.total_visits - previous_year.total_visits) / cast(previous_year.total_visits as float) as yoy_growth                                           FROM   traffic_data as current_year join traffic_data as previous_year                                                   ON current_year.domain = previous_year.domain and                                                      current_year.year = previous_year.year + 1), ranked_data as (SELECT domain,                                                                     avg(yoy_growth) as avg_yoy_growth                                                              FROM   yoy_data                                                              GROUP BY domain) SELECT ticker_max_traffic.ticker,        ticker_max_traffic.domain,        ticker_max_traffic.max_traffic,        ranked_data.avg_yoy_growth FROM   ticker_max_traffic join ranked_data         ON ticker_max_traffic.domain = ranked_data.domain ORDER BY ranked_data.avg_yoy_growth desc limit 10"
which domains received the highest amount of traffic in the month of November?,"SELECT domain,        sum(total_visits) as total_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  date between '2021-11-01'    and '2021-11-30' GROUP BY domain ORDER BY total_visits desc limit 10"
which domains received the highest amount of traffic in the month of November on the 26th and 29th?,"SELECT domain,        sum(total_visits) as total_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  date in ('2021-11-26', '2021-11-29') GROUP BY domain ORDER BY total_visits desc"
How many domains are there for AMZN?,SELECT COUNT(DISTINCT DOMAIN) AS NUM_DOMAINS FROM S__P_500_BY_DOMAIN_AND_AGGREGATED_BY_TICKERS_SAMPLE.DATAFEEDS.SP_500 WHERE TICKER = 'AMZN'
What are the top 5 domains that had the highest percentage of mobile visits to total visits?,"``` SELECT DOMAIN,      ROUND(MOBILE_VISITS*100.0/TOTAL_VISITS,2) AS MOBILE_PERCENTAGE  FROM S__P_500_BY_DOMAIN_AND_AGGREGATED_BY_TICKERS_SAMPLE.DATAFEEDS.SP_500  ORDER BY MOBILE_PERCENTAGE DESC  LIMIT 5 ```"
what are different company names ?,SELECT DISTINCT(company_name) FROM   datafeeds.sp_500
what are mobile visits for Google  from 2001 to 2010  ? Convert date from varchar to date using to date function ,"SELECT sum(mobile_visits) as mobile_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  company_name ilike '%google%'    and to_date(date, 'YYYY-MM-DD') between  '2010-12-31' and '2021-01-01';"
Which ticker does google.com belong to?,``` SELECT TICKER  FROM S__P_500_BY_DOMAIN_AND_AGGREGATED_BY_TICKERS_SAMPLE.DATAFEEDS.SP_500  WHERE DOMAIN = 'google.com' ```
"what are the year on year total visits on ebay and amazon from 2018 to 2021? Convert varchar to date using to date function , Plot a line chart ","SELECT company_name,        extract(year FROM   to_date(date, 'YYYY-MM-DD')) as year, sum(total_visits) as total_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  (company_name ilike '%ebay%'     or company_name ilike '%amazon%')    and to_date(date, 'YYYY-MM-DD') between '2018-01-01'    and '2021-12-31' GROUP BY company_name, extract(year FROM   to_date(date, 'YYYY-MM-DD')) ORDER BY company_name, year;"
"in 2022, which 10 domains had the highest total time spent (visits x duration) with web and mobile combined?","I'm sorry, it seems that the error message you provided is not related to a valid SQL query. Please provide the full SQL query along with the error message so that I can assist you better."
which 2 companies had the highest abolsute mobile visit growth from 2018 to 2021 ?,"with mobile_visits as (SELECT company_name,                               date_trunc('year', to_date(date, 'YYYY-MM-DD')) as year,                               sum(mobile_visits) as mobile_visits                        FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500                        WHERE  company_name ilike '%coca-cola%'                            or company_name ilike '%pepsi%'                           and to_date(date, 'YYYY-MM-DD') between '2018-01-01'                           and '2021-12-31'                        GROUP BY company_name, year), mobile_visits_growth as (SELECT company_name,                                                               year,                                                               mobile_visits,                                                               lag(mobile_visits) OVER (PARTITION BY company_name                                                                                        ORDER BY year) as prev_mobile_visits                                                        FROM   mobile_visits) SELECT company_name,        max(mobile_visits - prev_mobile_visits) as max_mobile_growth FROM   mobile_visits_growth GROUP BY company_name ORDER BY max_mobile_growth desc limit 2;"
Which  are the top 10 domains  that had the highest  mobile traffic in 2022 and 2021 in billions?,"SELECT domain,        round(sum(case when date between '2021-01-01' and                            '2021-12-31' then mobile_visits                       else 0 end) / 1000000000, 2) as mobile_traffic_2021_billion,        round(sum(case when date between '2022-01-01' and                            '2022-12-31' then mobile_visits                       else 0 end) / 1000000000, 2) as mobile_traffic_2022_billion FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 GROUP BY domain ORDER BY mobile_traffic_2022_billion desc, mobile_traffic_2021_billion desc limit 10"
Which domains  had the highest  mobile traffic between 2022 and 2021?,"One way to correct this error is to add a `NULLIF` function to the denominator of the division operation. This will return NULL instead of throwing a division by zero error if the denominator is zero. Here's the corrected query:  ``` SELECT domain,        sum(case when date between '2021-01-01' and                      '2021-12-31' then mobile_visits                 else 0 end) as mobile_visits_2021,        sum(case when date between '2022-01-01' and                      '2022-12-31' then mobile_visits                 else 0 end) as mobile_visits_2022,        (sum(case when date between '2022-01-01' and                       '2022-12-31' then mobile_visits                  else 0 end) - sum(case when date between '2021-01-01' and                       '2021-12-31' then mobile_visits                  else 0 end)) / NULLIF(sum(case when date between '2021-01-01' and                       '2021-12-31' then mobile_visits                  else 0 end), 0) as mobile_growth FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 GROUP BY domain ORDER BY mobile_growth desc limit 10 ```"
what are mobile visits for Google in 2020 ? ,SELECT sum(mobile_visits) as mobile_visits_2020 FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  domain = 'www.google.com'    and date between '2020-01-01'    and '2020-12-31';
SELECT 10 rows from the data set,"SELECT * FROM datafeeds.SP_500  LIMIT 10"
What is the max traffic domain for each ticker and  the YoY growth rate for the top 10 fastest or slowest growing domains?,"with ticker_max_traffic as (SELECT ticker,                                    domain,                                    max(total_visits) as max_traffic                             FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500                             GROUP BY ticker, domain), traffic_data as (SELECT domain,                                                   extract(year                                            FROM   cast(date as date)) as year, sum(total_visits) as total_visits                                            FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500                                            GROUP BY domain, extract(year                                            FROM   cast(date as date))), yoy_data as (SELECT current_year.domain,                                                  current_year.year,                                                  (current_year.total_visits - previous_year.total_visits) / cast(previous_year.total_visits as float) as yoy_growth                                           FROM   traffic_data as current_year join traffic_data as previous_year                                                   ON current_year.domain = previous_year.domain and                                                      current_year.year = previous_year.year + 1), ranked_data as (SELECT domain,                                                                     avg(yoy_growth) as avg_yoy_growth                                                              FROM   yoy_data                                                              GROUP BY domain) SELECT ticker_max_traffic.ticker,        ticker_max_traffic.domain,        ticker_max_traffic.max_traffic,        ranked_data.avg_yoy_growth FROM   ticker_max_traffic join ranked_data         ON ticker_max_traffic.domain = ranked_data.domain ORDER BY ranked_data.avg_yoy_growth desc limit 10;"
what are average mobile v/s desktop visit duration for netflix from year 2018 to 2021.,"SELECT extract(year FROM   to_date(date, 'YYYY-MM-DD')) as year, avg(mobile_avg_visit_duration) as avg_mobile_visit_duration, avg(desktop_avg_visit_duration) as avg_desktop_visit_duration FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  company_name ilike '%netflix%'    and to_date(date, 'YYYY-MM-DD') between '2018-01-01'    and '2021-12-31' GROUP BY 1;"
How many domains are there for AMZN? List them by desktop traffic,"SELECT DOMAIN, DESKTOP_VISITS  FROM S__P_500_BY_DOMAIN_AND_AGGREGATED_BY_TICKERS_SAMPLE.DATAFEEDS.SP_500 WHERE TICKER = 'AMZN' ORDER BY DESKTOP_VISITS DESC"
which company has the most difference between mobile visits and desktop visits in the year 2021 ?,"SELECT company_name,        sum(mobile_visits) as mobile_visits_2021,        sum(desktop_visits) as desktop_visits_2021,        sum(mobile_visits) - sum(desktop_visits) as diff_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  date between '2021-01-01'    and '2021-12-31' GROUP BY company_name ORDER BY diff_visits desc limit 1"
SELECT are different company names ?,SELECT DISTINCT(company_name) FROM datafeeds.sp_500
Which domains had the highest  mobile traffic in 2022 and 2021?,"SELECT domain,        sum(case when date between '2021-01-01' and                      '2021-12-31' then mobile_visits                 else 0 end) as mobile_visits_2021,        sum(case when date between '2022-01-01' and                      '2022-12-31' then mobile_visits                 else 0 end) as mobile_visits_2022 FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 GROUP BY domain ORDER BY (mobile_visits_2021 + mobile_visits_2022) desc limit 10"
"get the total duration by visits, spent on google.com in 2022 ","The corrected SQL query is:  ``` SELECT (total_avg_visit_duration * total_visits) as total_duration, DATE_TRUNC('month', CAST(date AS DATE)) as month FROM s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE domain = 'google.com' and date between '2022-01-01' and '2022-12-31' GROUP BY total_duration, month ORDER BY month; ```  The error occurred because the `total_avg_visit_duration` column was used in the SELECT clause without being included in the GROUP BY clause. Therefore, I added `total_duration` to the GROUP BY clause."
Compare total traffic to GOOGL domains to MSFT domains grouped by date,"``` SELECT DATE,     SUM(CASE WHEN TICKER = 'GOOGL' THEN TOTAL_VISITS ELSE 0 END) AS GOOGL_VISITS,     SUM(CASE WHEN TICKER = 'MSFT' THEN TOTAL_VISITS ELSE 0 END) AS MSFT_VISITS FROM S__P_500_BY_DOMAIN_AND_AGGREGATED_BY_TICKERS_SAMPLE.DATAFEEDS.SP_500 WHERE TICKER IN ('GOOGL', 'MSFT') GROUP BY DATE ORDER BY DATE ASC ```"
which country has the highest mobile visits on Coca Cola in 2020 V/s which country has highest mobile visits on Pepsi in 2020? Convert date from varchar to date using to date function ,"SELECT country,        sum(mobile_visits) as mobile_visits_2020 FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  (company_name ilike '%coca-cola%' or company_name ilike '%pepsi%')    and to_date(date, 'YYYY-MM-DD') between '2020-01-01'    and '2020-12-31' GROUP BY country ORDER BY mobile_visits_2020 desc limit 1;"
Compare visits to google.com vs bing.com over time,"``` SELECT DATE,     SUM(CASE WHEN DOMAIN = 'google.com' THEN TOTAL_VISITS ELSE 0 END) AS GOOGLE_VISITS,     SUM(CASE WHEN DOMAIN = 'bing.com' THEN TOTAL_VISITS ELSE 0 END) AS BING_VISITS FROM S__P_500_BY_DOMAIN_AND_AGGREGATED_BY_TICKERS_SAMPLE.DATAFEEDS.SP_500 WHERE DOMAIN IN ('google.com', 'bing.com') GROUP BY DATE ORDER BY DATE ASC ```"
"what are the year on year total visits on Tesla and general mills from 2018 to 2021 ? Convert varchar to date using to date function , Plot a line chart ","SELECT company_name,        extract(year FROM   to_date(date, 'YYYY-MM-DD')) as year, sum(total_visits) as total_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  (company_name ilike '%tesla%'     or company_name ilike '%general mills%')    and to_date(date, 'YYYY-MM-DD') between '2018-01-01'    and '2021-12-31' GROUP BY company_name, extract(year FROM   to_date(date, 'YYYY-MM-DD')) ORDER BY company_name, year;"
Plot year on year %growth of mobile visits on Alphabet,"SELECT date_trunc('year', to_date(date, 'YYYY-MM-DD')) as year,        sum(mobile_visits) as mobile_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  company_name ilike '%alphabet%'    and date_trunc('year', to_date(date, 'YYYY-MM-DD')) between '2010-01-01'    and '2021-12-31' GROUP BY date_trunc('year', to_date(date, 'YYYY-MM-DD')) ORDER BY year;"
select the top 10 fastest-growing or slowest-growing domains based on YoY growth rate as a percentage.,"The issue is that the `extract()` function cannot be used on a `VARCHAR(16777216)` column. The `date` column needs to be cast as a date type before using the `extract()` function. Here is the corrected SQL code:  ``` with traffic_data as (     SELECT domain,            extract(year FROM cast(date as date)) as year,             sum(total_visits) as total_visits     FROM s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500     GROUP BY domain, extract(year FROM cast(date as date)) ),  yoy_data as (     SELECT current_year.domain,            current_year.year,            (current_year.total_visits - previous_year.total_visits) / cast(previous_year.total_visits as float) as yoy_growth     FROM traffic_data as current_year      join traffic_data as previous_year         ON current_year.domain = previous_year.domain and            current_year.year = previous_year.year + 1 ),  ranked_data as (     SELECT domain,            100 * (exp(avg(log(abs(yoy_growth) + 1, 2)))) - 100 as avg_yoy_growth_pct     FROM yoy_data     GROUP BY domain ) SELECT domain,        avg_yoy_growth_pct FROM ranked_data ORDER BY avg_yoy_growth_pct desc limit 10; ```"
"What are the first 10 rows in the table that tells me about mobile, desktop, and total visits by domain and ticker?","SELECT COMPANY_NAME, TICKER, DOMAIN, DATE, COUNTRY, DESKTOP_VISITS, DESKTOP_BOUNCE_RATE, DESKTOP_AVG_VISIT_DURATION, DESKTOP_PAGES_PER_VISIT, MOBILE_VISITS, MOBILE_BOUNCE_RATE, MOBILE_AVG_VISIT_DURATION, MOBILE_PAGES_PER_VISIT, TOTAL_VISITS, TOTAL_BOUNCE_RATE, TOTAL_AVG_VISIT_DURATION, TOTAL_PAGES_PER_VISIT FROM S__P_500_BY_DOMAIN_AND_AGGREGATED_BY_TICKERS_SAMPLE.DATAFEEDS.SP_500 LIMIT 10"
Which domains  had the highest  mobile traffic in 2022 and 2021 in billions?,"SELECT domain,        round(sum(case when date between '2021-01-01' and                            '2021-12-31' then mobile_visits                       else 0 end) / 1000000000, 2) as mobile_traffic_2021_billion,        round(sum(case when date between '2022-01-01' and                            '2022-12-31' then mobile_visits                       else 0 end) / 1000000000, 2) as mobile_traffic_2022_billion FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 GROUP BY domain ORDER BY (mobile_traffic_2021_billion + mobile_traffic_2022_billion) desc limit 10"
Plot mobile and desktop visits year on year for activision bliizard,"SELECT date_trunc('year', to_date(date, 'YYYY-MM-DD')) as year,        sum(desktop_visits) as desktop_visits,        sum(mobile_visits) as mobile_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  company_name ilike '%activision blizzard%'    and date_trunc('year', to_date(date, 'YYYY-MM-DD')) between '2010-01-01'    and '2021-12-31' GROUP BY date_trunc('year', to_date(date, 'YYYY-MM-DD')) ORDER BY year;"
what are mobile visits for total visits for Coca Cola vs Pepsi in 2021 ? Convert date from varchar to date using to date function,"SELECT company_name,        sum(total_visits) as total_visits_2021,        sum(mobile_visits) as mobile_visits_2021 FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  company_name ilike '%coca-cola%'     or company_name ilike '%pepsi%'    and to_date(date, 'YYYY-MM-DD') between '2021-01-01'    and '2021-12-31' GROUP BY company_name ORDER BY company_name"
Which domains had the highest growth in mobile traffic in 2022 compared to 2021?,"SELECT domain,        case when mobile_visits_2021 = 0 then null             else (mobile_visits_2022 - mobile_visits_2021) / mobile_visits_2021 end as mobile_growth FROM   (SELECT domain,                sum(case when date between '2021-11-01' and                              '2021-11-30' then mobile_visits                         else 0 end) as mobile_visits_2021,                sum(case when date between '2022-11-01' and                              '2022-11-30' then mobile_visits                         else 0 end) as mobile_visits_2022         FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500         GROUP BY domain) subquery ORDER BY mobile_growth desc limit 10"
which 5 companies have more desktop visits than mobile visits in 2022,"SELECT company_name,        sum(CAST(desktop_visits AS FLOAT)) as desktop_visits,        sum(CAST(mobile_visits AS FLOAT)) as mobile_visits FROM s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE date BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY company_name  HAVING sum(CAST(desktop_visits AS FLOAT)) > sum(CAST(mobile_visits AS FLOAT)) ORDER BY desktop_visits-mobile_visits DESC  LIMIT 5; "
What is the highest traffic domain for each ticker?,"SELECT ticker,        domain,        max(total_visits) as max_traffic FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 GROUP BY ticker, domain"
which domains received the highest amount of traffic?,"SELECT domain,        sum(total_visits) as total_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 GROUP BY domain ORDER BY total_visits desc limit 10"
what are average mobile visit durations of netflix v/s desktop visit duration from year 2018 to 2021.,"SELECT extract(year FROM   to_date(date, 'YYYY-MM-DD')) as year, avg(mobile_avg_visit_duration) as avg_mobile_visit_duration, avg(desktop_avg_visit_duration) as avg_desktop_visit_duration FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  (company_name ilike '%netflix%')    and to_date(date, 'YYYY-MM-DD') between '2018-01-01'    and '2021-12-31' GROUP BY 1;"
Plot year on year % growth and absolute growth of mobile visits on Alphabet .,"SELECT year,        mobile_visits - lag(mobile_visits) OVER (ORDER BY year) as mobile_visits_growth,        round((mobile_visits - lag(mobile_visits) OVER (ORDER BY year))*100.0 / nullif(lag(mobile_visits) OVER (ORDER BY year), 0),              2) as mobile_visits_growth_percentage FROM   (SELECT date_trunc('year', to_date(date, 'YYYY-MM-DD')) as year,                sum(mobile_visits) as mobile_visits         FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500         WHERE  company_name ilike '%alphabet%'            and to_date(date, 'YYYY-MM-DD') between '2010-01-01'            and '2021-12-31'         GROUP BY date_trunc('year', to_date(date, 'YYYY-MM-DD'))) ORDER BY year"
Compare summary stats of nest.com to ring.com,"``` SELECT      'nest.com' AS SITE,      COUNT(DISTINCT DATE) AS NUM_DAYS,     SUM(TOTAL_VISITS) AS TOTAL_VISITS,     AVG(TOTAL_AVG_VISIT_DURATION) AS AVG_VISIT_DURATION,     AVG(TOTAL_PAGES_PER_VISIT) AS AVG_PAGES_PER_VISIT,     AVG(TOTAL_BOUNCE_RATE) AS AVG_BOUNCE_RATE FROM S__P_500_BY_DOMAIN_AND_AGGREGATED_BY_TICKERS_SAMPLE.DATAFEEDS.SP_500 WHERE DOMAIN = 'nest.com' UNION ALL SELECT      'ring.com' AS SITE,      COUNT(DISTINCT DATE) AS NUM_DAYS,     SUM(TOTAL_VISITS) AS TOTAL_VISITS,     AVG(TOTAL_AVG_VISIT_DURATION) AS AVG_VISIT_DURATION,     AVG(TOTAL_PAGES_PER_VISIT) AS AVG_PAGES_PER_VISIT,     AVG(TOTAL_BOUNCE_RATE) AS AVG_BOUNCE_RATE FROM S__P_500_BY_DOMAIN_AND_AGGREGATED_BY_TICKERS_SAMPLE.DATAFEEDS.SP_500 WHERE DOMAIN = 'ring.com' ```"
which 5 companies have the highest avg visit duration in 2021 ?,"SELECT company_name,        avg(total_avg_visit_duration) as avg_duration FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  to_date(date, 'YYYY-MM-DD') between '2021-01-01'    and '2021-12-31' GROUP BY company_name ORDER BY avg_duration desc limit 5;"
Which are the 5 companies with the biggest difference in terms of desktop and mobile site visits in 2022?,"SELECT company_name,        sum(cast(desktop_visits as float)) as desktop_visits,        sum(cast(mobile_visits as float)) as mobile_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  date between '2022-01-01'    and '2022-12-31' GROUP BY company_name having sum(cast(desktop_visits as float)) > sum(cast(mobile_visits as float)) ORDER BY desktop_visits-mobile_visits desc limit 5;"
What's the most recent date in the dataset?,SELECT max(o_orderdate) as latest_date FROM   snowflake_sample_data.tpch_sf1.orders;
which 5 companies have the highest page visits duration in 2021 ?,"SELECT company_name,        sum(total_visits) as visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  to_date(date, 'YYYY-MM-DD') between '2021-01-01'    and '2021-12-31' GROUP BY company_name ORDER BY visits desc limit 5;"
"what are the year on year total visits on ebay and amazon from 2018 to 2023 ? Convert varchar to date using to date function , Plot a line chart ","SELECT company_name,        extract(year FROM   to_date(date, 'YYYY-MM-DD')) as year, sum(total_visits) as total_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  (company_name ilike '%ebay%'     or company_name ilike '%amazon%')    and to_date(date, 'YYYY-MM-DD') between '2018-01-01'    and '2023-12-31' GROUP BY company_name, extract(year FROM   to_date(date, 'YYYY-MM-DD')) ORDER BY company_name, year;"
which  are the top 10 domains that  received the highest amount of traffic in the month of November on the 26th and 29th?,"SELECT domain,        sum(total_visits) as total_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  date in ('2021-11-26', '2021-11-29') GROUP BY domain ORDER BY total_visits desc limit 10"
which domains received the highest amount of traffic in the month of November after the fourth Thursday?,"SELECT domain,        sum(total_visits) as total_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  date in ('2021-11-26', '2021-11-26') GROUP BY domain ORDER BY total_visits desc"
"what are the year on year total visits on Tesla and ford from 2018 to 2021 ? Convert varchar to date using to date function , Plot a line chart ","SELECT company_name,        extract(year FROM   to_date(date, 'YYYY-MM-DD')) as year, sum(total_visits) as total_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  (company_name ilike '%tesla%'     or company_name = 'Ford')    and to_date(date, 'YYYY-MM-DD') between '2018-01-01'    and '2021-12-31' GROUP BY company_name, extract(year FROM   to_date(date, 'YYYY-MM-DD')) ORDER BY company_name, year;"
what are mobile visits for total visits for Coca Cola vs Pepsi in year on year from 2010 to 2021 ? Convert date from varchar to date using to date function,"SELECT company_name,        date_trunc('year', to_date(date, 'YYYY-MM-DD')) as year,        sum(total_visits) as total_visits,        sum(mobile_visits) as mobile_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  company_name ilike '%coca-cola%'     or company_name ilike '%pepsi%'    and date between '2010-01-01'    and '2021-12-31' GROUP BY company_name, date_trunc('year', to_date(date, 'YYYY-MM-DD')) ORDER BY company_name, year"
Which 10 domains received the highest amount of traffic on Black Friday in 2021? Show the associated tickers,"SELECT domain,        ticker,        sum(total_visits) as total_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  date = '2021-11-26' GROUP BY domain, ticker ORDER BY total_visits desc limit 10"
which are the top 10 domains that received the highest amount of traffic in the month of November on the 26th or 29th?,"SELECT domain,        sum(total_visits) as total_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  date = '2021-11-26' or date = '2021-11-29' GROUP BY domain ORDER BY total_visits desc limit 10"
what are average mobile visit durations of netflix v/s desktop visit duration from year 2018 to 2021 ?,"SELECT extract(year FROM to_date(date, 'YYYY-MM-DD')) as year,        avg(mobile_avg_visit_duration) as avg_mobile_visit_duration,        avg(desktop_avg_visit_duration) as avg_desktop_visit_duration FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  (company_name ilike '%netflix%')    and to_date(date, 'YYYY-MM-DD') between '2018-01-01'    and '2021-12-31' GROUP BY 1;"
"which company had more desktop visits than mobile visits in 2020, but had more mobile visits than desktop visits in 2021 ? ","with desktop_visits as (SELECT company_name,                                sum(case when date between '2020-01-01' and                                              '2020-12-31' then desktop_visits                                         else 0 end) as desktop_visits_2020,                                sum(case when date between '2021-01-01' and                                              '2021-12-31' then desktop_visits                                         else 0 end) as desktop_visits_2021                         FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500                         GROUP BY company_name having sum(case when date between '2020-01-01' and '2020-12-31' then mobile_visits else 0 end) < desktop_visits_2020 and sum(case when date between '2021-01-01' and '2021-12-31' then mobile_visits else 0 end) > desktop_visits_2021) SELECT company_name FROM   desktop_visits;"
Which domains  had the highest  mobile traffic in 2022 and 2021?,"with mobile_visits as (SELECT domain,                               sum(case when date between '2021-01-01' and                                             '2021-12-31' then mobile_visits                                        else 0 end) as mobile_visits_2021,                               sum(case when date between '2022-01-01' and                                             '2022-12-31' then mobile_visits                                        else 0 end) as mobile_visits_2022                        FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500                        GROUP BY domain) SELECT domain,        mobile_visits_2021,        mobile_visits_2022 FROM   mobile_visits ORDER BY (mobile_visits_2021 + mobile_visits_2022) desc limit 10;"
select the top 5 and bottom 5 domains based on  yoy growth rate.,"with traffic_data as (SELECT domain,                              extract(year                       FROM   cast(date as date)) as year, sum(total_visits) as total_visits                       FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500                       GROUP BY domain, extract(year                       FROM   cast(date as date))), yoy_data as (SELECT current_year.domain,                                                  current_year.year,                                                  (current_year.total_visits - previous_year.total_visits) / cast(previous_year.total_visits as float) as yoy_growth                                           FROM   traffic_data as current_year join traffic_data as previous_year                                                   ON current_year.domain = previous_year.domain and                                                      current_year.year = previous_year.year + 1), ranked_data as (SELECT domain,                                                                     avg(yoy_growth) as avg_yoy_growth                                                              FROM   yoy_data                                                              GROUP BY domain) SELECT domain,        avg_yoy_growth FROM   ranked_data ORDER BY avg_yoy_growth desc limit 5;"
Plot year on year % growth of mobile visits on Alphabet ,"SELECT date_trunc('year', to_date(date, 'YYYY-MM-DD')) as year,        sum(mobile_visits) as mobile_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  company_name ilike '%alphabet%'    and date_trunc('year', to_date(date, 'YYYY-MM-DD')) between '2010-01-01'    and '2021-12-31' GROUP BY date_trunc('year', to_date(date, 'YYYY-MM-DD')) ORDER BY year;"
Which domains  had the highest  mobile traffic between 2022 or 2021?,"SELECT domain,        sum(case when date between '2021-01-01' and                      '2021-12-31' then mobile_visits                 else 0 end) as mobile_visits_2021,        sum(case when date between '2022-01-01' and                      '2022-12-31' then mobile_visits                 else 0 end) as mobile_visits_2022, (mobile_visits_2022 - mobile_visits_2021) / mobile_visits_2021 * 100 as perc_change FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 GROUP BY domain ORDER BY mobile_visits_2022 desc limit 10"
"which 5 companies have more desktop visits than mobile visits in 2020, rank by highest to lowest desktop views","The corrected SQL query is:  ``` SELECT company_name,        sum(CAST(desktop_visits AS FLOAT)) as desktop_visits,        sum(CAST(mobile_visits AS FLOAT)) as mobile_visits FROM s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE date BETWEEN '2020-01-01' AND '2020-12-31' GROUP BY company_name  HAVING sum(CAST(desktop_visits AS FLOAT)) > sum(CAST(mobile_visits AS FLOAT)) ORDER BY desktop_visits DESC  LIMIT 5;  ```  I removed the `SUM` function from the `ORDER BY` clause since it was already used in the `SELECT` clause. This should fix the error."
Plot year on year % growth and absolute growth of mobile visits on Alphabet ,"SELECT date_trunc('year', to_date(date, 'YYYY-MM-DD')) as year,        (sum(mobile_visits) - lag(sum(mobile_visits), 1) OVER (ORDER BY date_trunc('year', to_date(date, 'YYYY-MM-DD')))) as mobile_growth,        (sum(mobile_visits) - lag(sum(mobile_visits), 1) OVER (ORDER BY date_trunc('year', to_date(date, 'YYYY-MM-DD')))) / lag(sum(mobile_visits), 1) OVER (ORDER BY date_trunc('year', to_date(date, 'YYYY-MM-DD'))) * 100 as mobile_growth_percentage FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  company_name ilike '%alphabet%'    and to_date(date, 'YYYY-MM-DD') between '2010-01-01'    and '2021-12-31' GROUP BY date_trunc('year', to_date(date, 'YYYY-MM-DD')) ORDER BY year;"
select the top 10 fastest-growing or slowest-growing domains based on YoY growth rate,"The corrected SQL code is:  ``` WITH traffic_data AS (     SELECT          domain,         EXTRACT(YEAR FROM CAST(date AS DATE)) AS year,         SUM(total_visits) AS total_visits     FROM s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500     GROUP BY domain, EXTRACT(YEAR FROM CAST(date AS DATE)) ), yoy_data AS (     SELECT          current_year.domain,         current_year.year,         (current_year.total_visits - previous_year.total_visits) / CAST(previous_year.total_visits AS FLOAT) AS yoy_growth     FROM traffic_data AS current_year     JOIN traffic_data AS previous_year     ON current_year.domain = previous_year.domain     AND current_year.year = previous_year.year + 1 ), ranked_data AS (     SELECT          domain,         AVG(yoy_growth) AS avg_yoy_growth     FROM yoy_data     GROUP BY domain ) SELECT      domain,     avg_yoy_growth FROM ranked_data ORDER BY avg_yoy_growth DESC LIMIT 10; ```"
which 2 companies had the highest abolsute mobile visit growth from 2020 to 2021 ?,"with mobile_visits as (SELECT company_name,                               date_trunc('year', to_date(date, 'YYYY-MM-DD')) as year,                               sum(mobile_visits) as mobile_visits                        FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500                        WHERE to_date(date, 'YYYY-MM-DD') between '2020-01-01'                           and '2021-12-31'                        GROUP BY company_name, year), mobile_visits_growth as (SELECT company_name,                                                               year,                                                               mobile_visits,                                                               lag(mobile_visits) OVER (PARTITION BY company_name                                                                                        ORDER BY year) as prev_mobile_visits                                                        FROM   mobile_visits) SELECT company_name,        max(mobile_visits - prev_mobile_visits) as max_mobile_growth FROM   mobile_visits_growth GROUP BY company_name ORDER BY max_mobile_growth desc limit 2;"
Which domains had the highest average visit duration? Limit to the top 100 domains by total traffic,"``` SELECT DOMAIN, ROUND(AVG(TOTAL_AVG_VISIT_DURATION),2) AS AVG_DURATION  FROM S__P_500_BY_DOMAIN_AND_AGGREGATED_BY_TICKERS_SAMPLE.DATAFEEDS.SP_500  GROUP BY DOMAIN  ORDER BY SUM(TOTAL_VISITS) DESC  LIMIT 100 ```"
what are the year on year total visits on Tesla and general mills from 2018 to 2023 ? Convert varchar to date using to date function ,"SELECT company_name,        extract(year FROM   to_date(date, 'YYYY-MM-DD')) as year, sum(total_visits) as total_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  (company_name ilike '%tesla%'     or company_name ilike '%general mills%')    and to_date(date, 'YYYY-MM-DD') between '2018-01-01'    and '2023-12-31' GROUP BY company_name, extract(year FROM   to_date(date, 'YYYY-MM-DD')) ORDER BY company_name, year;"
"what are mobile visits for total visits for Coca Cola vs Pepsi in year on year from 2010 to 2021 ? Convert date from varchar to date using to date function, Plot it on a line chart with year as x axis ","SELECT company_name,        date_trunc('year', to_date(date, 'YYYY-MM-DD')) as year,        sum(total_visits) as total_visits,        sum(mobile_visits) as mobile_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  (company_name ilike '%coca-cola%'     or company_name ilike '%pepsi%')    and date between '2010-01-01'    and '2021-12-31' GROUP BY company_name, date_trunc('year', to_date(date, 'YYYY-MM-DD')) ORDER BY company_name, year;"
Which are the 5 companies with the biggest difference in terms of desktop and mobile site visits in 2022.,"SELECT company_name,        sum(cast(desktop_visits as float)) as desktop_visits,        sum(cast(mobile_visits as float)) as mobile_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  date between '2022-01-01'    and '2022-12-31' GROUP BY company_name having sum(cast(desktop_visits as float)) > sum(cast(mobile_visits as float)) ORDER BY desktop_visits-mobile_visits desc limit 5;"
Which domain received the highest amount of traffic on Black Friday in 2022?,"SELECT domain,        sum(total_visits) as total_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  date = '2022-11-25' GROUP BY domain ORDER BY total_visits desc limit 1"
what are mobile visits for Google  from 2010 to 2021  ? Convert date from varchar to date using to date function ,"SELECT sum(mobile_visits) as mobile_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  company_name ilike '%google%'    and to_date(date, 'YYYY-MM-DD') between '2010-12-31'    and '2021-01-01';"
what are the year on year total visits on Coca Coal and Pepsi from 2018 to 2021 ? Convert varchar to date using to date function ,"SELECT company_name,        extract(year FROM   to_date(date, 'YYYY-MM-DD')) as year, sum(total_visits) as total_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  (company_name ilike '%coca-cola%'     or company_name ilike '%pepsi%')    and to_date(date, 'YYYY-MM-DD') between '2018-01-01'    and '2021-12-31' GROUP BY company_name, extract(year FROM   to_date(date, 'YYYY-MM-DD')) ORDER BY company_name, year;"
select the top 10 fastest-growing or slowest-growing domains based on YoY growth rate ,"with traffic_data as (SELECT domain,                              extract(year                       FROM   cast(date as date)) as year, sum(total_visits) as total_visits                       FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500                       GROUP BY domain, extract(year                       FROM   cast(date as date))), yoy_data as (SELECT current_year.domain,                                                  current_year.year,                                                  (current_year.total_visits - previous_year.total_visits) / cast(previous_year.total_visits as float) as yoy_growth                                           FROM   traffic_data as current_year join traffic_data as previous_year                                                   ON current_year.domain = previous_year.domain and                                                      current_year.year = previous_year.year + 1), ranked_data as (SELECT domain,                                                                     avg(yoy_growth) as avg_yoy_growth                                                              FROM   yoy_data                                                              GROUP BY domain) SELECT domain,        avg_yoy_growth FROM   ranked_data ORDER BY avg_yoy_growth desc limit 10;"
"get the total duration by visits, spent on google.com in 2022 and group by month ","SELECT date_trunc('month', CAST(date AS DATE)) AS month,        SUM(total_avg_visit_duration * total_visits) AS total_duration FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  domain = 'google.com'    AND date BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY month ORDER BY month ASC;"
what are different company names ? ,"SELECT DISTINCT company_name  FROM datafeeds.sp_500 "
what are mobile visits for Google  from 2001 to 2010  ? ,"SELECT sum(mobile_visits) FROM datafeeds.sp_500 WHERE date >= '2001-01-01' and date <= '2010-01-01' and company_name ilike '%google%'"
Show visits to TSLA domains over time,"``` SELECT DATE, SUM(TOTAL_VISITS) AS VISITS FROM S__P_500_BY_DOMAIN_AND_AGGREGATED_BY_TICKERS_SAMPLE.DATAFEEDS.SP_500 WHERE TICKER = 'TSLA' GROUP BY DATE ORDER BY DATE ASC ```"
Which domains had the highest growth in mobile traffic in 2022 and 2021?,"Here is the corrected SQL query:  ``` SELECT domain,        CASE            WHEN mobile_visits_2020 = 0 THEN NULL            ELSE (mobile_visits_2021 - mobile_visits_2020) / mobile_visits_2020         END AS mobile_growth FROM   (SELECT domain,                sum(case when date between '2020-11-01' and                              '2020-11-30' then mobile_visits                         else 0 end) as mobile_visits_2020,                sum(case when date between '2021-11-01' and                              '2021-11-30' then mobile_visits                         else 0 end) as mobile_visits_2021         FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500         GROUP BY domain) subquery ORDER BY mobile_growth desc limit 10 ```  The error occurred because the initial query was included in the error message."
which 2 companies have the highest avg visit duration in 2021 ?,"SELECT company_name,        avg(total_avg_visit_duration) as avg_visit_duration FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  date between '2021-01-01'    and '2021-12-31' GROUP BY company_name ORDER BY avg_visit_duration desc limit 2;"
Which are top 10 domains with the highest mobile traffic in the year 2021 and 2022?,"SELECT domain,        sum(case when date between '2021-01-01' and                      '2021-12-31' then mobile_visits                 else 0 end) as mobile_visits_2021,        sum(case when date between '2022-01-01' and                      '2022-12-31' then mobile_visits                 else 0 end) as mobile_visits_2022 FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 GROUP BY domain ORDER BY (mobile_visits_2021 + mobile_visits_2022) desc limit 10"
which 3 companies have the highest mobile visit duration in the year 2021 ? ,"SELECT company_name,        avg(total_avg_visit_duration) as avg_visit_duration FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  date between '2021-01-01'    and '2021-12-31' GROUP BY company_name ORDER BY avg_visit_duration desc limit 3;"
"which 5 companies have more desktop visits than mobile visits, rank by highest to lowest desktop views","Here is the corrected SQL query:  ``` SELECT company_name,        sum(desktop_visits) as desktop_visits,        sum(mobile_visits) as mobile_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 GROUP BY company_name  HAVING sum(CAST(desktop_visits AS FLOAT)) > sum(CAST(mobile_visits AS FLOAT)) ORDER BY desktop_visits DESC  LIMIT 5; ```  The error message indicates that the `SUM()` function in the `HAVING` clause cannot be nested. Therefore, I have removed the `SUM()` function from the `ORDER BY` clause and replaced it with just the column name `desktop_visits`."
"retrieve the top 10 domains with the highest total time spent (visits x duration) in 2022, combining desktop and mobile traffic",I'm sorry but I cannot correct the SQL query without seeing it. Can you please provide the SQL query?
Plot year on year % growth and absolute growth of mobile visits on Alphabet.,"SELECT year,        mobile_visits - lag(mobile_visits,                            1) OVER (ORDER BY year) as mobile_visits_growth,        round((mobile_visits - lag(mobile_visits, 1) OVER (ORDER BY year)) * 100.0 / nullif(lag(mobile_visits, 1) OVER (ORDER BY year), 0),              2) as mobile_visits_growth_percentage FROM   (SELECT date_trunc('year', to_date(date, 'YYYY-MM-DD')) as year,                sum(mobile_visits) as mobile_visits         FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500         WHERE  company_name ilike '%alphabet%'            and to_date(date, 'YYYY-MM-DD') between '2010-01-01'            and '2021-12-31'         GROUP BY date_trunc('year', to_date(date, 'YYYY-MM-DD'))) subquery ORDER BY year"
what are the year on year total visits on Tesla and general mills from 2018 to 2021 ? Convert varchar to date using to date function ,"SELECT company_name,        extract(year FROM   to_date(date, 'YYYY-MM-DD')) as year, sum(total_visits) as total_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  (company_name ilike '%tesla%'     or company_name ilike '%general mills%')    and to_date(date, 'YYYY-MM-DD') between '2018-01-01'    and '2021-12-31' GROUP BY company_name, extract(year FROM   to_date(date, 'YYYY-MM-DD')) ORDER BY company_name, year;"
Which domains received the highest amount of traffic on Black Friday in 2021?,"SELECT domain,        sum(total_visits) as total_visits FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500 WHERE  date = '2021-11-26' GROUP BY domain ORDER BY total_visits desc"
What is the percentage change in domains which had the highest  mobile traffic between 2022 and 2021?,"with mobile_visits as (SELECT domain,                               sum(case when date between '2021-11-01' and                                             '2021-11-30' then mobile_visits                                        else 0 end) as mobile_visits_2021,                               sum(case when date between '2022-11-01' and                                             '2022-11-30' then mobile_visits                                        else 0 end) as mobile_visits_2022                        FROM   s__p_500_by_domain_and_aggregated_by_tickers_sample.datafeeds.sp_500                        GROUP BY domain), top_domains as (SELECT domain,                                          mobile_visits_2021,                                          mobile_visits_2022,                                          rank() OVER (ORDER BY mobile_visits_2022 desc) as rank_2022,                                          rank() OVER (ORDER BY mobile_visits_2021 desc) as rank_2021                                   FROM   mobile_visits) SELECT top 10 t.domain,        round((t.mobile_visits_2022 - t.mobile_visits_2021) / t.mobile_visits_2021 * 100,              2) as mobile_traffic_percentage_change FROM   top_domains t WHERE  t.rank_2022 <= 10    and t.rank_2021 <= 10 ORDER BY mobile_traffic_percentage_change desc"
What are the daily costs for the last 30 days?,"SELECT usage_date,        sum(usage_in_currency) as daily_cost FROM   snowflake.organization_usage.preview_usage_in_currency_daily WHERE  currency = 'USD'    and usage_date >= dateadd(day, -30, current_date()) GROUP BY usage_date ORDER BY usage_date"
What are the first 10 rows in the USAGE_IN_CURRENCY_DAILY table?,"SELECT ORGANIZATION_NAME, CONTRACT_NUMBER, ACCOUNT_NAME, ACCOUNT_LOCATOR, REGION, SERVICE_LEVEL, USAGE_DATE, USAGE_TYPE, CURRENCY, USAGE, USAGE_IN_CURRENCY, BALANCE_SOURCE FROM SNOWFLAKE.ORGANIZATION_USAGE.USAGE_IN_CURRENCY_DAILY LIMIT 10"
"Total usage costs in dollars for the organization, broken down by account","SELECT account_name,        sum(usage_in_currency) as total_cost FROM   snowflake.organization_usage.preview_usage_in_currency_daily WHERE  currency = 'USD' GROUP BY account_name"
What is the daily cost by usage type?,"SELECT usage_date,        usage_type,        sum(usage_in_currency) as daily_cost FROM   snowflake.organization_usage.preview_usage_in_currency_daily WHERE  currency = 'USD' GROUP BY usage_date, usage_type ORDER BY usage_date, daily_cost desc"
What are the first 10 rows in the PREVIEW_USAGE_IN_CURRENCY_DAILY table?,"SELECT ORGANIZATION_NAME, CONTRACT_NUMBER, ACCOUNT_NAME, ACCOUNT_LOCATOR, REGION, SERVICE_LEVEL, USAGE_DATE, USAGE_TYPE, CURRENCY, USAGE, USAGE_IN_CURRENCY FROM SNOWFLAKE.ORGANIZATION_USAGE.PREVIEW_USAGE_IN_CURRENCY_DAILY LIMIT 10"
Daily usage cost by account,"SELECT account_name,        usage_date,        sum(usage_in_currency) as daily_usage_cost FROM   snowflake.organization_usage.preview_usage_in_currency_daily WHERE  currency = 'USD' GROUP BY account_name, usage_date ORDER BY usage_date, daily_usage_cost desc"
what are the top customers by sales in europe,"SELECT c.c_name as customer_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey join snowflake_sample_data.tpch_sf1.nation n         ON c.c_nationkey = n.n_nationkey join snowflake_sample_data.tpch_sf1.region r         ON n.n_regionkey = r.r_regionkey WHERE  r.r_name = 'EUROPE' GROUP BY customer_name ORDER BY total_sales desc"
total sales for each region?,"SELECT r.r_name as region,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey join snowflake_sample_data.tpch_sf1.nation n         ON c.c_nationkey = n.n_nationkey join snowflake_sample_data.tpch_sf1.region r         ON n.n_regionkey = r.r_regionkey GROUP BY region ORDER BY total_sales desc;"
"What is the average annual revenue for 'Brand#23' parts that are shipped in 'MED BOX', where the quantity shipped is less than 20% of the average quantity shipped for that part?",SELECT  	AVG(l_extendedprice * (1 - l_discount)) as avg_annual_revenue FROM  	SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l 	JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.PART p ON l.l_partkey = p.p_partkey WHERE  	p_brand = 'Brand#23' AND p_container = 'MED BOX' AND l_quantity < (0.2 * ( 		SELECT  			AVG(l_quantity)  		FROM  			SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l 			JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.PART p ON l.l_partkey = p.p_partkey 		WHERE  			p_brand = 'Brand#23' AND p_container = 'MED BOX' 	)) GROUP BY  	extract(year from l_shipdate)
show me the pie chart of the market share in customer table,"SELECT count(*) as total_customers FROM   snowflake_sample_data.tpch_sf1.customer;"
Name the 10 countries having the most customer. Show the name of the countries and the number of customers.,"SELECT n.n_name as country_name,        count(c.c_custkey) as number_of_customers FROM   snowflake_sample_data.tpch_sf1.nation n join snowflake_sample_data.tpch_sf1.customer c         ON n.n_nationkey = c.c_nationkey GROUP BY country_name ORDER BY number_of_customers desc limit 10;"
"Who are the top 100 customers who placed orders with a total quantity of items exceeding 300, and what are the details of these orders?","SELECT    c.c_custkey,    c.c_name,    SUM(l.l_quantity) AS total_quantity,    o.o_orderkey,    o.o_orderdate,    o.o_totalprice,    o.o_comment FROM    snowflake_sample_data.tpch_sf1.customer c   JOIN snowflake_sample_data.tpch_sf1.orders o ON c.c_custkey = o.o_custkey   JOIN snowflake_sample_data.tpch_sf1.lineitem l ON o.o_orderkey = l.l_orderkey GROUP BY    c.c_custkey,    c.c_name,    o.o_orderkey,    o.o_orderdate,    o.o_totalprice,    o.o_comment HAVING    SUM(l.l_quantity) > 300 ORDER BY    total_quantity DESC LIMIT    100"
Who is the top customer in each region?,"with ranked_sales as (SELECT r.r_name as region_name,                              c.c_name as customer_name,                              sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales,                              rank() OVER (PARTITION BY r.r_name                                           ORDER BY sum(l.l_extendedprice * (1 - l.l_discount)) desc) as sales_rank                       FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o                               ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c                               ON o.o_custkey = c.c_custkey join snowflake_sample_data.tpch_sf1.nation n                               ON c.c_nationkey = n.n_nationkey join snowflake_sample_data.tpch_sf1.region r                               ON n.n_regionkey = r.r_regionkey                       GROUP BY region_name, customer_name) SELECT region_name,        customer_name,        total_sales FROM   ranked_sales WHERE  sales_rank = 1 ORDER BY region_name;"
Which countries have the most failed orders ?,"SELECT n.n_name as country_name,        count(o.o_orderkey) as failed_orders FROM   snowflake_sample_data.tpch_sf1.nation n join snowflake_sample_data.tpch_sf1.customer c         ON n.n_nationkey = c.c_nationkey join snowflake_sample_data.tpch_sf1.orders o         ON c.c_custkey = o.o_custkey WHERE  o.o_orderstatus = 'F' GROUP BY country_name ORDER BY failed_orders desc;"
"How many customers have a given number of orders, excluding those orders with special requests? I want the results sorted by the number of customers in descending order and, for equal counts of customers, by the number of orders in descending order.","SELECT num_orders, COUNT(*) AS num_customers FROM (     SELECT o.o_custkey, COUNT(DISTINCT o.o_orderkey) AS num_orders     FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o     LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l ON o.o_orderkey = l.l_orderkey     WHERE l.l_commitdate = l.l_receiptdate     GROUP BY o.o_custkey ) GROUP BY num_orders ORDER BY num_customers DESC, num_orders DESC"
"what are the 10 biggest suppliers, along with the orders.","SELECT s.s_name as supplier_name,        count(distinct l.l_orderkey) as order_count FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.supplier s         ON l.l_suppkey = s.s_suppkey GROUP BY supplier_name ORDER BY order_count desc limit 10"
What is the top 3 customers in China? What are their names?,"SELECT c.c_name as customer_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey join snowflake_sample_data.tpch_sf1.nation n         ON c.c_nationkey = n.n_nationkey WHERE  n.n_name = 'CHINA' GROUP BY customer_name ORDER BY total_sales desc limit 3;"
which 10 customers have had the largest increase in total order value compared to last quarter,"SELECT c.c_name as customer_name,        sum(case when o.o_orderdate >= dateadd(month, -3, date_trunc('quarter', current_date())) and                      o.o_orderdate < date_trunc('quarter',                                                 current_date()) then l.l_extendedprice * (1 - l.l_discount)                 else 0 end) as last_quarter_total,        sum(case when o.o_orderdate >= dateadd(month, -6, date_trunc('quarter', current_date())) and                      o.o_orderdate < dateadd(month,                                              -3,                                              date_trunc('quarter', current_date())) then l.l_extendedprice * (1 - l.l_discount)                 else 0 end) as previous_quarter_total,        sum(l.l_extendedprice * (1 - l.l_discount)) as current_quarter_total FROM   snowflake_sample_data.tpch_sf1.customer c join snowflake_sample_data.tpch_sf1.orders o         ON c.c_custkey = o.o_custkey join snowflake_sample_data.tpch_sf1.lineitem l         ON o.o_orderkey = l.l_orderkey GROUP BY customer_name having last_quarter_total > 0 and previous_quarter_total > 0 ORDER BY (current_quarter_total - previous_quarter_total) desc limit 10;"
What are the top 6 customers by sales?,"SELECT c.c_name as customer_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey GROUP BY customer_name ORDER BY total_sales desc limit 6"
What are the top 20 customers that have the highest gross value of returned parts?,"SELECT      c.c_name,      SUM(l.l_extendedprice * l.l_discount) as returned_parts_gross_value FROM      SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l      JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON l.l_orderkey = o.o_orderkey     JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c ON o.o_custkey = c.c_custkey WHERE      l.l_returnflag = 'R' GROUP BY      c.c_name ORDER BY      returned_parts_gross_value DESC LIMIT      20"
"Can you provide the count of orders for each priority level that were placed in the third quarter of 1993 (from July 1, 1993, to September 30, 1993) and have at least one line item which was received later than its commit date?","select 	o_orderpriority, 	count(*) as order_count from 	orders where 	o_orderdate >= date '1993-07-01' 	AND o_orderdate < DATEADD(month, 3, '1993-07-01') 	and exists ( 		select 			* 		from 			lineitem 		where 			l_orderkey = o_orderkey 			and l_commitdate < l_receiptdate 	) group by 	o_orderpriority order by 	o_orderpriority; "
Calculate the max  order amount for the top 10 nations?,"SELECT n.n_name as country_name,        max(l.l_extendedprice * (1 - l.l_discount)) as max_order_amount FROM   snowflake_sample_data.tpch_sf1.nation n join snowflake_sample_data.tpch_sf1.customer c         ON n.n_nationkey = c.c_nationkey join snowflake_sample_data.tpch_sf1.orders o         ON c.c_custkey = o.o_custkey join snowflake_sample_data.tpch_sf1.lineitem l         ON o.o_orderkey = l.l_orderkey GROUP BY country_name ORDER BY max_order_amount desc limit 10;"
What's the top customer by sales in each region?,"with ranked_sales as (SELECT r.r_name as region_name,                              c.c_name as customer_name,                              sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales,                              rank() OVER (PARTITION BY r.r_name                                           ORDER BY sum(l.l_extendedprice * (1 - l.l_discount)) desc) as sales_rank                       FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o                               ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c                               ON o.o_custkey = c.c_custkey join snowflake_sample_data.tpch_sf1.nation n                               ON c.c_nationkey = n.n_nationkey join snowflake_sample_data.tpch_sf1.region r                               ON n.n_regionkey = r.r_regionkey                       GROUP BY 1, 2) SELECT region_name,        customer_name,        total_sales FROM   ranked_sales WHERE  sales_rank = 1;"
what top 10 countries have the most customers? show the name of the country and number of customers,"This question seems to be a duplicate. Here's the SQL code again:  ``` SELECT n.n_name AS country_name, COUNT(c.c_custkey) AS number_of_customers FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c ON n.n_nationkey = c.c_nationkey GROUP BY country_name ORDER BY number_of_customers DESC LIMIT 10 ```"
"Can you give me the names of the top 100 suppliers in Saudi Arabia, along with the count of their finalized orders, where the orders were received after their committed dates and none of the other suppliers for those orders were late?","SELECT   s.s_suppkey AS supplier_key,   s.s_name AS supplier_name,   COUNT(DISTINCT o.o_orderkey) AS order_count FROM   SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.SUPPLIER s   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l ON s.s_suppkey = l.l_suppkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON l.l_orderkey = o.o_orderkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l2 ON o.o_orderkey = l2.l_orderkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.SUPPLIER s2 ON l2.l_suppkey = s2.s_suppkey WHERE   s.s_nationkey = (     SELECT n.n_nationkey     FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n     WHERE n.n_name = 'SAUDI ARABIA'   )   AND l.l_receiptdate > l.l_commitdate   AND NOT EXISTS (     SELECT *     FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l3     JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o2 ON l3.l_orderkey = o2.o_orderkey     WHERE l3.l_receiptdate > l3.l_commitdate     AND o2.o_orderkey = o.o_orderkey     AND l3.l_suppkey <> s.s_suppkey   ) GROUP BY supplier_key, supplier_name ORDER BY order_count DESC LIMIT 100;"
"What is the total revenue generated from orders that meet any of the following three sets of conditions:  Orders of parts from 'Brand#12' that are packaged in 'SM CASE', 'SM BOX', 'SM PACK', or 'SM PKG', with a quantity between 1 and 11, a size between 1 and 5, and a shipping mode of 'AIR' or 'AIR REG', with instructions to 'DELIVER IN PERSON'.  Orders of parts from 'Brand#23' that are packaged in 'MED BAG', 'MED BOX', 'MED PKG', or 'MED PACK', with a quantity between 10 and 20, a size between 1 and 10, and a shipping mode of 'AIR' or 'AIR REG', with instructions to 'DELIVER IN PERSON'.  Orders of parts from 'Brand#34' that are packaged in 'LG CASE', 'LG BOX', 'LG PACK', or 'LG PKG', with a quantity between 20 and 30, a size between 1 and 15, and a shipping mode of 'AIR' or 'AIR REG', with instructions to 'DELIVER IN PERSON'.","select 	sum(l_extendedprice* (1 - l_discount)) as revenue from 	lineitem, 	part where 	( 		p_partkey = l_partkey 		and p_brand = 'Brand#12' 		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') 		and l_quantity >= 1 and l_quantity <= 1 + 10 		and p_size between 1 and 5 		and l_shipmode in ('AIR', 'AIR REG') 		and l_shipinstruct = 'DELIVER IN PERSON' 	) 	or 	( 		p_partkey = l_partkey 		and p_brand = 'Brand#23' 		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') 		and l_quantity >= 10 and l_quantity <= 10 + 10 		and p_size between 1 and 10 		and l_shipmode in ('AIR', 'AIR REG') 		and l_shipinstruct = 'DELIVER IN PERSON' 	) 	or 	( 		p_partkey = l_partkey 		and p_brand = 'Brand#34' 		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') 		and l_quantity >= 20 and l_quantity <= 20 + 10 		and p_size between 1 and 15 		and l_shipmode in ('AIR', 'AIR REG') 		and l_shipinstruct = 'DELIVER IN PERSON' 	);  "
Who are the top 5 customers by sales?,"SELECT c.c_name as customer_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey GROUP BY customer_name ORDER BY total_sales desc limit 5;"
What are the top 10 customers in the United States by sales?,"SELECT c.c_name as customer_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey join snowflake_sample_data.tpch_sf1.nation n         ON c.c_nationkey = n.n_nationkey WHERE  n.n_name = 'UNITED STATES' GROUP BY customer_name ORDER BY total_sales desc limit 10"
Can you provide a list of nations in the 'ASIA' region and the total revenue generated from their customers for orders placed in the year 1994? I need this data ordered by the revenue in descending order.,"select 	n_name, 	sum(l_extendedprice * (1 - l_discount)) as revenue from 	customer, 	orders, 	lineitem, 	supplier, 	nation, 	region where 	c_custkey = o_custkey 	and l_orderkey = o_orderkey 	and l_suppkey = s_suppkey 	and c_nationkey = s_nationkey 	and s_nationkey = n_nationkey 	and n_regionkey = r_regionkey 	and r_name = 'ASIA' 	and o_orderdate >= date '1994-01-01' 	AND o_orderdate < DATEADD(year, 1, '1994-01-01') group by 	n_name order by 	revenue desc; "
what's the top 5 regions by sales?,"SELECT r.r_name as region_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey join snowflake_sample_data.tpch_sf1.nation n         ON c.c_nationkey = n.n_nationkey join snowflake_sample_data.tpch_sf1.region r         ON n.n_regionkey = r.r_regionkey GROUP BY region_name ORDER BY total_sales desc limit 5;"
"Could you provide a summary of our shipped line items prior to September 3, 1998, grouped by return status and line status? I need to know the total quantity, base price, discounted price, price charged after tax, the average quantity, price, discount rate, and the number of orders for each group.","select 	l_returnflag, 	l_linestatus, 	sum(l_quantity) as sum_qty, 	sum(l_extendedprice) as sum_base_price, 	sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, 	sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, 	avg(l_quantity) as avg_qty, 	avg(l_extendedprice) as avg_price, 	avg(l_discount) as avg_disc, 	count(*) as count_order from 	lineitem where 	l_shipdate <= DATEADD(day, 90, '1998-12-01') group by 	l_returnflag, 	l_linestatus order by 	l_returnflag, 	l_linestatus;"
Revenue from top 10 customers,"SELECT c.c_name as customer_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as revenue FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey GROUP BY customer_name ORDER BY revenue desc limit 10"
which customers based in iran the most total revenue? show customer name and number of orders,"SELECT      c.c_name AS customer_name,      COUNT(DISTINCT o.o_orderkey) AS number_of_orders,      SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue FROM      SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c      JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n ON c.c_nationkey = n.n_nationkey      JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON c.c_custkey = o.o_custkey      JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l ON o.o_orderkey = l.l_orderkey  WHERE      n.n_name = 'IRAN' GROUP BY      customer_name  ORDER BY      total_revenue DESC  LIMIT 10;"
10?,"SELECT c.c_name as customer_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey join snowflake_sample_data.tpch_sf1.nation n         ON c.c_nationkey = n.n_nationkey WHERE  n.n_name = 'UNITED STATES' GROUP BY customer_name ORDER BY total_sales desc limit 10"
 for each region get me the top 5 most valued orders for each region's along with the customer's name,"with ranked_sales as (SELECT r.r_name as region_name,                              c.c_name as customer_name,                              o.o_orderkey as order_key,                              sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales,                              rank() OVER (PARTITION BY r.r_name                                           ORDER BY sum(l.l_extendedprice * (1 - l.l_discount)) desc) as sales_rank                       FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o                               ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c                               ON o.o_custkey = c.c_custkey join snowflake_sample_data.tpch_sf1.nation n                               ON c.c_nationkey = n.n_nationkey join snowflake_sample_data.tpch_sf1.region r                               ON n.n_regionkey = r.r_regionkey                       GROUP BY region_name, customer_name, order_key) SELECT region_name,        customer_name,        order_key,        total_sales FROM   ranked_sales WHERE  sales_rank <= 5;"
what top 10 countries have the most customers? show the name of the country and number of customers.,"SELECT n.n_name AS country_name, COUNT(c.c_custkey) AS number_of_customers FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c ON n.n_nationkey = c.c_nationkey GROUP BY country_name ORDER BY number_of_customers DESC LIMIT 10"
"What is the count of customers and the total account balance from countries with specific country codes ('13', '31', '23', '29', '30', '18', '17'), where the customer's account balance is greater than the average account balance of customers from these specific countries, and the customers have not placed any orders?","SELECT   COUNT(DISTINCT c.c_custkey) AS customer_count,   SUM(c.c_acctbal) AS total_account_balance FROM   SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n ON c.c_nationkey = n.n_nationkey WHERE   n.n_name IN ('ARGENTINA', 'CANADA', 'GERMANY', 'UNITED KINGDOM', 'FRANCE', 'CANADA', 'UNITED STATES')   AND c.c_acctbal > (SELECT AVG(c2.c_acctbal) FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c2 JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n2 ON c2.c_nationkey = n2.n_nationkey WHERE n2.n_name IN ('ARGENTINA', 'CANADA', 'GERMANY', 'UNITED KINGDOM', 'FRANCE', 'CANADA', 'UNITED STATES'))   AND c.c_custkey NOT IN (SELECT o.o_custkey FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o)"
"what is the name of the 10 biggest suppliers, along with the orders.","SELECT s.s_name as supplier_name,        count(distinct l.l_orderkey) as order_count FROM   snowflake_sample_data.tpch_sf1.supplier s join snowflake_sample_data.tpch_sf1.lineitem l         ON s.s_suppkey = l.l_suppkey GROUP BY supplier_name ORDER BY order_count desc limit 10;"
Who is the largest customer by sales in each region?,"The corrected SQL query is: ``` with ranked_sales as (SELECT r.r_name as region_name,                              c.c_name as customer_name,                              sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales,                              rank() OVER (PARTITION BY r.r_name                                           ORDER BY sum(l.l_extendedprice * (1 - l.l_discount)) desc) as sales_rank                       FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o                               ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c                               ON o.o_custkey = c.c_custkey join snowflake_sample_data.tpch_sf1.nation n                               ON c.c_nationkey = n.n_nationkey join snowflake_sample_data.tpch_sf1.region r                               ON n.n_regionkey = r.r_regionkey                       GROUP BY 1, 2) SELECT region_name,        customer_name,        total_sales FROM   ranked_sales WHERE  sales_rank = 1 ORDER BY region_name asc; ```   I replaced the `r.r_regionkey` in the `PARTITION BY` clause with `r.r_name` because `r.r_regionkey` is not a valid group by expression. I also used the `GROUP BY 1, 2` syntax instead of explicitly specifying the column names in the `GROUP BY` clause."
What are the top 11 customers by sales?,"SELECT c.c_name as customer_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey GROUP BY customer_name ORDER BY total_sales desc limit 11"
Which supplier has the lowest average part cost in each region?,"SELECT   r.r_name AS region_name,   s.s_name AS supplier_name,   MIN(ps.ps_supplycost) AS lowest_avg_cost FROM   SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.REGION r   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n ON r.r_regionkey = n.n_regionkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.SUPPLIER s ON n.n_nationkey = s.s_nationkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.PARTSUPP ps ON s.s_suppkey = ps.ps_suppkey   JOIN (     SELECT       n.n_regionkey,       MIN(ps.ps_supplycost) AS min_supplycost     FROM       SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n       JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.SUPPLIER s ON n.n_nationkey = s.s_nationkey       JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.PARTSUPP ps ON s.s_suppkey = ps.ps_suppkey     GROUP BY       n.n_regionkey   ) min_costs ON n.n_regionkey = min_costs.n_regionkey AND ps.ps_supplycost = min_costs.min_supplycost GROUP BY region_name, supplier_name;"
What are the top 8 customers by sales?,"SELECT c.c_name as customer_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey GROUP BY customer_name ORDER BY total_sales desc limit 8"
What are the top 10 customers's phone in the US?,"SELECT c.c_name as customer_name,        c.c_phone as customer_phone FROM   snowflake_sample_data.tpch_sf1.customer c join snowflake_sample_data.tpch_sf1.nation n         ON c.c_nationkey = n.n_nationkey WHERE  n.n_name = 'UNITED STATES' ORDER BY c.c_acctbal desc limit 10;"
What product had the largest price range in the last 24 months?,"SELECT p.p_name,        stddev(l.l_extendedprice * (1 - l.l_discount)) as price_std_dev FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.part p         ON l.l_partkey = p.p_partkey join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey WHERE  o.o_orderdate between dateadd(month, -24, current_date())    and current_date() GROUP BY p.p_name ORDER BY price_std_dev desc limit 1;"
Retrieve customer names with highest orders from Africa region,"SELECT c.c_name as customer_name,        count(o.o_orderkey) as order_count FROM   snowflake_sample_data.tpch_sf1.customer c join snowflake_sample_data.tpch_sf1.orders o         ON c.c_custkey = o.o_custkey join snowflake_sample_data.tpch_sf1.nation n         ON c.c_nationkey = n.n_nationkey join snowflake_sample_data.tpch_sf1.region r         ON n.n_regionkey = r.r_regionkey WHERE  r.r_name = 'AFRICA' GROUP BY customer_name ORDER BY order_count desc limit 10"
What are the top 10 customers in the US?,"SELECT c.c_name as customer_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey join snowflake_sample_data.tpch_sf1.nation n         ON c.c_nationkey = n.n_nationkey WHERE  n.n_name = 'UNITED STATES' GROUP BY customer_name ORDER BY total_sales desc limit 10"
What is the total revenue for the year 1994 from line items with a quantity less than 24 and a discount within 0.01 of 0.06?,"select 	sum(l_extendedprice * l_discount) as revenue from 	snowflake_sample_data.tpch_sf1.lineitem where 	l_shipdate >= date '1994-01-01' 	AND l_shipdate < DATEADD(year, 1, '1994-01-01') 	and l_discount between .06 - 0.01 and .06 + 0.01 	and l_quantity < 24; "
can you please show me limit of 5 customers,"SELECT n.n_name as country_name,        count(c.c_custkey) as number_of_customers FROM   snowflake_sample_data.tpch_sf1.nation n join snowflake_sample_data.tpch_sf1.customer c         ON n.n_nationkey = c.c_nationkey GROUP BY country_name ORDER BY number_of_customers desc limit 5;"
Calculate the highest total order amount for the top 10 nations?,"SELECT n.n_name as country_name,        round(sum(l.l_extendedprice * (1 - l.l_discount)),2) as total_order_amount FROM   snowflake_sample_data.tpch_sf1.nation n join snowflake_sample_data.tpch_sf1.customer c         ON n.n_nationkey = c.c_nationkey join snowflake_sample_data.tpch_sf1.orders o         ON c.c_custkey = o.o_custkey join snowflake_sample_data.tpch_sf1.lineitem l         ON o.o_orderkey = l.l_orderkey GROUP BY country_name ORDER BY total_order_amount desc limit 10"
"For the years 1995 and 1996, what is the annual revenue from shipping transactions between France and Germany, regardless of which nation is the supplier and which is the customer? I need this information grouped by supplier nation, customer nation, and year","select 	supp_nation, 	cust_nation, 	l_year, 	sum(volume) as revenue from 	( 		select 			n1.n_name as supp_nation, 			n2.n_name as cust_nation, 			extract(year from l_shipdate) as l_year, 			l_extendedprice * (1 - l_discount) as volume 		from 			supplier, 			lineitem, 			orders, 			customer, 			nation n1, 			nation n2 		where 			s_suppkey = l_suppkey 			and o_orderkey = l_orderkey 			and c_custkey = o_custkey 			and s_nationkey = n1.n_nationkey 			and c_nationkey = n2.n_nationkey 			and ( 				(n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY') 				or (n1.n_name = 'GERMANY' and n2.n_name = 'FRANCE') 			) 			and l_shipdate between date '1995-01-01' and date '1996-12-31' 	) as shipping group by 	supp_nation, 	cust_nation, 	l_year order by 	supp_nation, 	cust_nation, 	l_year;  "
how many customers are in each region,"SELECT r.r_name as region_name,        count(distinct c.c_custkey) as customer_count FROM   snowflake_sample_data.tpch_sf1.region r join snowflake_sample_data.tpch_sf1.nation n         ON r.r_regionkey = n.n_regionkey join snowflake_sample_data.tpch_sf1.customer c         ON n.n_nationkey = c.c_nationkey GROUP BY region_name ORDER BY region_name asc;"
Calculate the total order amount for the top 10 nation?,"SELECT n.n_name as nation_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_order_amount FROM   snowflake_sample_data.tpch_sf1.nation n join snowflake_sample_data.tpch_sf1.customer c         ON n.n_nationkey = c.c_nationkey join snowflake_sample_data.tpch_sf1.orders o         ON c.c_custkey = o.o_custkey join snowflake_sample_data.tpch_sf1.lineitem l         ON o.o_orderkey = l.l_orderkey GROUP BY nation_name ORDER BY total_order_amount desc limit 10;"
Which supplier has the lowest average part cost for brass parts in each region?,"SELECT   r.r_name AS region_name,   s.s_name AS supplier_name,   MIN(ps.ps_supplycost) AS lowest_avg_cost FROM   SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.REGION r   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n ON r.r_regionkey = n.n_regionkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.SUPPLIER s ON n.n_nationkey = s.s_nationkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.PARTSUPP ps ON s.s_suppkey = ps.ps_suppkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.PART p ON ps.ps_partkey = p.p_partkey WHERE p.p_type like '%BRASS' GROUP BY region_name, supplier_name;"
show me the pie chart of the market share by market segment in customer table,"SELECT c.c_mktsegment as market_segment,        count(*) as market_segment_count FROM   snowflake_sample_data.tpch_sf1.customer c GROUP BY market_segment;"
"Can you provide a list of the top 10 orders, based on revenue, for customers in the 'BUILDING' market segment that were placed before March 15, 1995, but shipped after this date? I need the order key, total revenue, order date, and shipping priority for each.","select 	l_orderkey, 	sum(l_extendedprice * (1 - l_discount)) as revenue, 	o_orderdate, 	o_shippriority from 	customer, 	orders, 	lineitem where 	c_mktsegment = 'BUILDING' 	and c_custkey = o_custkey 	and l_orderkey = o_orderkey 	and o_orderdate < date '1995-03-15' 	and l_shipdate > date '1995-03-15' group by 	l_orderkey, 	o_orderdate, 	o_shippriority order by 	revenue desc, 	o_orderdate limit 10;"
What are the top 7 customers by sales?,"SELECT c.c_name as customer_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey GROUP BY customer_name ORDER BY total_sales desc limit 7;"
"Could you provide a list of the top 100 suppliers in Europe based on their account balance, who supply brass parts of size 15 at the lowest cost? I need to know the supplier's name, their address, phone number, and any additional comments, the name of their nation, as well as the part key and manufacturer.","select 	s_acctbal, 	s_name, 	n_name, 	p_partkey, 	p_mfgr, 	s_address, 	s_phone, 	s_comment from 	part, 	supplier, 	partsupp, 	nation, 	region where 	p_partkey = ps_partkey 	and s_suppkey = ps_suppkey 	and p_size = 15 	and p_type like '%BRASS' 	and s_nationkey = n_nationkey 	and n_regionkey = r_regionkey 	and r_name = 'EUROPE' 	and ps_supplycost = ( 		select 			min(ps_supplycost) 		from 			partsupp, 			supplier, 			nation, 			region 		where 			p_partkey = ps_partkey 			and s_suppkey = ps_suppkey 			and s_nationkey = n_nationkey 			and n_regionkey = r_regionkey 			and r_name = 'EUROPE' 	) order by 	s_acctbal desc, 	n_name, 	s_name, 	p_partkey LIMIT 100;"
What is the percentage of revenue that came from promotional parts (those having type starting with 'PROMO') shipped in September 1995?,"SELECT    (SUM(l.l_extendedprice * (1 - l.l_discount)) /    (SELECT      SUM(l.l_extendedprice * (1 - l.l_discount))    FROM      SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l      JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.PART p ON l.l_partkey = p.p_partkey    WHERE      p.p_type LIKE 'PROMO%') * 100) AS promo_sales_pct FROM    SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l    JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.PART p ON l.l_partkey = p.p_partkey    JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON l.l_orderkey = o.o_orderkey  WHERE    p.p_type LIKE 'PROMO%'   AND o.o_orderdate >= DATEADD(month, -2, '1995-10-01')   AND o.o_orderdate < DATEADD(month, 1, '1995-10-01');"
Who are the top 5 customers in the United States?,"SELECT c.c_name as customer_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey join snowflake_sample_data.tpch_sf1.nation n         ON c.c_nationkey = n.n_nationkey WHERE  n.n_name = 'UNITED STATES' GROUP BY customer_name ORDER BY total_sales desc limit 5;"
What is the most common shipment modes for failed orders ?,"SELECT l_shipmode,                    count(DISTINCT o.o_orderkey) as failed_orders FROM   snowflake_sample_data.tpch_sf1.orders o join   snowflake_sample_data.tpch_sf1.lineitem l         ON l.l_orderkey = o.o_orderkey WHERE  o.o_orderstatus = 'F' GROUP BY l_shipmode ORDER BY failed_orders desc "
What are the top 10 customers that have the highest value of returned brass parts in Europe?,"SELECT c.c_name AS customer_name, SUM(l.l_extendedprice * l.l_discount) AS returned_parts_gross_value FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON l.l_orderkey = o.o_orderkey JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c ON o.o_custkey = c.c_custkey JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.SUPPLIER s ON l.l_suppkey = s.s_suppkey JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n ON s.s_nationkey = n.n_nationkey JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.REGION r ON n.n_regionkey = r.r_regionkey WHERE l.l_returnflag = 'R' AND r.r_name = 'EUROPE' AND l.l_partkey IN ( 	SELECT p.p_partkey FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.PART p 	WHERE p.p_type LIKE '%BRASS%' )  GROUP BY customer_name ORDER BY returned_parts_gross_value DESC LIMIT 10"
"how many orders were placed per week, how many orders were placed 12 weeks ago?","SELECT date_trunc('week', o_orderdate) as week_start,        count(*) as number_of_orders,        count(case when o_orderdate >= dateadd('week', -12, date_trunc('week', current_date())) and                        o_orderdate < dateadd('week',                                              -11,                                              date_trunc('week', current_date())) then o_orderkey                   else null end) as number_of_orders_12_weeks_ago FROM   snowflake_sample_data.tpch_sf1.orders GROUP BY week_start ORDER BY week_start asc"
What are the top ten users?,"SELECT user_name FROM   users ORDER BY user_id limit 10;"
Which 5 customers are getting the biggest discounts?,"SELECT c.c_name AS customer_name, AVG(l.l_discount) AS avg_discount FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON l.l_orderkey = o.o_orderkey JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c ON o.o_custkey = c.c_custkey GROUP BY customer_name ORDER BY avg_discount DESC LIMIT 5"
Calculate the total sales amount and the average sales amount for each nation?,"SELECT n.n_name as nation_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales,        avg(l.l_extendedprice * (1 - l.l_discount)) as avg_sales FROM   snowflake_sample_data.tpch_sf1.nation n join snowflake_sample_data.tpch_sf1.customer c         ON n.n_nationkey = c.c_nationkey join snowflake_sample_data.tpch_sf1.orders o         ON c.c_custkey = o.o_custkey join snowflake_sample_data.tpch_sf1.lineitem l         ON o.o_orderkey = l.l_orderkey GROUP BY nation_name ORDER BY 2 asc limit 10;"
What are the top 5 customers by sales?,"SELECT c.c_name as customer_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey GROUP BY customer_name ORDER BY total_sales desc limit 5"
how many customers in each region?,"SELECT r.r_name as region_name,        count(distinct c.c_custkey) as customer_count FROM   snowflake_sample_data.tpch_sf1.region r join snowflake_sample_data.tpch_sf1.nation n         ON r.r_regionkey = n.n_regionkey join snowflake_sample_data.tpch_sf1.customer c         ON n.n_nationkey = c.c_nationkey GROUP BY region_name;"
Who are the top 10 customers by sales?,"SELECT c.c_name as customer_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey GROUP BY customer_name ORDER BY total_sales desc limit 10"
"For each shipping mode ('MAIL' or 'SHIP'), how many orders have a high priority ('1-URGENT' or '2-HIGH') and how many have a low priority (anything other than '1-URGENT' or '2-HIGH')? Consider only orders shipped within 1994 and where the commit date is before the receipt date and the ship date is before the commit date.","select 	l_shipmode, 	sum(case 		when o_orderpriority = '1-URGENT' 			or o_orderpriority = '2-HIGH' 			then 1 		else 0 	end) as high_line_count, 	sum(case 		when o_orderpriority <> '1-URGENT' 			and o_orderpriority <> '2-HIGH' 			then 1 		else 0 	end) as low_line_count from 	orders, 	lineitem where 	o_orderkey = l_orderkey 	and l_shipmode in ('MAIL', 'SHIP') 	and l_commitdate < l_receiptdate 	and l_shipdate < l_commitdate 	and l_receiptdate >= date '1994-01-01' 	AND o_orderdate < DATEADD(year, 1, '1994-01-01') group by 	l_shipmode order by 	l_shipmode; "
"What are the top 10 customers that have the highest value of returned brass parts in Germany? Use the abbreviation ""DE"" in the chart title instead of Germany","This question has already been asked and answered here: https://github.com/AskdataHQ/snowflake-samples/issues/29#issuecomment-891313460  Here's the solution:  ``` SELECT c.c_name AS customer_name, SUM(l.l_extendedprice * l.l_discount) AS returned_parts_gross_value FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON l.l_orderkey = o.o_orderkey JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c ON o.o_custkey = c.c_custkey JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.SUPPLIER s ON l.l_suppkey = s.s_suppkey JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n ON s.s_nationkey = n.n_nationkey WHERE l.l_returnflag = 'R' AND n.n_name = 'GERMANY' AND l.l_partkey IN ( 	SELECT p.p_partkey FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.PART p 	WHERE p.p_type LIKE '%BRASS%' )  GROUP BY customer_name ORDER BY returned_parts_gross_value DESC LIMIT 10 ```  "
Which country has the most failed orders ?,"SELECT n.n_name as country_name,        count(o.o_orderkey) as failed_orders FROM   snowflake_sample_data.tpch_sf1.nation n join snowflake_sample_data.tpch_sf1.customer c         ON n.n_nationkey = c.c_nationkey join snowflake_sample_data.tpch_sf1.orders o         ON c.c_custkey = o.o_custkey WHERE  o.o_orderstatus = 'F' GROUP BY country_name ORDER BY failed_orders desc limit 1;"
Retrieve customer names with highest orders,"SELECT c.c_name as customer_name,        count(o.o_orderkey) as order_count FROM   snowflake_sample_data.tpch_sf1.customer c join snowflake_sample_data.tpch_sf1.orders o         ON c.c_custkey = o.o_custkey GROUP BY customer_name ORDER BY order_count desc"
How many customers are in each region?,"SELECT r.r_name as region_name,        count(distinct c.c_custkey) as customer_count FROM   snowflake_sample_data.tpch_sf1.region r join snowflake_sample_data.tpch_sf1.nation n         ON r.r_regionkey = n.n_regionkey join snowflake_sample_data.tpch_sf1.customer c         ON n.n_nationkey = c.c_nationkey GROUP BY region_name ORDER BY region_name asc;"
Which part keys in Germany have a total value of supply cost times available quantity greater than 0.0001% of the total value for all part keys in Germany? I want the results sorted by value in descending order.,"select 	ps_partkey, 	sum(ps_supplycost * ps_availqty) as value from 	partsupp, 	supplier, 	nation where 	ps_suppkey = s_suppkey 	and s_nationkey = n_nationkey 	and n_name = 'GERMANY' group by 	ps_partkey having 		sum(ps_supplycost * ps_availqty) > ( 			select 				sum(ps_supplycost * ps_availqty) * 0.0001000000 			from 				partsupp, 				supplier, 				nation 			where 				ps_suppkey = s_suppkey 				and s_nationkey = n_nationkey 				and n_name = 'GERMANY' 		) order by 	value desc; "
"which customers have the most total revenue? show customer name, country and number of orders","SELECT   c.c_name AS customer_name,   n.n_name AS country_name,   COUNT(DISTINCT o.o_orderkey) AS number_of_orders,   SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue FROM   SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n ON c.c_nationkey = n.n_nationkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON c.c_custkey = o.o_custkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l ON o.o_orderkey = l.l_orderkey GROUP BY   customer_name,   country_name ORDER BY   total_revenue DESC LIMIT   10;"
,"Based on the error message, it seems that the table `user_activity` does not exist or the user does not have the necessary permissions to access it. Please ensure that the table exists in the correct database and that the user has the necessary permissions to access it."
how many orders were placed per week?,"SELECT date_trunc('week', o_orderdate) as week_start,        count(*) as number_of_orders FROM   snowflake_sample_data.tpch_sf1.orders GROUP BY week_start ORDER BY week_start desc"
What product has the most variability in price in the last 24 months?,"SELECT p.p_brand,        p.p_type,        stddev(l.l_extendedprice * (1 - l.l_discount)) as price_std_dev FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.part p         ON l.l_partkey = p.p_partkey join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey WHERE  o.o_orderdate between dateadd(month, -24, current_date())    and current_date() GROUP BY p.p_brand, p.p_type ORDER BY price_std_dev desc limit 10"
Calculate the total order amount for the top 10 nations?,"SELECT n.n_name as nation_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_order_amount FROM   snowflake_sample_data.tpch_sf1.nation n join snowflake_sample_data.tpch_sf1.customer c         ON n.n_nationkey = c.c_nationkey join snowflake_sample_data.tpch_sf1.orders o         ON c.c_custkey = o.o_custkey join snowflake_sample_data.tpch_sf1.lineitem l         ON o.o_orderkey = l.l_orderkey GROUP BY nation_name ORDER BY total_order_amount desc limit 10;"
"Who are the top 20 customers by revenue, who have returned items in the last quarter of 1993 (October - December), and what are their details?","select 	c_custkey, 	c_name, 	sum(l_extendedprice * (1 - l_discount)) as revenue, 	c_acctbal, 	n_name, 	c_address, 	c_phone, 	c_comment from 	customer, 	orders, 	lineitem, 	nation where 	c_custkey = o_custkey 	and l_orderkey = o_orderkey 	and o_orderdate >= date '1993-10-01' 	AND o_orderdate < DATEADD(month, 3, '1993-10-01') 	and l_returnflag = 'R' 	and c_nationkey = n_nationkey group by 	c_custkey, 	c_name, 	c_acctbal, 	c_phone, 	n_name, 	c_address, 	c_comment order by 	revenue desc limit 20;"
"what are the 5 top customers by sales in europe. show the total sales, total number of orders, country, and date of last order.","SELECT c.c_name as customer_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales,        count(distinct o.o_orderkey) as total_orders,        n.n_name as country,        max(o.o_orderdate) as last_order_date FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey join snowflake_sample_data.tpch_sf1.nation n         ON c.c_nationkey = n.n_nationkey join snowflake_sample_data.tpch_sf1.region r         ON n.n_regionkey = r.r_regionkey WHERE  r.r_name = 'EUROPE' GROUP BY customer_name, country ORDER BY total_sales desc limit 5;"
"What are the top 10 customers that have the highest value of returned brass parts where each part is more than $10 in Germany? Use the abbreviation ""DE"" in the chart title instead of Germany","SELECT      c.c_name AS customer_name,      SUM(l.l_extendedprice * l.l_discount) AS returned_parts_gross_value FROM      SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l      JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o          ON l.l_orderkey = o.o_orderkey     JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c          ON o.o_custkey = c.c_custkey     JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.SUPPLIER s          ON l.l_suppkey = s.s_suppkey     JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n          ON s.s_nationkey = n.n_nationkey     WHERE          l.l_returnflag = 'R'          AND n.n_name = 'GERMANY'         AND l.l_extendedprice * (1 - l.l_discount) > 10          AND l.l_partkey IN (             SELECT                  p.p_partkey              FROM                  SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.PART p              WHERE                  p.p_type LIKE '%BRASS%'         ) GROUP BY      customer_name ORDER BY      returned_parts_gross_value DESC LIMIT      10"
"What is the market share of Brazil, by year, for 'ECONOMY ANODIZED STEEL' type parts sold in the 'AMERICA' region for the years 1995 and 1996?","select 	o_year, 	sum(case 		when nation = 'BRAZIL' then volume 		else 0 	end) / sum(volume) as mkt_share from 	( 		select 			extract(year from o_orderdate) as o_year, 			l_extendedprice * (1 - l_discount) as volume, 			n2.n_name as nation 		from 			part, 			supplier, 			lineitem, 			orders, 			customer, 			nation n1, 			nation n2, 			region 		where 			p_partkey = l_partkey 			and s_suppkey = l_suppkey 			and l_orderkey = o_orderkey 			and o_custkey = c_custkey 			and c_nationkey = n1.n_nationkey 			and n1.n_regionkey = r_regionkey 			and r_name = 'AMERICA' 			and s_nationkey = n2.n_nationkey 			and o_orderdate between date '1995-01-01' and date '1996-12-31' 			and p_type = 'ECONOMY ANODIZED STEEL' 	) as all_nations group by 	o_year order by 	o_year;  "
What are the top 11 customers by sales in the United States?,"SELECT c.c_name as customer_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey join snowflake_sample_data.tpch_sf1.nation n         ON c.c_nationkey = n.n_nationkey WHERE  n.n_name = 'UNITED STATES' GROUP BY customer_name ORDER BY total_sales desc limit 11"
"For each year, what is the total profit generated by parts with a name containing 'green' for each nation? I want this information sorted by nation and year in descending order.","select 	nation, 	o_year, 	sum(amount) as sum_profit from 	( 		select 			n_name as nation, 			extract(year from o_orderdate) as o_year, 			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount 		from 			part, 			supplier, 			lineitem, 			partsupp, 			orders, 			nation 		where 			s_suppkey = l_suppkey 			and ps_suppkey = l_suppkey 			and ps_partkey = l_partkey 			and p_partkey = l_partkey 			and o_orderkey = l_orderkey 			and s_nationkey = n_nationkey 			and p_name like '%green%' 	) as profit group by 	nation, 	o_year order by 	nation, 	o_year desc; "
"which customer ordered for the biggest order value, along with the name of the customer and the order value ? ","SELECT c.c_name as customer_name,        o.o_orderkey as order_key,        o.o_totalprice as order_value FROM   snowflake_sample_data.tpch_sf1.customer c join snowflake_sample_data.tpch_sf1.orders o         ON c.c_custkey = o.o_custkey ORDER BY o.o_totalprice desc limit 1"
How many customers do we have in the United States?,SELECT count(c.c_custkey) as number_of_customers FROM   snowflake_sample_data.tpch_sf1.nation n join snowflake_sample_data.tpch_sf1.customer c         ON n.n_nationkey = c.c_nationkey WHERE  n.n_name = 'UNITED STATES'
Retrieve all sales  for the American region,SELECT sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey join snowflake_sample_data.tpch_sf1.nation n         ON c.c_nationkey = n.n_nationkey join snowflake_sample_data.tpch_sf1.region r         ON n.n_regionkey = r.r_regionkey WHERE  r.r_name = 'AMERICA' GROUP BY r.r_name;
how many orders were placed per day?,"SELECT date_trunc('day', o_orderdate) as order_date,        count(*) as number_of_orders FROM   snowflake_sample_data.tpch_sf1.orders GROUP BY 1 ORDER BY 1"
what is the name of the 10 biggest suppliers,SELECT s_name as supplier_name FROM   snowflake_sample_data.tpch_sf1.supplier ORDER BY s_acctbal desc limit 10;
list top 10 customer order by amount of orders,"SELECT c.c_name as customer_name,        count(o.o_orderkey) as number_of_orders FROM   snowflake_sample_data.tpch_sf1.customer c join snowflake_sample_data.tpch_sf1.orders o         ON c.c_custkey = o.o_custkey GROUP BY customer_name ORDER BY number_of_orders desc limit 10"
What are the top 10 customers by sales?,"SELECT c.c_name as customer_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey GROUP BY customer_name ORDER BY total_sales desc limit 10;"
What are the top 3 customers in China?,"SELECT c.c_name as customer_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey join snowflake_sample_data.tpch_sf1.nation n         ON c.c_nationkey = n.n_nationkey WHERE  n.n_name = 'CHINA' GROUP BY customer_name ORDER BY total_sales desc limit 3;"
What are the top 10 customers in the US by sales?,"SELECT c.c_name as customer_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey join snowflake_sample_data.tpch_sf1.nation n         ON c.c_nationkey = n.n_nationkey WHERE  n.n_name = 'UNITED STATES' GROUP BY customer_name ORDER BY total_sales desc limit 10;"
What are the total sales by region?,"``` SELECT    r.r_name AS region,    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales FROM    SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON l.l_orderkey = o.o_orderkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c ON o.o_custkey = c.c_custkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n ON c.c_nationkey = n.n_nationkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.REGION r ON n.n_regionkey = r.r_regionkey GROUP BY    region ORDER BY    total_sales DESC; ```"
What are the top 10 customers by sales in the United States?,"SELECT c.c_name as customer_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey join snowflake_sample_data.tpch_sf1.nation n         ON c.c_nationkey = n.n_nationkey WHERE  n.n_name = 'UNITED STATES' GROUP BY customer_name ORDER BY total_sales desc limit 10"
"how many orders were placed per week, and how does that compare to 12 weeks prior?","SELECT trunc(o_orderdate, 'week') as week_start,        count(distinct o_orderkey) as num_orders,        count(distinct case when o_orderdate >= dateadd(week, -12, trunc(current_date, 'week')) and                                 o_orderdate < dateadd(week, -11, trunc(current_date, 'week')) then o_orderkey                            else null end) as num_orders_12_weeks_prior,        case when count(distinct o_orderkey) > count(distinct case when o_orderdate >= dateadd(week, -12, trunc(current_date, 'week')) and                  o_orderdate < dateadd(week, -11, trunc(current_date, 'week')) then o_orderkey             else null end) then 'Higher'             when count(distinct o_orderkey) < count(distinct case when o_orderdate >= dateadd(week, -12, trunc(current_date, 'week')) and                  o_orderdate < dateadd(week, -11, trunc(current_date, 'week')) then o_orderkey             else null end) then 'Lower'             else 'Same' end as order_diff FROM   snowflake_sample_data.tpch_sf1.orders GROUP BY week_start having week_start >= dateadd(week, -12, trunc(current_date, 'week')) ORDER BY week_start desc;"
"Can you show me a list of different parts (defined by brand, type, and size), excluding certain types and brands, and those supplied by suppliers with customer complaints? And can you order this list by the number of distinct suppliers for each part, and then by brand, type, and size?","select 	p_brand, 	p_type, 	p_size, 	count(distinct ps_suppkey) as supplier_cnt from 	snowflake_sample_data.tpch_sf1.partsupp, 	snowflake_sample_data.tpch_sf1.part where 	p_partkey = ps_partkey 	and p_brand <> 'Brand#45' 	and p_type not like 'MEDIUM POLISHED%' 	and p_size in (49, 14, 23, 45, 19, 3, 36, 9) 	and ps_suppkey not in ( 		select 			s_suppkey 		from 			snowflake_sample_data.tpch_sf1.supplier 		where 			s_comment like '%Customer%Complaints%' 	) group by 	p_brand, 	p_type, 	p_size order by 	supplier_cnt desc, 	p_brand, 	p_type, 	p_size;"
What are the total sales by region and what are  the region names?,"``` SELECT    r.r_name AS region_name,    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales FROM    SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON l.l_orderkey = o.o_orderkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c ON o.o_custkey = c.c_custkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n ON c.c_nationkey = n.n_nationkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.REGION r ON n.n_regionkey = r.r_regionkey GROUP BY    region_name ORDER BY    total_sales DESC; ```"
What are the top 3 customers by sales in the United States?,"SELECT c.c_name as customer_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.customer c join snowflake_sample_data.tpch_sf1.orders o         ON c.c_custkey = o.o_custkey join snowflake_sample_data.tpch_sf1.lineitem l         ON o.o_orderkey = l.l_orderkey join snowflake_sample_data.tpch_sf1.nation n         ON c.c_nationkey = n.n_nationkey WHERE  n.n_name = 'UNITED STATES' GROUP BY customer_name ORDER BY total_sales desc limit 3;"
What are the top 7 customers in the United States?,"SELECT c.c_name as customer_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey join snowflake_sample_data.tpch_sf1.nation n         ON c.c_nationkey = n.n_nationkey WHERE  n.n_name = 'UNITED STATES' GROUP BY customer_name ORDER BY total_sales desc limit 7"
which country has most customers ? ,"SELECT n.n_name as country_name,        o_orderstatus,        count(c.c_custkey) as customer_count FROM   snowflake_sample_data.tpch_sf1.nation n join snowflake_sample_data.tpch_sf1.customer c         ON n.n_nationkey = c.c_nationkey JOIN snowflake_sample_data.tpch_sf1.orders o          on o.o_custkey = c.c_custkey  GROUP BY country_name, o_orderstatus  "
how many customers are in the united states?,SELECT count(c.c_custkey) as number_of_customers FROM   snowflake_sample_data.tpch_sf1.nation n join snowflake_sample_data.tpch_sf1.customer c         ON n.n_nationkey = c.c_nationkey WHERE  n.n_name = 'UNITED STATES'
What products have the most variability in price in the last 24 months?,"SELECT p.p_brand,        p.p_type,        stddev(l.l_extendedprice * (1 - l.l_discount)) as price_std_dev FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.part p         ON l.l_partkey = p.p_partkey join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey WHERE  o.o_orderdate between dateadd(month, -24, current_date())    and current_date() GROUP BY p.p_brand, p.p_type ORDER BY price_std_dev desc limit 10"
Calculate the total order amount for each nation?,"SELECT n.n_name as country_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_order_amount FROM   snowflake_sample_data.tpch_sf1.nation n join snowflake_sample_data.tpch_sf1.customer c         ON n.n_nationkey = c.c_nationkey join snowflake_sample_data.tpch_sf1.orders o         ON c.c_custkey = o.o_custkey join snowflake_sample_data.tpch_sf1.lineitem l         ON o.o_orderkey = l.l_orderkey GROUP BY country_name;"
Which countries had the highest discounts over the last 12 months?,"SELECT   n.n_name AS country_name,   AVG(l.l_discount) AS avg_discount FROM   SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c ON n.n_nationkey = c.c_nationkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON c.c_custkey = o.o_custkey   JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l ON o.o_orderkey = l.l_orderkey WHERE    o.o_orderdate BETWEEN DATEADD(month, -12, CURRENT_DATE()) AND CURRENT_DATE() GROUP BY   country_name ORDER BY   avg_discount DESC;"
What are the top 10 customers that have the highest value of returned brass parts in Africa?,"SELECT c.c_name AS customer_name, SUM(l.l_extendedprice * l.l_discount) AS returned_parts_gross_value FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON l.l_orderkey = o.o_orderkey JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c ON o.o_custkey = c.c_custkey JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.SUPPLIER s ON l.l_suppkey = s.s_suppkey JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION n ON s.s_nationkey = n.n_nationkey WHERE l.l_returnflag = 'R' AND n.n_name = 'AFRICA' AND l.l_partkey IN ( 	SELECT p.p_partkey FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.PART p 	WHERE p.p_type LIKE '%BRASS%' )  GROUP BY customer_name ORDER BY returned_parts_gross_value DESC LIMIT 10"
top 5 customers by sales in the united states,"SELECT c.c_name as customer_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey join snowflake_sample_data.tpch_sf1.nation n         ON c.c_nationkey = n.n_nationkey WHERE  n.n_name = 'UNITED STATES' GROUP BY customer_name ORDER BY total_sales desc limit 5;"
Who are the top 10 customers in the United States?,"SELECT c.c_name as customer_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey join snowflake_sample_data.tpch_sf1.nation n         ON c.c_nationkey = n.n_nationkey WHERE  n.n_name = 'UNITED STATES' GROUP BY customer_name ORDER BY total_sales desc limit 10;"
What are the top 20 customers that have the highest value of returned parts?,"SELECT      c.c_name,      SUM(l.l_extendedprice * l.l_discount) as returned_parts_gross_value FROM      SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM l      JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS o ON l.l_orderkey = o.o_orderkey     JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER c ON o.o_custkey = c.c_custkey WHERE      l.l_returnflag = 'R' GROUP BY      c.c_name ORDER BY      returned_parts_gross_value DESC LIMIT      20"
"I have a large table consisting of two keys (id,date) I want to change the id so that every day an account starts from one","SELECT dense_rank() OVER (PARTITION BY date                           ORDER BY id) as new_id,        date FROM   your_table;"
What are the top 10 customers?,SELECT c.c_name as customer_name FROM   snowflake_sample_data.tpch_sf1.customer c ORDER BY c.c_custkey limit 10;
What are the top 5 customers in the United States?,"SELECT c.c_name as customer_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey join snowflake_sample_data.tpch_sf1.nation n         ON c.c_nationkey = n.n_nationkey WHERE  n.n_name = 'UNITED STATES' GROUP BY customer_name ORDER BY total_sales desc limit 5"
What are the top 10 customers that have the highest value of returned brass parts where each part is more than $10 in Germany?,"SELECT c.c_name as customer_name,        sum(l.l_extendedprice * l.l_discount) as returned_parts_gross_value FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey join snowflake_sample_data.tpch_sf1.supplier s         ON l.l_suppkey = s.s_suppkey join snowflake_sample_data.tpch_sf1.nation n         ON s.s_nationkey = n.n_nationkey WHERE  l.l_returnflag = 'R'    and n.n_name = 'GERMANY'    and l.l_extendedprice * (1 - l.l_discount) > 10    and l.l_partkey in (SELECT p.p_partkey                     FROM   snowflake_sample_data.tpch_sf1.part p                     WHERE  p.p_type like '%BRASS%') GROUP BY customer_name ORDER BY returned_parts_gross_value desc limit 10"
Can you provide the names and addresses of suppliers located in Canada who supply parts with names beginning with 'forest' and who have more than half of their total quantity supplied for these parts shipped within the year 1994?,"select 	s_name, 	s_address from 	supplier, 	nation where 	s_suppkey in ( 		select 			ps_suppkey 		from 			partsupp 		where 			ps_partkey in ( 				select 					p_partkey 				from 					part 				where 					p_name like 'forest%' 			) 			and ps_availqty > ( 				select 					0.5 * sum(l_quantity) 				from 					lineitem 				where 					l_partkey = ps_partkey 					and l_suppkey = ps_suppkey 					and l_shipdate >= date '1994-01-01'                 	AND l_shipdate < DATEADD(year, 1, '1994-01-01') 			) 	) 	and s_nationkey = n_nationkey 	and n_name = 'CANADA' order by 	s_name; "
what are my tables? ,You can view your tables by running the following SQL statement:  ``` SELECT table_name FROM information_schema.tables WHERE table_schema = '<your_database_name>'; ```  Replace `<your_database_name>` with the name of your database.
What is the top 3 customers in China?,"SELECT c.c_name as customer_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey join snowflake_sample_data.tpch_sf1.nation n         ON c.c_nationkey = n.n_nationkey WHERE  n.n_name = 'CHINA' GROUP BY customer_name ORDER BY total_sales desc limit 3;"
top 5 countries by sales,"SELECT n.n_name as country_name,        sum(l.l_extendedprice * (1 - l.l_discount)) as total_sales FROM   snowflake_sample_data.tpch_sf1.lineitem l join snowflake_sample_data.tpch_sf1.orders o         ON l.l_orderkey = o.o_orderkey join snowflake_sample_data.tpch_sf1.customer c         ON o.o_custkey = c.c_custkey join snowflake_sample_data.tpch_sf1.nation n         ON c.c_nationkey = n.n_nationkey GROUP BY country_name ORDER BY total_sales desc limit 5;"
